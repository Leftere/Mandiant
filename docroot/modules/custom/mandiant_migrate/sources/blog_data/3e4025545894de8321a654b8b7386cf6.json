{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "admin",
  "jcr:created": "Wed May 04 2016 09:04:17 GMT-0400",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "admin",
    "jcr:title": "A New Word Document Exploit Kit",
    "cq:lastReplicationAction": "Activate",
    "jcr:versionHistory": "2ee631e4-1d84-495e-867a-5fc09b4dac20",
    "author": "Nart Villeneuve",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "cq:lastReplicatedBy": "lynda.hall@fireeye.com",
    "focusKeyword": "Word",
    "jcr:language": "en_us",
    "jcr:predecessors": [
      "f80d5b62-460f-4a75-b746-506f5f9c29d5"
    ],
    "jcr:created": "Fri Jun 03 2016 19:48:52 GMT-0400",
    "cq:lastReplicated": "Fri Jun 03 2016 19:48:52 GMT-0400",
    "cq:lastModified": "Thu Apr 02 2015 21:18:58 GMT-0400",
    "cq:distribute": true,
    "jcr:baseVersion": "f80d5b62-460f-4a75-b746-506f5f9c29d5",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-tags:exploitkit",
      "fireeye-blog-authors:cap-narottama-villeneuve",
      "fireeye-blog-tags:exploit-kits",
      "fireeye-blog-authors:cap-joshua-homan",
      "fireeye-doctypes:blog",
      "fireeye-blog-threat-research:threat-research\/cyber-exploits",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-tags:microsoft"
    ],
    "jcr:uuid": "fb03d169-c2e0-463b-8962-13bcb0a3c7f3",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Wed Apr 01 2015 16:17:27 GMT-0400",
    "_charset_": "UTF-8",
    "cq:lastModifiedBy": "matthew.sawicki@FireEye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "matthew.sawicki@FireEye.com",
        "text": "\u003Cp\u003EThe tools used to create malicious documents that exploit vulnerabilities in Microsoft Word are now being advertised in underground forums and one new tool has emerged that provides the ability to track the effectiveness of campaigns. The builder, Microsoft Word Intruder (MWI), is advertised as an \u201cAPT\u201d tool to be used in targeted attacks. It is accompanied by a statistics package known as \u201cMWISTAT\u201d that allows operators to track various campaigns.\u003C\/p\u003E\n\u003Cp\u003EAccording to the author, the use of MWI in conjunction with spam is forbidden, and those who ignore this risk having their license revoked. In addition, the author only sells the tool to a select number of customers. This indicates that traditional cybercriminals have adopted the terminology of \u201cAPT\u201d and understand the need to avoid high volume spam, if they are to stay under the radar.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EBackground\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003ETraditionally, indiscriminate spam and \u201cdrive-by\u201d campaigns have spread a variety of malware using \u003Ca href=\u0022http:\/\/contagiodata.blogspot.com\/2014\/12\/exploit-kits-2014.html\u0022\u003EExploit Kits\u003C\/a\u003E that target popular browsers, such as Internet Explorer, and plugins such as Java, Flash, and Adobe PDF. However, an exploit for Microsoft Word (CVE-2012-0158), which was first associated with \u003Ca href=\u0022http:\/\/contagiodump.blogspot.com\/2012\/04\/cve2012-0158-south-china-sea-insider.html\u0022\u003EAPT activity\u003C\/a\u003E, found its way into the hands of traditional cybercriminals who began using it in \u003Ca href=\u0022http:\/\/blog.spiderlabs.com\/2013\/05\/malicious-document-files-spammed-by-cutwail-to-propagate-zeus-trojan.html\u0022\u003Espam campaigns\u003C\/a\u003E in 2013.\u003C\/p\u003E\n\u003Cp\u003EMuch like Browser Exploit Kits, MWI now allows the operators to track multiple campaigns, conversion rates (i.e. successful exploitations), and information about their victims. This information includes the victim\u2019s IP address, geographic location, and the version of the vulnerable Office software found on the victim\u2019s system. This allows cybercriminals to track their campaigns in order to fine-tune their distribution methods to increase the overall effectiveness of their campaigns.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EMICROSOFT WORD INTRUDER \/ MWISTAT 2.0\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EMWI is a \u201cbuilder\u201d that creates malicious Word documents.\u0026nbsp; It was developed by \u201cObjekt\u201d and advertised on forums as \u201cthe most reliable \u0026amp; universal .doc exploit pack\u201d starting in May 2013 (although a private version may have been previously available). \u0026nbsp;The price for the builder ranges from $2000 - $3500. The latest version of MWI 4.0 has been advertised as containing multiple exploits, including:\u003C\/p\u003E\n\u003Cul class=\u0022list-bullet\u0022\u003E\n\u003Cli\u003ECVE-2010-3333\u003C\/li\u003E\n\u003Cli\u003ECVE-2012-0158\u003C\/li\u003E\n\u003Cli\u003ECVE-2013-3906\u003C\/li\u003E\n\u003Cli\u003ECVE-2014-1761\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EMWI is marketed toward those seeking to engage in \u201cAPT\u201d style targeted attacks, rather than standard spam campaigns.\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/mwi1a.png\u0022\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/mwi1.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u0026quot;MWI: Fulll APT Edition (31.10.2013 UPDATE)\u003Cbr\u003E\nFor all those, who have already purchased the product for targeted attacks (\u0026quot;MWI: Full APT Edition\u0026quot;) it is recommended to refer to the free update from 31st October 2013, which will pleasantly surprise you with its new functionality.\u0026quot;\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 1. MWI advertised for targeted attacks.\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EIn fact, one of the conditions of the sale of the MWI builder is that the license can be revoked if MWI is used in spam campaigns. The author explains that a different product is used for spam, but that it has been indefinitely suspended at this time.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/mwi2.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u0026quot;We would like to bring to your attention that according to our rules spamming using targeted exploits results in the loss of license and\/or future clean ups and updates (we have not yet had such incidents and only one person has partially crossed the lined, but has received only a warning due to the situation being within reason). For spam a separate solution exists (at the moment the service is halted for undetermined amount of time), thus you must immediately clarify for which tasks a targeted exploit is required. Creation of an exploit for spam is also designed for a limited number of users.\u0026quot;\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 2.\u0026nbsp; MWI is not to be used for spam.\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EMWISTAT\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EMWISTAT was released in December 2014 and is a package that allows users of the MWI builder to track their campaigns.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/mwi3.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u0026quot;Added additional exploit functionality, that allows they use of statistics web-server \u0026quot;MWISTAT\u0026quot; to log when and at what time the document was opened and the .exe-file was downloaded, from which IP address, as well as additional information, such as User-Agent.\u0026quot;\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 3. MWISTAT released\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EWhile we have been unable to obtain the builder, we were able to locate the source code of the MWISTAT 2.0 package, which was also developed by \u201cObjekt\u201d.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-8-58-20-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 4. MWISTAT source code\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EMWISTAT is a PHP package that is installed on a server in order to receive the requests made from the victim\u2019s computer when a malicious Word document, generated by the MWI builder, is opened. MWISTAT checks the ID number within the initial beacon from the victim\u2019s computer and then serves the specified malware associated with that ID to the victim. This allows the operator to track multiple campaigns, generate statistics and collect information about the victims. If no ID number is present (or an incorrect ID number is supplied) the request is flagged as suspicious.\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-00-52-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 5. MWISTAT \u201cFILES\u201d View\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe \u201cFILES\u201d view allows the operator to upload a new malware payload to the server. The URL is then embedded in the malicious Word document so that when it is opened the victim\u2019s computer will connect to the specified URL. Each uploaded malware payload is assigned a random ID number between 10000000 and 99999999. The operator can track different campaigns using the ID number.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-02-19-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 6. MWISTATS \u201cLOGS\u201d View\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe \u201cLOGS\u201d view shows the details of each request made to the server. When a malicious document is opened, it sends an initial request to the server that contains the embedded ID. This connection is logged on the server as \u201cOPEN\u201d.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-03-41-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 7. Initial MWI beacon\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe server responds with a JPG. This is followed by a second connection that contains the same URI with \u0026quot;\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E\u0026amp;act=1\u003C\/span\u003E\u201d appended which initiates the download of the malware payload:\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-04-07-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 8. Second MWI beacon and EXE download\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThis request is logged on the server as \u201cLOAD\u201d. This indicates that the payload has been successfully sent to the victim.\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-06-06-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 9. MWISTAT \u201cSTATS\u201d View\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe \u201cSTATS\u201d view can show statistics for all the campaigns, or an individual campaign. The operators can view the number of \u201cOPENED\u201d malicious documents, the number of \u201cLOADED\u201d payloads, as well as any connections labeled \u201cSUSPICIOUS\u201d.\u003C\/p\u003E\n\u003Cp\u003EThe author of MWISTAT explains that the \u201cSUSPICIOUS\u201d label is meant to detect hacking attempts, antivirus companies, researchers, and other \u201cundesirables\u201d.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/mwi10.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-06.33-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Ci\u003EFigure 10. Explanation of \u201cSUSP\u201d label by \u201cObjekt\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EIn this view the operator can also see the individual IP addresses and the associated statistics.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-08-35-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003EThe \u201cTOOLS\u201d view presents a simple form to look up an IP address in WHOIS. This will provide information about the network and country to which an IP address belongs.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-09-42-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003EWe also found a new version of the source code for MWISTAT 2.0a that also displays information on the version of Microsoft Office that was used to open the malicious Word document.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EIn the Wild\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EWe have observed MWISTAT on three servers connected with active campaigns throughout December 2014.\u0026nbsp; Two of the servers appear to be associated with one campaign; however, there is no overlap with the third server. We have grouped the first two into \u201cCluster 1\u201d and the second into \u201cCluster 2\u201d.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EMWISTAT Cluster 1\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EDespite the stipulation that MWI be used for targeted attacks, the malicious Word documents associated with the first cluster are being propagated via spam. The emails are often spoofed to appear to be from legitimate companies and promote topics such as discounts and promotions for holiday shopping.\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp style=\u0022font-family: \u0027Courier New\u0027, Courier; margin-left: 40px;\u0022\u003ESubject: Your promocode to missguidedau.com.\u003Cbr\u003E\nFrom: Your myshopping.com.au \u0026lt;promo@missguidedau.com\u0026gt;\u003Cbr\u003E\nReply-To: discount@missguidedau.com\u003C\/p\u003E\n\u003Cp style=\u0022font-family: \u0027Courier New\u0027, Courier; margin-left: 40px;\u0022\u003ESubject: Your promo code boohoo.com .\u003Cbr\u003E\nFrom: forever21.com \u0026lt;manager@forever21.com\u0026gt;\u003Cbr\u003E\nReply-To: \u0026lt;manager@forever21.com\u0026gt;\u003C\/p\u003E\n\u003Cp style=\u0022font-family: \u0027Courier New\u0027, Courier; margin-left: 40px;\u0022\u003ESubject: Your promo code best buy.ca .\u003Cbr\u003E\nFrom: forever211.com \u0026lt;manageripromo@forever211.com\u0026gt;\u003Cbr\u003E\nReply-To: \u0026lt;manageripromo@forever21.com\u0026gt;\u003C\/p\u003E\n\u003Cp style=\u0022font-family: \u0027Courier New\u0027, Courier; margin-left: 40px;\u0022\u003ESubject: Kraft Foods offers you a $10 coupon\u003Cbr\u003E\nFrom: Ngweelam \u0026lt;hireamaeukoq@engineer.com\u0026gt;\u003C\/p\u003E\n\u003Cp style=\u0022font-family: \u0027Courier New\u0027, Courier; margin-left: 40px;\u0022\u003ESubject: Hey hon! Just sent you a gift, please check up your address!\u003Cbr\u003E\nFrom: Jesica \u0026lt;jesica.larson@hotmsi.com\u0026gt;\u003C\/p\u003E\n\u003Cp\u003EThe emails contain malicious Word document attachments that, when opened, connect to the MWISTAT servers in order to download a malicious payload.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EDocument MD5 \u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EServer\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EID\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E453f48485edd90d1ab2a3063682931d6\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Edetails.doc \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E64440521\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E662ebfa5e7f5f46a0ab2b4d71eab82a3\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u0026nbsp;\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E64440521\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ee215dd49ee49ecfe40ada964d23c8462\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Edetails.doc \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E64440521\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E8d1f47f61f68b1e302f67c6ab2c92447\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u0026nbsp;\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E44666745\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Efb9954f4dcdc79f03eddad51ac05ff39\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Edetails.doc \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E92998405\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ebb6cf9f84933839e963f6ad249fa6d01\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Evoucher.doc\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E18816473\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E20a635fd5e5dade0221ccea973d518d9 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E185.10.57.145 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ediscount.doc\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E79209229 \u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Eef820fb52eac099a16830bba5241fc26 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E185.10.57.145 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Epromo.doc\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E56006294 \u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ed252527ca044918dd9ce132022ae5afa\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E185.10.57.145\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ecoupon.doc\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E82087002\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E82af90c3854014f96fb53b1eedc2031d\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E217.12.201.169\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EInformation.doc \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E98772089\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0cf8ca4594b3b74e8f5a277935497954\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E217.12.201.169\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u0026nbsp;\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E98772089\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EOnce the document is opened, there is a connection to the MWI webserver and the EXE payload is downloaded.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EPayload MD5\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EID\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u0022289\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EPayload C2\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E04a35ce286644c9e0f994cc08210a5b4 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E64440521 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u0022289\u0022 rowspan=\u00228\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ehibromineltdpromefugeline[.]com \u003Cbr\u003E\n spoptimalwwwdirectconn[.]com \u003Cbr\u003E\n megasalesoncelebrates[.]com \u003Cbr\u003E\n toysgameshop[.]com \u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2248ff40fb9cae664f41e22dd9ea3c00 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E44666745 \u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E51f6b9cb6b80bdc45e65f9aab5668364 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E92998405 \u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ecd9a0148067b5526a407b10055e59b89 \u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E18816473 \u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2248ff40fb9cae664f41e22dd9ea3c00\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E79209229\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E86d9327f232666d3ef5a302980a8b74d\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E56006294\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E1c5469f218168aed52525b234e163d6d\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E94064837\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E7b6ccb3e8a3be1834b16d4267c919213\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E52421746\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E1d9139763ef6ffe76c7444f917130a9f\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E92931189\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u0022289\u0022 rowspan=\u00222\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Etoysgameshop[.]com\u003Cbr\u003E\n adwordactivation[.]com\u003Cbr\u003E\n ftdeveloppromo[.]com\u003Cbr\u003E\n christmaslastdeals[.]com\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ee10038f0ff768dbb9bffcca11b873f05\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E82087002\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ec51af8e1f336dc6aaf7df79f81d1010f\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E98772089\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u0022289\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ewebcodepremium[.]com \u003Cbr\u003E\n adwordactivation[.]com \u003Cbr\u003E\n ftdeveloppromo[.]com\u003Cbr\u003E\n christmaslastdeals[.]com\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EAn additional payload was found on \u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E185.10.57.145\u003C\/span\u003E for which we could not find a corresponding word document.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EPayload MD5\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EID\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u0022289\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EPayload C2\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022205\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E88737895ff8fed5e63b7b4b16a91c2ac\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u002296\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E91870027\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd width=\u0022289\u0022 valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E193.109.69.58\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EThe above payload is \u003Ca href=\u0022https:\/\/www.fireeye.com\/blog\/threat-research\/2014\/02\/xtremerat-nuisance-or-threat.html\u0022\u003EXtreme RAT\u003C\/a\u003E and is configured with the password \u0026quot;\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E1122334455\u003C\/span\u003E\u0026quot;.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EChthonic\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EThe payload of the MWI documents in this case was Chthonic, which was recently documented by \u003Ca href=\u0022http:\/\/securelist.com\/blog\/virus-watch\/68176\/chthonic-a-new-modification-of-zeus\/\u0022\u003EKaspersky\u003C\/a\u003E. The Chthonic malware has many similarities with Andromeda and Zeus, suggesting they share some of the same source code.\u003C\/p\u003E\n\u003Cp\u003EThe Chthonic malware goes through several stages of unpacking before the actual payload is executed. The first stage packer is a simple Visual Basic packer that performs basic anti-analysis checks (\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EPEB.BeingDebugged\u003C\/span\u003E and \u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EPEB.NtGLobalFlag\u003C\/span\u003E) before extracting the packed executable to memory. In this stage, the packed executable is written to memory in PE format and can be extracted or scraped from memory. The second stage packer is the same packer used by \u003Ca href=\u0022https:\/\/www.virusbtn.com\/virusbulletin\/archive\/2013\/05\/vb201305-Andromeda-botnet\u0022\u003EAndromeda\u003C\/a\u003E that protects the payload using RC4 and aPLib compression. In this stage, the packer manually loads the protected executable by creating memory segments, applying the relocation table, and setting up the import table.\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003EOnce the payload for the second stage packer is decoded and executed, it checks the environment for possible analysis tools. Similar to Andromeda, if any of these checks are successful, the malware enters an infinite sleep loop.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EAction\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003ETarget\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd rowspan=\u00225\u0022 valign=\u0022top\u0022\u003EOpen File\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EC:\\popupkiller.exe\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EC:\\TOOLS\\execute.exe\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E\\\\.\\NPF_NdisWanIp\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E\\\\.\\HGFS\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E\\\\.\\VBoxGuest\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003ELoads library\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003ESbieDll.dll\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003ECreates mutex\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EFrz_State\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd rowspan=\u00222\u0022 valign=\u0022top\u0022\u003EOpens registry path\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EHKCU\\Software\\WINE\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EHKLM\\Software\\WINE\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003ERunning process checksum\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x99DD4432\u003Cbr\u003E\n 0x2D859DB4\u003Cbr\u003E\n 0x349C9C8B\u003Cbr\u003E\n 0x3446EBCE\u003Cbr\u003E\n 0x5BA9B1FE\u003Cbr\u003E\n 0x3CE2BEF3\u003Cbr\u003E\n 0x3D46F02B\u003Cbr\u003E\n 0x77AE10F7\u003Cbr\u003E\n 0xF344E95D\u003Cbr\u003E\n 0x2DBE6D6F\u003Cbr\u003E\n 0xA3D10244\u003Cbr\u003E\n 0x1D72ED91\u003Cbr\u003E\n 0x96936BBE\u003Cbr\u003E\n 0x5714C206\u003Cbr\u003E\n 0x12C34675\u003Cbr\u003E\n 0xF94B28A4\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EThe malware is primarily a downloader that obtains additional modules using HTTP POST requests. The POST content is first encoded where each byte is XORed with the previous byte.\u0026nbsp; The encoded message is then encrypted with RC4 using the key \u201c\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0F 40 7F 12 07 F3 FD 1D 80 11 8D BB 05 7E 89 01\u003C\/span\u003E\u201d.\u003C\/p\u003E\n\u003Cp\u003EThe initial beacon message includes information about the system and the malware itself. The following is a sample decrypted beacon message is below:\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E00000000\u0026nbsp; fb 76 e3 ff b2 e0 bb cc\u0026nbsp; 30 41 72 aa 3c 1c d8 09 .v......0Ar.\u0026lt;...\u003Cbr\u003E\n 00000010\u0026nbsp; ce a8 72 04 49 01 00 00\u0026nbsp; 00 00 00 00 0c 00 00 00 ..r.I...........\u003Cbr\u003E\n 00000020\u0026nbsp; 6f 30 ad ef f0 a0 62 36\u0026nbsp; 31 86 84 61 23 8d 54 e8 o0....b61..a#.T.\u003Cbr\u003E\n 00000030\u0026nbsp; 21 27 00 00 00 00 00 00\u0026nbsp; 04 00 00 00 04 00 00 00 !\u0027..............\u003Cbr\u003E\n 00000040\u0026nbsp; 0a 00 00 20 11 27 00 00\u0026nbsp; 00 00 00 00 1f 00 00 00 ... .\u0027..........\u003Cbr\u003E\n 00000050\u0026nbsp; 1f 00 00 00 54 45 53 54\u0026nbsp; 53 59 53 54 45 4d 31 32 ....TESTSYSTEM12\u003Cbr\u003E\n 00000060\u0026nbsp; 33 34 5f 37 32 33 31 37\u0026nbsp; 36 38 46 33 31 31 32 44 34_7231768F3112D\u003Cbr\u003E\n 00000070\u0026nbsp; 31 30 41 13 27 00 00 00\u0026nbsp; 00 00 00 04 00 00 00 04 10A.\u0027...........\u003Cbr\u003E\n 00000080\u0026nbsp; 00 00 00 00 08 00 02 14\u0026nbsp; 27 00 00 00 00 00 00 04 ........\u0027.......\u003Cbr\u003E\n 00000090\u0026nbsp; 00 00 00 04 00 00 00 01\u0026nbsp; 00 00 00 27 27 00 00 00 ...........\u0027\u0027...\u003Cbr\u003E\n 000000A0\u0026nbsp; 00 00 00 04 00 00 00 04\u0026nbsp; 00 00 00 00 00 00 00 12 ................\u003Cbr\u003E\n 000000B0\u0026nbsp; 27 00 00 00 00 00 00 06\u0026nbsp; 00 00 00 06 00 00 00 6c \u0027..............l\u003Cbr\u003E\n 000000C0\u0026nbsp; 6f 76 65 39 61 1d 27 00\u0026nbsp; 00 00 00 00 00 06 00 00 ove9a.\u0027.........\u003Cbr\u003E\n 000000D0\u0026nbsp; 00 06 00 00 00 02 03 28\u0026nbsp; 0a 00 00 1e 27 00 00 00 .......(....\u0027...\u003Cbr\u003E\n 000000E0\u0026nbsp; 00 00 00 02 00 00 00 02\u0026nbsp; 00 00 00 09 04 35 27 00 .............5\u0027.\u003Cbr\u003E\n 000000F0\u0026nbsp; 00 00 00 00 00 10 00 00\u0026nbsp; 00 10 00 00 00 04 a3 5c ...............\\\u003Cbr\u003E\n 00000100\u0026nbsp; e2 86 64 4c 9e 0f 99 4c\u0026nbsp; c0 82 10 a5 b4 36 27 00 ..dL...L.....6\u0027.\u003Cbr\u003E\n 00000110\u0026nbsp; 00 00 00 00 00 04 00 00\u0026nbsp; 00 04 00 00 00 00 00 00 ................\u003Cbr\u003E\n 00000120\u0026nbsp; 00 37 27 00 00 00 00 00\u0026nbsp; 00 04 00 00 00 04 00 00 .7\u0027.............\u003Cbr\u003E\n 00000130\u0026nbsp; 00 01 00 00 00 38 27 00\u0026nbsp; 00 00 00 00 00 04 00 00 .....8\u0027.........\u003Cbr\u003E\n 00000140\u0026nbsp; 00 04 00 00 00 1a 00 00\u0026nbsp; 00\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; .........\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe message header is the first 0x30 bytes of the decrypted POST content. The following table details each of the fields included in a message header.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EOffset\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EValue\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EDetails\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0000\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Efb 76 e3 \u2026 a8 72 04\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003ERandom bytes\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0014\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x00000149\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003ELength of message\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0018\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x00000000\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EUnknown\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E001C\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x0000000C\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003ENumber of entries in payload\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0020\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E6f 30 ad \u2026 8d 54 e8\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EMD5 of message payload\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0030\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E21 27 00 \u2026\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EMessage payload\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EThe message payload stores information using structures that tag information based on content it contains. \u0026nbsp;For example, the source IP of the client is stored using the identifier \u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x2721\u003C\/span\u003E.\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Estruct message_entry {\u003Cbr\u003E\n DWORD ID;\u003Cbr\u003E\n DWORD flags;\u003Cbr\u003E\n DWORD len0;\u003Cbr\u003E\n DWORD len1;\u003Cbr\u003E\n uchar entry[len0];\u003Cbr\u003E\n }\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe following table contains the entries that are included in a beacon message:\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EID\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EValue\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EDetails\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2721\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x2000000a\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EIP address of the source interface\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2711\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003ETESTSYSTEM1234_7231768F3112D10A\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EThe system hostname followed by the CRC32 of the version information structure and CRC32 of the system install date.\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2713\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x02000800\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EHardcoded\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2714\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x00000001\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EHardcoded\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2727\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x00000000\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EActive process bitmap\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2712\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Elove9a\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EInternal value, possible campaign ID\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E271d\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0203280a0000\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EOS version information\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E271e\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x0409\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EThe default language\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2735\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E04a35ce286644c9e0f994cc08210a5b4\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EMD5 hash of implant\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2736\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x00000000\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EIf OS major version is greater than 5, contains sub authority SID information\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2737\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x00000001\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003ESet to 1 if current account is in the administrators group\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2738\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E0x0000001a\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003EDelta between two successive calls to GetTickCount\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EResponses from the server can be an update to the implant or additional modules to be loaded.\u0026nbsp; According to analysis by \u003Ca href=\u0022http:\/\/securelist.com\/blog\/virus-watch\/68176\/chthonic-a-new-modification-of-zeus\/\u0022\u003EKaspersky\u003C\/a\u003E, these modules include the capability to collect system information, extract saved passwords, enable remote access (VNC) and log keystrokes in addition to the ability to turn the compromised host into a proxy server and use the camera to take pictures. In addition, they found a web injection and formgrabber module that allow the attackers to steal banking credentials.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EConnection to Previous Activity\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EWe also found an MWI payload (\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E1c5469f218168aed52525b234e163d6d\u003C\/span\u003E) that was hosted on both \u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E81.17.19.134\u003C\/span\u003E and \u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Efacesecyrity[.]com\u003C\/span\u003E. \u0026nbsp;This appears to have been an earlier campaign in which MWISTAT was not used to track the download of the malicious payloads. Instead, the payload is directly downloaded.\u003C\/p\u003E\n\u003Cp\u003EThe malware was sent out with an interesting email message that appears to target Australians (which is also reflected in the victim data from the subsequent MWI campaign presented below).\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-13-24-pm.png\u0022\u003E\u003Cbr\u003E\n\u003Ci\u003EFigure 13. Email directed toward Australian users\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malicious Word document (\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E34fd939ccb914638da169fcffeef9e77, report.doc\u003C\/span\u003E), contained within the attached ZIP file, opens a connection to:\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-16-16-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Cbr\u003E\n\u003Ci\u003EFigure 14. MWI document downloads an EXE\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe payload is the same Chthonic malware family being dropped by the MWI campaign.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EMD5\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EC2\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E2bfa141fa2f5c05d7d5c7282769594a6\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Emod2.exe\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Emetaframeworkshop.com\u003Cbr\u003E\n spoptimalwwwdirectconn.com\u003Cbr\u003E\n hibromineltdpromefugeline.com\u003Cbr\u003E\n megasalesoncelebrates.com\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EWe found another similar campaign that also dropped the same Chthonic malware.\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-16-47-pm.png\u0022\u003E\u003Cbr\u003E\n\u003Ci\u003EFigure 15. Email directed at Australian users\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EThe attached ZIP file contains a malicious Word document (\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E603f1fcb9897e8aaf8becfc6127d40a7, Info.doc\u003C\/span\u003E) which, instead of connecting out to a server to download the payload, simply drops a payload contained within the malicious document.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EMD5\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EC2\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ea3b15ea2ceee7a1910fcc7ab3a27f03b\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Entxobj.exe\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ehibromineltdpromefugeline[.]com\u003Cbr\u003E\n spoptimalwwwdirectconn[.]com\u003Cbr\u003E\n megasalesoncelebrates[.]com\u003Cbr\u003E\n toysgameshop[.]com\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cb\u003EMWISTAT Victims\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EWe were able to collect log files from the C2\u2019s used in this MWISTAT campaign \u0026nbsp;(Cluster 1) between Dec 12, 2014 \u2013 January 6, 2015.\u003C\/p\u003E\n\u003Cp\u003EThe data indicates that 809 users opened the malicious documents. However, only 144 of those successfully downloaded the malware payload. There were 136 \u201csuspicious\u201d connections. A total of 934 unique IP addresses beaconed to the MWISTAT servers.\u003C\/p\u003E\n\u003Cp\u003EAlthough the victims span 43 countries, the majority are located in Canada (41%) and Australia (31%). The country with the second highest victim population is the USA (13%).\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-19-19-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Cbr\u003E\n\u003Ci\u003EFigure 16. MWISTAT victims by country\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003E\u0026nbsp;\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EChthonic Victims\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EWe were able to sinkhole 3 of the domains used by the Chthonic payload dropped by Cluster 1\u2019s MWISTAT malicious documents. This data is just a partial view into this cluster of Chthonic activity. Between January 8 2015 and January 13, 2015 a total of 7,962 unique IP addresses connected to our sinkhole. These IP addresses were spread across 83 countries, however the highest concentrations were located in Germany (30%), Canada (13%) and Russia (12%).\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-19-47-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Cbr\u003E\n\u003Ci\u003EFigure 17.\u0026nbsp; Chthonic victims by country (via sinkhole)\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EBased on posts on an underground forum, we believe that the developer of Chthonic supplies binaries to other cyber-criminals and rents out the C2 infrastructure. Therefore, this distribution of victims likely represents several otherwise unconnected cyber-crime operations.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EMWISTAT Cluster 2\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EDuring our research, we found another set of MWI activity that does not appear to be related to the cluster documented above. The \u201cCluster 2\u201d campaign sent out emails that appeared to be shipping information in order to lure the recipient into opening the malicious attachment:\u003C\/p\u003E\n\u003Cp style=\u0022font-family: \u0027Courier New\u0027, Courier; margin-left: 40px;\u0022\u003ESubject: Shipment to TECLINK INTERNATIONAL\u003Cbr\u003E\nFrom: Lee Hing Co.\u5229\u8208\u516c\u53f8 \u0026lt;abdulaziz@ekadacorporation.com\u0026gt;\u003C\/p\u003E\n\u003Cp\u003EThe attachments were malicious Word documents that connected to an MWI server in order to download the malicious payload.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EMD5\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EID\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E4adae24a22468b1516afc7e5f0f9e893\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EInvoice 0938.doc\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E99120076\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Eab5cab6b202487caffb3e4148c1caf03\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003EItem list.doc\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E52421746\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EThe payload is this case was XtremeRAT (configured with the default password).\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EMD5\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EID\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cb\u003EC2\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E5ef604525d8c268e261e9a15b461d916\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E99120076\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Ebigb00.ddns[.]net\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E7b6ccb3e8a3be1834b16d4267c919213\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003E52421746\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cspan style=\u0022font-family: \u0027Courier New\u0027, Courier;\u0022\u003Efragment.myeffect[.]net\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EBeyond the use of the MWI package there does not appear to be any overlap between the clusters documented in this post. \u003Cb\u003EThis indicates that MWI is being sold to multiple actors.\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EVictims\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EWe were able to collect log files from the C2\u2019s used in the \u201cCluster 2\u201d MWISTAT campaign between December 12, 2014 \u2013 January 6, 2015.\u003C\/p\u003E\n\u003Cp\u003EThe data indicates that 597 users opened the malicious documents. However, only 180 of those successfully downloaded the malware payload. There were 182 \u201csuspicious\u201d connections. A total of 402 unique IP addresses beaconed to the MWISTAT servers.\u003C\/p\u003E\n\u003Cp\u003EThe victims span 45 countries, however, the majority are located in Vietnam (18%), US (12%) and China (9%).\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/Word%20exploit\/screen-shot-2015-03-24-at-9-21-59-pm.png\u0022\u003E\u003C\/p\u003E\n\u003Cp style=\u0022text-align: center;\u0022\u003E\u003Cbr\u003E\n\u003Ci\u003EFigure 18. MWISTAT victims by country\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EConclusion\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EA wide variety of cybercriminals, even those with minimal technical capability, now have access to document exploits through the purchase of Document Exploit Kits such as \u201cMicrosoft Word Intruder\u201d. Much like Browser Exploit Kits, these tools allow operators to track a variety of campaigns and information about their victims in order to improve their effectiveness.\u003C\/p\u003E\n",
        "jcr:lastModified": "Thu Apr 02 2015 21:18:58 GMT-0400",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "alt": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "comments": {
        "jcr:primaryType": "nt:unstructured",
        "sling:resourceType": "social\/commons\/components\/comments"
      },
      "trackback": {
        "jcr:primaryType": "nt:unstructured",
        "sling:resourceType": "social\/blog\/components\/trackback"
      }
    }
  }
}
