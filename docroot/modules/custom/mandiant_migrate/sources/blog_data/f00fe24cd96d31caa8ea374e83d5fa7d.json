{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "admin",
  "jcr:created": "Wed May 04 2016 09:03:58 GMT-0400",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "admin",
    "jcr:title": "Now You See Me - H-worm by Houdini",
    "cq:lastReplicationAction": "Activate",
    "jcr:versionHistory": "efaca7cb-37aa-4265-8fe0-0201ba6c27bf",
    "author": "Thoufique Haq",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "cq:lastReplicatedBy": "lynda.hall@fireeye.com",
    "jcr:language": "en_us",
    "jcr:predecessors": [
      "459c7b87-7bbf-4cc2-a840-e3500350151d"
    ],
    "jcr:created": "Tue Nov 01 2016 14:02:45 GMT-0400",
    "cq:lastReplicated": "Tue Nov 01 2016 14:02:45 GMT-0400",
    "cq:lastModified": "Tue Nov 01 2016 14:00:45 GMT-0400",
    "jcr:baseVersion": "459c7b87-7bbf-4cc2-a840-e3500350151d",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-doctypes:blog",
      "fireeye-blog-authors:cap-thoufique-haq",
      "fireeye-blog-authors:cap-ned-moran"
    ],
    "jcr:uuid": "9207cdfd-dc33-410f-8e0b-6aff8db51c84",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Tue Sep 24 2013 14:43:22 GMT-0400",
    "cq:lastModifiedBy": "lynda.hall@fireeye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "lynda.hall@fireeye.com",
        "text": "\u003Cp\u003EH-worm is a VBS (Visual Basic Script) based RAT written by an individual going by the name Houdini. We believe the author is based in Algeria and has connections to njq8, the author of \u003Ca href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2013\/08\/njw0rm-brother-from-the-same-mother.html\u0022\u003Enjw0rm\u003C\/a\u003E [1] and \u003Ca href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2012\/09\/the-story-behind-backdoorlv.html\u0022\u003EnjRAT\/LV\u003C\/a\u003E [2] through means of a shared or common code base. We have seen the H-worm RAT being employed in targeted attacks against the international energy industry; however, we also see it being employed in a wider context\u0026nbsp;as run of the mill attacks\u0026nbsp;through spammed email attachments and\u0026nbsp;malicious links.\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EThe Payload\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EThe H-worm payload is simply a VBS file, which is often wrapped, in a PE executable dropper. The H-worm VBS file is also packed with multiple layers of obfuscation in some cases. While analyzing such samples (\u003Ca href=\u0022https:\/\/www.virustotal.com\/en\/file\/3c63b1f8081ce2c617f171da6c4a9300aa66c57efeb5b70eaef6aa929e3e8f7b\/analysis\/\u0022\u003E81c153256efd9161f4d89fe5fd7015bc\u003C\/a\u003E and \u003Ca href=\u0022https:\/\/www.virustotal.com\/en\/file\/10f34ce36745a4b7ff7d584132b5d865fde02f0086c8bbfef58b18322ea225d9\/analysis\/\u0022\u003E4543daa6936dde54dda8782b89d5daf1\u003C\/a\u003E), we discovered that they were obfuscated with custom Base64 encoding, multiple levels of standard Base64 encoding (\u003Ca href=\u0022https:\/\/www.virustotal.com\/en\/file\/945374cbb07f910c5e7d06b12b65b21336bf7cc7fa67f8bd894018bdf6bebb3e\/analysis\/\u0022\u003ESafa Crypter\u003C\/a\u003E), and character substitutions. The obfuscation techniques used have been described \u003Ca href=\u0022http:\/\/pwndizzle.blogspot.com\/2013\/09\/how-not-to-obfuscate-your-malware.html\u0022\u003Ehere\u003C\/a\u003E [3] already and are summarized in Figure 1 below. There is also an \u003Ca href=\u0022http:\/\/pastebin.com\/vMQWsvHS\u0022\u003EAutoit version of H-wor\u003C\/a\u003E\u003Ca href=\u0022http:\/\/pastebin.com\/vMQWsvHS\u0022\u003Em\u003C\/a\u003E called the \u0026quot;underworld version\u0026quot; floating around which has the same functionality as the VBS version.\u003C\/p\u003E\n\u003Cp\u003E\u003Ca href=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd1.png\u0022\u003E\u003Cimg class=\u0022 wp-image-3338  portrait-med\u0022 src=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd1.png\u0022 width=\u0022545\u0022 height=\u00221050\u0022\u003E\u003C\/a\u003E\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cdl class=\u0022wp-caption alignnone\u0022 style=\u0022width: 555px;\u0022\u003E\n\u003Cdd class=\u0022wp-caption-dd\u0022\u003EFigure 1 - Multiple layers of obfuscation\u003C\/dd\u003E\u003C\/dl\u003E\n\u003Cp\u003E\u003Cb\u003E\u003Cspan style=\u0022color: #000000;\u0022\u003E\u003Cbr\u003E\nDissecting Command and Control (CnC) Behavior\u003C\/span\u003E\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EUpon successful compromise, the worm generates network telemetry (beacon), as shown below:\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003EPOST \/is-ready HTTP\/1.1\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EAccept: *\/*\u003C\/p\u003E\n\u003Cp\u003EAccept-Language: en-us\u003C\/p\u003E\n\u003Cp\u003EUser-Agent: {DiskVolumeSerial}\u0026lt;|\u0026gt;{Hostname}\u0026lt;|\u0026gt;{Username}\u0026lt;|\u0026gt;{OS}\u0026lt;|\u0026gt;plus\u0026lt;|\u0026gt;{AVProductInstalled or nan-av}\u0026lt;|\u0026gt;{USBSpread: true or false} - {CurrentSystemDate}\u003C\/p\u003E\n\u003Cp\u003EAccept-Encoding: gzip, deflate\u003C\/p\u003E\n\u003Cp\u003EHost: silent9.zapto.org:7895\u003C\/p\u003E\n\u003Cp\u003EContent-Length: 0\u003C\/p\u003E\n\u003Cp\u003EConnection: Keep-Alive\u003C\/p\u003E\n\u003Cp\u003ECache-Control: no-cache\u003C\/p\u003E\n\u003Cp\u003EAs seen in the beacon, it sends out various pieces of sensitive identification information in the User-Agent field. We have also observed versions where the URI was modified to use other strings such as \u0026quot;POST \/I_AM_READY\u0026quot;. The keyword \u0026quot;\u0026lt;|\u0026gt;plus\u0026lt;|\u0026gt;\u0026quot; is constant in the beacon but we have seen versions where this was modified as well. We saw instances where \u0026quot;\u0026lt;|\u0026gt;underworld final\u0026lt;|\u0026gt;\u0026quot; was used instead. It expects a response of the form:\u003C\/p\u003E\n\u003Cp\u003E{command}\u0026lt;|\u0026gt;{param1}\u0026lt;|\u0026gt;{param2}\u003C\/p\u003E\n\u003Cp\u003EThe worm supports the following remote commands:\u003C\/p\u003E\n\u003Ctable class=\u0022c09 c09-zebra has-data-label\u0022\u003E\n\u003Ctbody\u003E\u003Ctr class=\u0022c09_tr c09_tr-th\u0022\u003E\u003Cth class=\u0022c09_td\u0022 scope=\u0022col\u0022\u003ECommand\u003C\/th\u003E\n\u003Cth class=\u0022c09_td\u0022 scope=\u0022col\u0022\u003EDescription\u003C\/th\u003E\n\u003Cth class=\u0022c09_td\u0022 scope=\u0022col\u0022\u003ECommunication Request generated\u003C\/th\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Eexecute\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Eexecute\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EExecutes param value using \u0027execute\u0027\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EExecutes param value using \u0027execute\u0027\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003E-\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003E-\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Eupdate\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Eupdate\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EReplaces the payload and restarts with the wscript engine\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EReplaces the payload and restarts with the wscript engine\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003E-\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003E-\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Euninstall\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Euninstall\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EDeletes startup entries and payload\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EDeletes startup entries and payload\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003E-\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003E-\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Esend\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Esend\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EDownloads file from CnC server\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EDownloads file from CnC server\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EPOST \/is-sending\u0026lt;|\u0026gt;{FileURL}\u2026\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EPOST \/is-sending\u0026lt;|\u0026gt;{FileURL}\u2026\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Esite-send\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Esite-send\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EDownloads file from URL\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EDownloads file from URL\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EGET \/{FileURL}\u2026\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EGET \/{FileURL}\u2026\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Erecv\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Erecv\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EUploads file to CnC server\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EUploads file to CnC server\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EPOST \/ is-recving\u0026lt;|\u0026gt;{FilePath}\u2026\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EPOST \/ is-recving\u0026lt;|\u0026gt;{FilePath}\u2026\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Eenum-driver\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Eenum-driver\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003ESends all drive information to the CnC\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003ESends all drive information to the CnC\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EPOST \/is-enum-driver\u2026{DrivePath|DriveType\u0026lt;|\u0026gt;\u2026}\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EPOST \/is-enum-driver\u2026{DrivePath|DriveType\u0026lt;|\u0026gt;\u2026}\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Eenum-faf\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Eenum-faf\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003ESends all file and folder attributes in a specified directory\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003ESends all file and folder attributes in a specified directory\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EPOST \/is-enum-faf\u2026{FolderName|(FileSize)|(d|f)|Attributes\u0026lt;|\u0026gt;\u2026}\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EPOST \/is-enum-faf\u2026{FolderName|(FileSize)|(d|f)|Attributes\u0026lt;|\u0026gt;\u2026}\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Eenum-process\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Eenum-process\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003ESends all running processed\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003ESends all running processed\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EPOST \/is-enum-process\u2026{Name|PID|Path\u0026lt;|\u0026gt;\u2026}\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EPOST \/is-enum-process\u2026{Name|PID|Path\u0026lt;|\u0026gt;\u2026}\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Ecmd-shell\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Ecmd-shell\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EExecutes param value with \u2018cmd.exe \/c\u2019 and returns result\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EExecutes param value with \u2018cmd.exe \/c\u2019 and returns result\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EPOST \/is-cmd-shell\u2026{Result}\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EPOST \/is-cmd-shell\u2026{Result}\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Edelete\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Edelete\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EDeletes file or folder specified in param\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EDeletes file or folder specified in param\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003E-\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003E-\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Eexit-process\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Eexit-process\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003EKills process specified in param\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003EKills process specified in param\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003E-\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003E-\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr class=\u0022c09_tr\u0022\u003E\u003Ctd data-label=\u0022Command:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003Esleep\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003Esleep\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Description:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003ESleep call in param is passed to eval()\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003ESleep call in param is passed to eval()\u003C\/span\u003E\u003C\/td\u003E\n\u003Ctd data-label=\u0022Communication Request generated:\u0022 class=\u0022c09_td\u0022\u003E\u003Cspan class=\u0022is-visible-mml\u0022\u003E \u003Cspan\u003E-\u003C\/span\u003E\u003C\/span\u003E \u003Cspan class=\u0022c09_td_value is-hidden-mml\u0022\u003E-\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003ETable 1 - Remote commands available in H-worm\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022color: #000000;\u0022\u003E\u003Cb\u003EBehind The Curtains\u003C\/b\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe control panel for H-worm has a builder and a controller interface to interact with the infected machine. The control panel is written in Delphi. Some of the features such as password grabber and USB spreading were not functional in the versions we analyzed. These features could be operational in newer versions of H-worm.\u003C\/p\u003E\n\u003Cp\u003E[caption id=\u0026quot;attachment_3339\u0026quot; align=\u0026quot;alignnone\u0026quot; width=\u0026quot;680\u0026quot;]\u003Ca href=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd2.png\u0022\u003E\u003Cimg class=\u0022 wp-image-3339   landscape-med\u0022 src=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd2.png\u0022 width=\u0022680\u0022 height=\u0022311\u0022\u003E\u003C\/a\u003E Figure 2 - Control panel of H-worm[\/caption]\u003C\/p\u003E\n\u003Cp\u003EThe author, Houdini, has a portal to show off his wares, which hosts a demonstration video of H-worm. The contents of the portal indicate that he is proficient in both French and Arabic. Based on this and various other identifiable clues in the video, it is likely that the author of H-worm is from Algeria. We also believe the thumbnail images briefly seen in the video may be of the author himself. For the keen eyed observers, it is also evident that the author likes to play \u0026quot;Beetle Bug 2\u0026quot; and \u0026quot;Chicken invaders 4\u0026quot;.\u003C\/p\u003E\n\u003Cp\u003E[caption id=\u0026quot;attachment_3340\u0026quot; align=\u0026quot;alignnone\u0026quot; width=\u0026quot;625\u0026quot;]\u003Ca href=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd3.png\u0022\u003E\u003Cimg class=\u0022 wp-image-3340  portrait-med\u0022 src=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd3.png\u0022 width=\u0022625\u0022 height=\u0022777\u0022\u003E\u003C\/a\u003E Figure 3 - Snippets from Houdini\u0027s demo of H-worm[\/caption]\u003C\/p\u003E\n\u003Cp\u003E\u003Cb\u003ECnC Intel Analysis\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003EOn further analysis of the command and control infrastructure, we discovered that the CnC infrastructure used by some of the H-worm variants were shared by others RATs such as NjW0rm, njRat\/LV, XtremeRAT, and PoisonIvy. The attackers behind these instances appear to have an arsenal of RATs at their disposal, in order to perform various attack campaigns.\u003C\/p\u003E\n\u003Cdiv class=\u0022blog-table-wrapper\u0022\u003E\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Ctable cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003ECnC Domain\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd colspan=\u00222\u0022 width=\u0022284\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003EOther associated RATs\u003C\/b\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Esilent9.zapto.org\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003ENjw0rm\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003Ea85c29d11016c633ef228fc58ebe2c14\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Eadolf2013.sytes.net\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003EXtremeRAT\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E12cc632f24497a2aa9bed63d36c2725d\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Eballgogo.no-ip.biz\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003EXtremeRAT\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E80b1f909d1217313c14ea6d4d0b003dc\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Epess-12.zapto.org\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003EDarkComet\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E6f3bad9a426a867f3ebf34bb68a75fe9\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Esidisalim.myvnc.com\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003ELV\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E82e6fc9a6b06fb51c134ba1755be23be\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Exkiller.no-ip.info\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003ELV\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003Ebe871515ce8246118446de9d563803231c2f0dd9613f52a73a8a1b1a8f1eada6, e96a6b06b0b46bd3cde7137c47137643\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Ekarimstar.zapto.org\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003ELV\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E3034ab284cf07b9215fb0ca715d3660f\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Esecurityfocus.bounceme.net\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003ELV\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E72679f31721e82111cc8797e0a6d7db48fa4, 0399e7bdcb2664a7634ac3ad3140\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd rowspan=\u00222\u0022 width=\u0022158\u0022 valign=\u0022top\u0022\u003E\u003Cb\u003Ekiyoma200.no-ip.biz\u003C\/b\u003E\u003C\/td\u003E\n\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003ELV\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003E945471684a57e1e6b73c0f22beceb25c, 471d61e7a3d936fa28efef3273b2dbd6\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002268\u0022 valign=\u0022top\u0022\u003EPoisonIvy\u003C\/td\u003E\n\u003Ctd width=\u0022217\u0022 valign=\u0022top\u0022\u003Ed833ba1b0ac9b512382433f47084bf52, eaba668520690207f07eb99fcd4c0cae\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003C\/div\u003E\n\u003Cp\u003ETable 2 - Direct overlaps on command and control infrastructure\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022color: #000000;\u0022\u003E\u003Cb\u003EPossible Connections to the njq8 Enterprise\u003C\/b\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EWe recently talked about \u003Ca href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2013\/08\/njw0rm-brother-from-the-same-mother.html\u0022\u003Enjw0rm\u003C\/a\u003E [1] and the author behind it, njq8. We found strong connections indicating that njw0rm and \u003Ca href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2012\/09\/the-story-behind-backdoorlv.html\u0022\u003EnjRAT\/LV\u003C\/a\u003E [2] were written by the same author. We believe H-worm is also linked to njq8, through a shared code base. An earlier version of H-worm was analyzed \u003Ca href=\u0022http:\/\/laudarch.blogspot.com\/2013\/05\/serviecavbs-reverse-engineered.html\u0022\u003Ehere\u003C\/a\u003E [4], by another researcher. It is evident from this older version, that the client side module was originally coded by njq8. The older version beacons with \u0026quot;POST \/ready\u0026quot; instead of \u0026quot;POST \/is-ready\u0026quot;, as seen in the newer versions. This blog was re-tweeted on the njq8 twitter page. Our earlier njw0rm blog was also promptly re-tweeted on the njq8 twitter page. \u0026nbsp;It is unclear how connected Houdini and njq8 are, but it is likely that njq8 is a group of individuals collaborating on the development of RATs, or alternatively, there are development forks on the same code base by multiple authors.\u003C\/p\u003E\n\u003Cp\u003E[caption id=\u0026quot;attachment_3343\u0026quot; align=\u0026quot;alignnone\u0026quot; width=\u0026quot;667\u0026quot;]\u003Ca href=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd5.png\u0022\u003E\u003Cimg class=\u0022 wp-image-3343 landscape-med\u0022 src=\u0022\/content\/dam\/legacy\/blog\/2013\/09\/houd5.png\u0022 width=\u0022667\u0022 height=\u0022364\u0022\u003E\u003C\/a\u003E Figure 4 - Common code base and njq8 connections[\/caption]\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022color: #000000;\u0022\u003E\u003Cb\u003EH-worm Hashes\u003C\/b\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E00df326eee18617fae2fdd3684ac1546\u003C\/p\u003E\n\u003Cp\u003E1488cdc5c5c9c87b4e0dae27ba3511cb\u003C\/p\u003E\n\u003Cp\u003E4543daa6936dde54dda8782b89d5daf1\u003C\/p\u003E\n\u003Cp\u003E80b1f909d1217313c14ea6d4d0b003dc\u003C\/p\u003E\n\u003Cp\u003E81c153256efd9161f4d89fe5fd7015bc\u003C\/p\u003E\n\u003Cp\u003Ec6b53fc46427527a0739e6b6443ef72d\u003C\/p\u003E\n\u003Cp\u003E9e273220eb71f849ea99b923cbc1fae3\u003C\/p\u003E\n\u003Cp\u003E43309710ab8f87dc5d9842a5bca85f80\u003C\/p\u003E\n\u003Cp\u003Ea40faab2f3f546aeb29aaefcb0f751d8\u003C\/p\u003E\n\u003Cp\u003E617a128b44671ac88df0b7180d9d0135\u003C\/p\u003E\n\u003Cp\u003Eae5c8ad09954a56f348a3b72ed824363\u003C\/p\u003E\n\u003Cp\u003Eda3e2eeffd78d8c5ef472b8a09e9d325\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022color: #000000;\u0022\u003E\u003Cb\u003EH-worm Command and Control (CnC) Infrastructure\u003C\/b\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003Eadamdam.zapto.org:1973\u003C\/p\u003E\n\u003Cp\u003Eadolf2013.sytes.net:1183\u003C\/p\u003E\n\u003Cp\u003Eadolf2013.sytes.net:1184\u003C\/p\u003E\n\u003Cp\u003Eahmad212.no-ip.biz:86\u003C\/p\u003E\n\u003Cp\u003Ealii007.zapto.org:288\u003C\/p\u003E\n\u003Cp\u003Ealii007.zapto.org:6611\u003C\/p\u003E\n\u003Cp\u003Eam1.no-ip.info:1888\u003C\/p\u003E\n\u003Cp\u003Eballgogo.no-ip.biz:8088\u003C\/p\u003E\n\u003Cp\u003Ebasss.no-ip.info:2026\u003C\/p\u003E\n\u003Cp\u003Ebasss.no-ip.info:82\u003C\/p\u003E\n\u003Cp\u003Ebg1337.zapto.org:1155\u003C\/p\u003E\n\u003Cp\u003Ebog5151.zapto.org:991\u003C\/p\u003E\n\u003Cp\u003Edataday3.no-ip.org:83\u003C\/p\u003E\n\u003Cp\u003Edocteuur13.no-ip.org:444\u003C\/p\u003E\n\u003Cp\u003Edoda.redirectme.net:777\u003C\/p\u003E\n\u003Cp\u003Edzhacker15.no-ip.org:82\u003C\/p\u003E\n\u003Cp\u003Eg00gle.sytes.net:4448\u003C\/p\u003E\n\u003Cp\u003Egerssy.zapto.org:6000\u003C\/p\u003E\n\u003Cp\u003Egooglechrome.servegame.com:1990\u003C\/p\u003E\n\u003Cp\u003Ehackediraq.no-ip.biz:88\u003C\/p\u003E\n\u003Cp\u003Ehackeralbasrah.no-ip.biz:8888\u003C\/p\u003E\n\u003Cp\u003Ehattouma12.no-ip.biz:88\u003C\/p\u003E\n\u003Cp\u003Ehmode123.no-ip.biz:9090\u003C\/p\u003E\n\u003Cp\u003Ekarimstar.zapto.org:85\u003C\/p\u003E\n\u003Cp\u003Ekiyoma200.no-ip.biz:1117\u003C\/p\u003E\n\u003Cp\u003Ekoko.myftp.org:9090\u003C\/p\u003E\n\u003Cp\u003Emda.no-ip.org:88\u003C\/p\u003E\n\u003Cp\u003Emedolife.no-ip.biz:1247\u003C\/p\u003E\n\u003Cp\u003Emicrosoftsystem.sytes.net:4442\u003C\/p\u003E\n\u003Cp\u003Emootje01.no-ip.org:81\u003C\/p\u003E\n\u003Cp\u003Emsgbox.zapto.org:5246\u003C\/p\u003E\n\u003Cp\u003Enew-hacker.no-ip.org:81\u003C\/p\u003E\n\u003Cp\u003Enjnj.redirectme.net:123\u003C\/p\u003E\n\u003Cp\u003Eno99.zapto.org:81\u003C\/p\u003E\n\u003Cp\u003Enoooot.no-ip.biz:443\u003C\/p\u003E\n\u003Cp\u003Epess-123.zapto.org:1604\u003C\/p\u003E\n\u003Cp\u003Epess-12.zapto.org:81\u003C\/p\u003E\n\u003Cp\u003Eportipv6.redirectme.net:1991\u003C\/p\u003E\n\u003Cp\u003Eronaldo-123.no-ip.biz:2011\u003C\/p\u003E\n\u003Cp\u003Eronaldo-123.no-ip.biz:2013\u003C\/p\u003E\n\u003Cp\u003Esawdz.no-ip.biz:333\u003C\/p\u003E\n\u003Cp\u003Esecurityfocus.bounceme.net:1166\u003C\/p\u003E\n\u003Cp\u003Eshagagy21.no-ip.biz:1605\u003C\/p\u003E\n\u003Cp\u003Esidisalim.myvnc.com:1888\u003C\/p\u003E\n\u003Cp\u003Esilent9.zapto.org:7895\u003C\/p\u003E\n\u003Cp\u003Eterminator9.zapto.org:1991\u003C\/p\u003E\n\u003Cp\u003Evpn-hacker.no-ip.biz:9090\u003C\/p\u003E\n\u003Cp\u003Exbox720.zapto.org:1991\u003C\/p\u003E\n\u003Cp\u003Exkiller.no-ip.info:1\u003C\/p\u003E\n\u003Cp\u003Eyahia17.no-ip.org:1177\u003C\/p\u003E\n\u003Cp\u003Ezeusback.no-ip.biz:223\u003C\/p\u003E\n\u003Cp\u003Ezoia.no-ip.org:446\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022color: #000000;\u0022\u003E\u003Cb\u003EReferences:\u003C\/b\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E[1] \/content\/fireeye-www\/global\/en\/www\/blog\/threat-research\/2013\/08\/njw0rm-brother-from-the-same-mother.html\u003C\/p\u003E\n\u003Cp\u003E[2] \/content\/fireeye-www\/global\/en\/www\/blog\/threat-research\/2012\/09\/the-story-behind-backdoorlv.html\u003C\/p\u003E\n\u003Cp\u003E[3] http:\/\/pwndizzle.blogspot.com\/2013\/09\/how-not-to-obfuscate-your-malware.html\u003Cb\u003E\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003E[4] http:\/\/laudarch.blogspot.com\/2013\/05\/serviecavbs-reverse-engineered.html\u003C\/p\u003E\n\u003Cp\u003EWe would like to thank Darien Kindlund, Nart Villeneuve, Uttang Dawda, Mike Scott, and Ali Mesdaq for their help and support.\u003C\/p\u003E\n",
        "jcr:lastModified": "Tue Nov 01 2016 14:00:45 GMT-0400",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    }
  }
}
