{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "fireeye_global_admin",
  "jcr:created": "Wed Feb 19 2020 18:32:57 GMT+0000",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "fireeye_global_admin",
    "jcr:title": "The Missing LNK \u2014 Correlating User Search LNK files",
    "jcr:versionHistory": "d733e8c5-e59f-4eb3-b2ef-fe510ea375e1",
    "author": "Ashley Frazer",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "jcr:language": "en_us",
    "jcr:predecessors": [
      "a66ee199-867a-4b54-8649-ec99d6b249ab"
    ],
    "jcr:created": "Wed Feb 19 2020 19:54:52 GMT+0000",
    "cq:lastModified": "Wed Feb 19 2020 19:54:45 GMT+0000",
    "jcr:baseVersion": "a66ee199-867a-4b54-8649-ec99d6b249ab",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-authors:ashley-frazer",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-tags:latest",
      "fireeye-blog-tags:homepage-carousel",
      "fireeye-blog-tags:mandiant",
      "fireeye-blog-tags:incident-response",
      "fireeye-blog-tags:lnk"
    ],
    "jcr:uuid": "4d41a205-7811-4bb7-bee9-d84ec99ecf41",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Wed Feb 19 2020 13:30:00 GMT-0500",
    "cq:lastModifiedBy": "adam.greenberg@fireeye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
        "text": "\u003Cp\u003EForensic investigators use LNK shortcut files to recover metadata about recently accessed files, including files deleted after the time of access. In a recent investigation, FireEye Mandiant encountered LNK files that indicated an attacker accessed files included in Windows Explorer search results. In our experience, this was a new combination of forensic artifacts. We\u2019re excited to share our findings because they help to paint a more complete picture of an attacker\u2019s actions and objectives on targeted systems. Further, these findings can also be leveraged for insider threat cases to determine the path used to locate and subsequently open a file.\u003C\/p\u003E\n\u003Ch4\u003EWindows LNK Format\u003C\/h4\u003E\n\u003Cp\u003EThe \u003Cspan class=\u0022code\u0022\u003E.lnk\u003C\/span\u003E extension is associated with a class of files known as Shell Items. These binary format files contain information that can be used to access other data objects in the Windows shell \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/docs.microsoft.com\/en-us\/openspecs\/windows_protocols\/ms-shllink\/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943\u0022\u003E(the graphical user interface)\u003C\/a\u003E.\u003C\/p\u003E\n\u003Cp\u003ELNK shortcut files are one type of Shell Item. They are created by the Windows operating system automatically when a user accesses a file from a supported application but can also be created by the user manually. LNK shortcut files typically contain metadata about the accessed file, including the file name and size, the original path, timestamps, volume and system information (ex. drive type and system hostname), and network information (ex. network share path). Fortunately, there are tools available that can parse these files. While internally at Mandiant we leverage FireEye Endpoint Security to parse LNK files and identify suspicious user search terms, for the purposes of this blog post we will be using \u003Ca href=\u0022https:\/\/github.com\/EricZimmerman\/LECmd\u0022\u003ELECmd\u003C\/a\u003E by Eric Zimmerman. Figure 1 shows the command line options for \u003Cspan class=\u0022code\u0022\u003ELECmd.exe\u003C\/span\u003E.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/lnk\/Picture1.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003EFigure 1: LECmd.exe command line options\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EParsed metadata within LNK shortcut files is relevant to forensic investigations for multiple use cases, including profiling user activity on a system or searching for references to malware that has since been deleted.\u003C\/p\u003E\n\u003Ch4\u003EUser Search LNK files\u003C\/h4\u003E\n\u003Cp\u003ERecently, Mandiant encountered LNK files whose format we did not initially recognize. The files came from a Windows Server 2012 R2 system and had paths like those shown in Figure 2. We guessed that they were LNK shortcut files based on their extension and file path; however, their content was not familiar to us.\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\passw.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\gov.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 2: Full file path of the unfamiliar LNK files\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EIn the previous examples, a forensic investigator would use the LNK shortcut filename to conclude that a user opened a file named \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E or \u003Cspan class=\u0022code\u0022\u003Egov\u003C\/span\u003E. Then, they would use a tool like \u003Cspan class=\u0022code\u0022\u003ELECmd\u003C\/span\u003E to recover additional metadata. This would provide them with the full file path of the accessed file and the timestamps of the file at the time it was accessed - among other forensic information.\u003C\/p\u003E\n\u003Cp\u003EHowever, the previous LNK files did not reveal expected metadata. Figure 3 shows the output of \u003Cspan class=\u0022code\u0022\u003ELECmd\u003C\/span\u003E for \u003Cspan class=\u0022code\u0022\u003Epassw.lnk\u003C\/span\u003E (some information omitted for clarity).\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ELECmd version 1.3.2.1\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EAuthor: Eric Zimmerman (saericzimmerman@gmail.com)\u003Cbr\u003E\n https:\/\/github.com\/EricZimmerman\/LECmd\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Header ---\u003Cbr\u003E\n \u0026nbsp; \u003Cu\u003ETarget created:\u003Cbr\u003E\n \u003C\/u\u003E\u0026nbsp; \u003Cu\u003ETarget modified:\u003Cbr\u003E\n \u003C\/u\u003E\u0026nbsp; \u003Cu\u003ETarget accessed:\u003C\/u\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003Cu\u003EFile size: 0\u003C\/u\u003E\u003Cbr\u003E\n \u0026nbsp; Flags: HasTargetIdList, IsUnicode, DisableKnownFolderTracking\u003Cbr\u003E\n \u0026nbsp; File attributes: 0\u003Cbr\u003E\n \u0026nbsp; Icon index: 0\u003Cbr\u003E\n \u0026nbsp; Show window: SwNormal (Activates and displays the window. The window is restored to its original size and position if the window is minimized or maximized.)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Target ID information (Format: Type ==\u0026gt; Value) ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; Absolute path: \u003Cu\u003ESearch Folder\\passw\u003C\/u\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; -Users property view ==\u0026gt; Search Folder\u003Cbr\u003E\n \u0026nbsp; \u0026gt;\u0026gt; Property store (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;d5cdd505-2e9c-101b-9397-08002b2cf9ae\\AutoList \u0026nbsp;==\u0026gt; VT_STREAM not implemented (yet) See extension block section for contents for now\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;d5cdd505-2e9c-101b-9397-08002b2cf9ae\\AutolistCacheTime \u0026nbsp;==\u0026gt; 1849138729510\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;d5cdd505-2e9c-101b-9397-08002b2cf9ae\\AutolistCacheKey \u0026nbsp;==\u0026gt; \u003Cu\u003ESearch Results in Local Disk (C:)\u003C\/u\u003E0\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; -Variable: Users property view ==\u0026gt; passw\u003Cbr\u003E\n \u0026nbsp; \u0026gt;\u0026gt; Property store (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\2 \u0026nbsp; \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; VT_STREAM not implemented\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\8 \u0026nbsp; \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; passw\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;28636aa6-953d-11d2-b5d6-00c04fd918d0\\11 \u0026nbsp; \u0026nbsp; Item Type \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; Stack\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;28636aa6-953d-11d2-b5d6-00c04fd918d0\\25 \u0026nbsp; \u0026nbsp; SFGAO Flags \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 805306372\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;b725f130-47ef-101a-a5f1-02608c9eebac\\10 \u0026nbsp; \u0026nbsp; Item Name Display \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; passw\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- End Target ID information ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Extra blocks information ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026gt;\u0026gt; Property store data block (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;(Property store is empty)\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 3: LECmd.exe output for passw.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EOf note, none of the expected information for LNK shortcut files is present. However, there were strings of interest in the Target ID Information section including \u003Cspan class=\u0022code\u0022\u003ESearch Folder\\passw\u003C\/span\u003E as well as \u003Cspan class=\u0022code\u0022\u003ESearch Results in Local Disk (C:)\u003C\/span\u003E. For comparison, Figure 4 highlights output for a standard LNK shortcut file using a test file. Notice that the target file timestamps, file size, full file path, and other expected file metadata are present (some information omitted for clarity).\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ELECmd version 1.3.2.1\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EAuthor: Eric Zimmerman (saericzimmerman@gmail.com)\u003Cbr\u003E\n https:\/\/github.com\/EricZimmerman\/LECmd\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Header ---\u003Cbr\u003E\n \u0026nbsp; \u003Cu\u003ETarget created:\u0026nbsp; 2020-01-21 19:34:28\u003Cbr\u003E\n \u003C\/u\u003E\u0026nbsp; \u003Cu\u003ETarget modified: 2020-01-21 19:34:28\u003Cbr\u003E\n \u003C\/u\u003E\u0026nbsp; \u003Cu\u003ETarget accessed: 2020-01-22 21:25:12\u003C\/u\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003Cu\u003EFile size: 4\u003C\/u\u003E\u003Cb\u003E\u003Cbr\u003E\n\u003C\/b\u003E \u0026nbsp; Flags: HasTargetIdList, HasLinkInfo, HasRelativePath, HasWorkingDir, IsUnicode, DisableKnownFolderTracking\u003Cbr\u003E\n \u0026nbsp; File attributes: FileAttributeArchive\u003Cbr\u003E\n \u0026nbsp; Icon index: 0\u003Cbr\u003E\n \u0026nbsp; Show window: SwNormal (Activates and displays the window. The window is restored to its original size and position if the window is minimized or maximized.)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ERelative Path: ..\\..\\..\\..\\..\\Desktop\\test.txt\u003Cbr\u003E\n \u003Cu\u003EWorking Directory: C:\\Users\\\u0026lt;username\u0026gt;\\Desktop\u003C\/u\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u003Cu\u003E--- Link information ---\u003C\/u\u003E\u003Cbr\u003E\n Flags: VolumeIdAndLocalBasePath\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u003Cu\u003E\u0026gt;\u0026gt;Volume information\u003C\/u\u003E\u003Cbr\u003E\n \u0026nbsp; Drive type: Fixed storage media (Hard drive)\u003Cbr\u003E\n \u0026nbsp; Serial number: \u0026lt;serial number\u0026gt;\u003Cbr\u003E\n \u0026nbsp; Label: OSDisk\u003Cbr\u003E\n \u0026nbsp; \u003Cu\u003ELocal path: C:\\Users\\\u0026lt;username\u0026gt;\\Desktop\\test.txt\u003C\/u\u003E\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Target ID information (Format: Type ==\u0026gt; Value) ---\u003Cbr\u003E\n \u0026nbsp; Absolute path: My Computer\\Desktop\\test.txt\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; -Root folder: GUID ==\u0026gt; My Computer\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; -Root folder: GUID ==\u0026gt; Desktop\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003Cu\u003E-File ==\u0026gt; test.txt\u003C\/u\u003E\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Short name: test.txt\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Modified: 2020-01-21 19:34:30\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Extension block count: 1\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; --------- Block 0 (Beef0004) ---------\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Long name: test.txt\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Created: 2020-01-21 19:34:30\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Last access: 2020-01-21 19:34:32\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; MFT entry\/sequence #: 108919\/8 (0x1A977\/0x8)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- End Target ID information ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Extra blocks information ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u003Cu\u003E\u0026gt;\u0026gt; Tracker database block\u003C\/u\u003E\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;Machine ID: \u0026lt;hostname\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;MAC Address: \u0026lt;mac address\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;MAC Vendor: INTEL\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;Creation: 2020-01-21 15:19:59\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp; Volume Droid: \u0026lt;volume\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;Volume Droid Birth: \u0026lt;volume\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;File Droid: \u0026lt;file\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;File Droid birth: \u0026lt;file\u0026gt;\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 4: LECmd.exe output for standard LNK shortcut file test.txt\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EFortunately, during the investigation we also parsed the user\u2019s \u003Cspan class=\u0022code\u0022\u003ENTUSER.DAT\u003C\/span\u003E registry file (using Harlan Carvey\u2019s \u003Ca href=\u0022https:\/\/code.google.com\/archive\/p\/regripper\/downloads\u0022\u003ERegRipper\u003C\/a\u003E) and reviewed the \u003Cspan class=\u0022code\u0022\u003EWorldWheelQuery\u003C\/span\u003E key which details user Explorer search history. The \u003Cspan class=\u0022code\u0022\u003Epassw.lnk\u003C\/span\u003E file suddenly became more interesting! Figure 5 shows the entries parsed from the registry key. Note that the search history includes the same term we observed in the LNK file: \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E.\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Ewordwheelquery v.20100330\u003Cbr\u003E\n (NTUSER.DAT) Gets contents of user\u0027s WordWheelQuery key\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ESoftware\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery\u003Cbr\u003E\n LastWrite Time Wed Nov 13 06:51:46 2019 (UTC)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;Searches listed in MRUListEx order\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E14 \u0026nbsp; Secret \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n \u003Cu\u003E6 \u0026nbsp; \u0026nbsp;passw\u003C\/u\u003E \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 13 \u0026nbsp; ccc \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 12 \u0026nbsp; bbb \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 11 \u0026nbsp; aaa \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 10 \u0026nbsp; *.cfg \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 9 \u0026nbsp; \u0026nbsp;apple \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 8 \u0026nbsp; \u0026nbsp;dni \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 7 \u0026nbsp; \u0026nbsp;private \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 4 \u0026nbsp; \u0026nbsp;gov \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 5 \u0026nbsp; \u0026nbsp;air \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 3 \u0026nbsp; \u0026nbsp;intelsat \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u003Cbr\u003E\n 2 \u0026nbsp; \u0026nbsp;adhealthcheck \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 1 \u0026nbsp; \u0026nbsp;*.ps1 \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;\u0026nbsp;\u003Cbr\u003E\n 0 \u0026nbsp; \u0026nbsp;global\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 5: WorldWheelQuery key extracted from the user\u2019s NTUSER.DAT registry file\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EVia the \u003Cspan class=\u0022code\u0022\u003EWorldWheelQuery\u003C\/span\u003E registry key, we identified \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E as the second most recent term in the user\u2019s Explorer search history according to the \u003Cspan class=\u0022code\u0022\u003EMRUListEx\u003C\/span\u003E order. \u003Cspan class=\u0022code\u0022\u003EMRUListEx\u003C\/span\u003E is a registry value that lists the order in which other values have most recently been accessed\u2014essentially, the order in which terms were searched in Explorer. \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E also matched the filename of the unusual LNK file that contained the string \u003Cspan class=\u0022code\u0022\u003ESearch Results in Local Disk (C:)\u003C\/span\u003E (see Figure 3). These details seemed to suggest that LNK files were being created as a result of user Explorer searches. Therefore, we\u2019ve started calling these \u201cuser search LNK files\u201d.\u003C\/p\u003E\n\u003Ch4\u003ENuance and Interpretation\u003C\/h4\u003E\n\u003Cp\u003EAfter searching the system for LNK files with the terms listed in the user\u2019s Explorer search history, we found that not all terms had associated user search LNK files. Figure 6 displays LNK files and their accompanying file creation and modification timestamps that we identified as a result of this search. Note that while we found 15 searches via the \u003Cspan class=\u0022code\u0022\u003EWorldWheelQuery\u003C\/span\u003E registry key, there are only four (4) user search LNK files.\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2019-11-09 08:33:14\u0026nbsp;\u0026nbsp; \u0026nbsp;Created Modified\u003Cbr\u003E\n C:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\gov.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2019-11-09 09:29:11\u0026nbsp;\u0026nbsp; \u0026nbsp;Created\u003Cbr\u003E\n 2019-11-09 09:29:37\u0026nbsp;\u0026nbsp; \u0026nbsp;Modified\u003Cbr\u003E\n C:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\private.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2019-11-09 08:38:29\u0026nbsp;\u0026nbsp; \u0026nbsp;Created\u003Cbr\u003E\n 2019-11-13 06:47:56\u0026nbsp;\u0026nbsp; \u0026nbsp;Modified\u003Cbr\u003E\n C:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\passw.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2019-11-13 06:57:03\u0026nbsp;\u0026nbsp; \u0026nbsp;Created\u003Cbr\u003E\n 2019-11-13 06:57:25\u0026nbsp;\u0026nbsp; \u0026nbsp;Modified\u003Cbr\u003E\n C:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\Secret.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 6: LNK files with associated WorldWheelQuery Explorer search terms\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EAdditionally, we noticed pairs of LNK files created at the \u003Cb\u003Esame time\u003C\/b\u003E that had similar names. As an example, Figure 7 lists two LNK files that were both created at 2019-11-09 08:38:29\u0026nbsp;UTC.\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\\u003Cu\u003Epassw\u003C\/u\u003E.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\\u003Cu\u003Epassw\u003C\/u\u003Eord.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 7: LNK files created at the same time\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EAfter further testing, we determined that the system created user search LNK files as a result of Explorer searches where the user \u003Cb\u003Eopened\u003C\/b\u003E one of the files produced as a result of this search. User search LNK files were \u003Cb\u003Enot\u003C\/b\u003E created if the user \u003Cb\u003Edid not open\u003C\/b\u003E a file returned by the search.\u003C\/p\u003E\n\u003Cp\u003EIn this example, the \u003Cspan class=\u0022code\u0022\u003Epassword.lnk\u003C\/span\u003E file contained target file metadata, as would be expected for LNK shortcut files, and referenced a target file named \u003Cspan class=\u0022code\u0022\u003Epassword.txt\u003C\/span\u003E located in the \u003Cspan class=\u0022code\u0022\u003ET:\\\u003C\/span\u003E directory. \u003Cspan class=\u0022code\u0022\u003Epassw.lnk\u003C\/span\u003E, as previously discussed, only contained expected metadata for a user search LNK file, including the absolute path \u003Cspan class=\u0022code\u0022\u003ESearch Folder\\passw\u003C\/span\u003E with reference to \u003Cspan class=\u0022code\u0022\u003ESearch Results in Local Disk (C:)\u003C\/span\u003E. However, this discrepancy in directory\u2014the user search LNK file search context of \u003Cspan class=\u0022code\u0022\u003ESearch Results in Local Disk (C:)\u003C\/span\u003E and the LNK shortcut file located in the \u003Cspan class=\u0022code\u0022\u003ET:\\\u003C\/span\u003E drive\u2014is actually as expected.\u003C\/p\u003E\n\u003Cp\u003ELNK shortcut files contain metadata for the most recently accessed file, and we found the same to be true for user search LNK files. Based on differing creation and modification timestamps for \u003Cspan class=\u0022code\u0022\u003Epassw.lnk\u003C\/span\u003E, we know the user searched for \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E in at least one other instance (we\u2019re not able to conclude whether a search happened between these two points in time) and opened a file from the search results. This is seen in the timestamps for the \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E user search LNK file in Figure 8.\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cspan class=\u0022code\u0022\u003E2019-11-09 08:38:29\u0026nbsp;\u0026nbsp; \u0026nbsp;Created\u003Cbr\u003E\n 2019-11-13 06:47:56\u0026nbsp;\u0026nbsp; \u0026nbsp;Modified\u003Cbr\u003E\n C:\\Users\\\u0026lt;user\u0026gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\passw.lnk\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 8: passw.lnk creation and modification timestamps\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe second occurrence of a search for \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E occurred on November 13, 2019. In this instance, the user again searched for the term \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E using Windows Explorer search, but this time searched within the context of the \u003Cspan class=\u0022code\u0022\u003EC:\\\u003C\/span\u003E drive (\u003Cspan class=\u0022code\u0022\u003ESearch Results in Local Disk (C:)\u003C\/span\u003E), and subsequently clicked on a document named \u003Cspan class=\u0022code\u0022\u003Epassword2.txt\u003C\/span\u003E. The results from \u003Cspan class=\u0022code\u0022\u003ELECmd\u003C\/span\u003E for \u003Cspan class=\u0022code\u0022\u003Epassword2.lnk\u003C\/span\u003E can be seen in Figure 9 (some information omitted for clarity and to protect client information). Notice the information embedded in user search LNK files is \u003Cb\u003Ealso\u003C\/b\u003E embedded within the LNK shortcut file that is created simultaneously with the user search LNK file (underlined text). The search context for \u003Cspan class=\u0022code\u0022\u003Epassw.lnk\u003C\/span\u003E and full file path location for \u003Cspan class=\u0022code\u0022\u003Epassword2.lnk\u003C\/span\u003E both match: \u003Cspan class=\u0022code\u0022\u003EC:\\\u003C\/span\u003E.\u003C\/p\u003E\n\u003Ctable cellpadding=\u00221\u0022 cellspacing=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ELECmd version 1.3.2.1\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EAuthor: Eric Zimmerman (saericzimmerman@gmail.com)\u003Cbr\u003E\n https:\/\/github.com\/EricZimmerman\/LECmd\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Header ---\u003Cbr\u003E\n \u0026nbsp; Target created: \u0026nbsp;2015-11-09 22:14:10\u003Cbr\u003E\n \u0026nbsp; Target modified: 2010-01-11 16:57:11\u003Cbr\u003E\n \u0026nbsp; Target accessed: 2015-11-09 22:14:10\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; File size: 19\u003Cbr\u003E\n \u0026nbsp; Flags: HasTargetIdList, HasLinkInfo, HasRelativePath, HasWorkingDir, IsUnicode, DisableKnownFolderTracking\u003Cbr\u003E\n \u0026nbsp; File attributes: FileAttributeArchive\u003Cbr\u003E\n \u0026nbsp; Icon index: 0\u003Cbr\u003E\n \u0026nbsp; Show window: SwNormal (Activates and displays the window. The window is restored to its original size and position if the window is minimized or maximized.)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ERelative Path: ..\\..\\..\\..\\..\\..\\..\\\u0026lt;file path\u0026gt;\\password2.txt\u003Cbr\u003E\n Working Directory: C:\\\u0026lt;file path\u0026gt;\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Link information ---\u003Cbr\u003E\n Flags: VolumeIdAndLocalBasePath, CommonNetworkRelativeLinkAndPathSuffix\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026gt;\u0026gt;Volume information\u003Cbr\u003E\n \u0026nbsp; Drive type: Fixed storage media (Hard drive)\u003Cbr\u003E\n \u0026nbsp; Serial number: \u0026lt;serial number\u0026gt;\u003Cbr\u003E\n \u0026nbsp; Label: (No label)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; Network share information\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Share name: \\\\\u0026lt;hostname\u0026gt;\\\u0026lt;top level folder\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Provider type: \u0026lt;provider type\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; Share flags: ValidNetType\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; Local path: C:\\\u0026lt;top level folder\u0026gt;\\\u003Cbr\u003E\n \u0026nbsp; Common path: \u0026lt;file path\u0026gt;\\password2.txt\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Target ID information (Format: Type ==\u0026gt; Value) ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003EAbsolute path: Search Folder\\passw\\password2\u003C\/span\u003E\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E-Users property view ==\u0026gt; Search Folder\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026gt;\u0026gt; Property store (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003Ed5cdd505-2e9c-101b-9397-08002b2cf9ae\\AutoList \u0026nbsp;==\u0026gt; VT_STREAM not implemented (yet) See extension block section for contents for now\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003Ed5cdd505-2e9c-101b-9397-08002b2cf9ae\\AutolistCacheTime \u0026nbsp;==\u0026gt; 1849138729510\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003Ed5cdd505-2e9c-101b-9397-08002b2cf9ae\\AutolistCacheKey \u0026nbsp;==\u0026gt; Search Results in Local Disk (C:)0\u003C\/span\u003E\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E-Variable: Users property view ==\u0026gt; passw\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026gt;\u0026gt; Property store (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E1e3ee840-bc2b-476c-8237-2acd1a839b22\\2 \u0026nbsp; \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; VT_STREAM not implemented\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E1e3ee840-bc2b-476c-8237-2acd1a839b22\\8 \u0026nbsp; \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; passw\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E28636aa6-953d-11d2-b5d6-00c04fd918d0\\11 \u0026nbsp; \u0026nbsp; Item Type \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; Stack\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003E28636aa6-953d-11d2-b5d6-00c04fd918d0\\25 \u0026nbsp; \u0026nbsp; SFGAO Flags \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 805306372\u003Cbr\u003E\n \u003C\/span\u003E\u003C\/u\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp;\u003C\/span\u003E\u003Cu\u003E\u003Cspan class=\u0022code\u0022\u003Eb725f130-47ef-101a-a5f1-02608c9eebac\\10 \u0026nbsp; \u0026nbsp; Item Name Display \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; passw\u003C\/span\u003E\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; -Variable: Users property view ==\u0026gt; password2\u003Cbr\u003E\n \u0026nbsp; \u0026gt;\u0026gt; Property store (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;49691c90-7e17-101a-a91c-08002b2ecda9\\3 \u0026nbsp; \u0026nbsp; \u0026nbsp;Search Rank \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 0\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;28636aa6-953d-11d2-b5d6-00c04fd918d0\\25 \u0026nbsp; \u0026nbsp; SFGAO Flags \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 1077936503\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;28636aa6-953d-11d2-b5d6-00c04fd918d0\\32 \u0026nbsp; \u0026nbsp; Delegate ID List \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;==\u0026gt; VT_VECTOR data not implemented (yet) See extension block section for contents for now\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;28636aa6-953d-11d2-b5d6-00c04fd918d0\\11 \u0026nbsp; \u0026nbsp; Item Type \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; .txt\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;28636aa6-953d-11d2-b5d6-00c04fd918d0\\24 \u0026nbsp; \u0026nbsp; Parsing Name \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;==\u0026gt; password2.txt\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;446d16b1-8dad-4870-a748-402ea43d788c\\100 \u0026nbsp; \u0026nbsp;Thumbnail Cache Id \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;==\u0026gt; 7524032674880659487\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\12 \u0026nbsp; \u0026nbsp; (Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; Null\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\20 \u0026nbsp; \u0026nbsp; (Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 1\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\3 \u0026nbsp; \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; document\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\17 \u0026nbsp; \u0026nbsp; (Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; {1685D4AB-A51B-4AF1-A4E5-CEE87002431D}.Merge Any\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;1e3ee840-bc2b-476c-8237-2acd1a839b22\\8 \u0026nbsp; \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; C:\\\u0026lt;file path\u0026gt;\\password2.txt\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;b725f130-47ef-101a-a5f1-02608c9eebac\\4 \u0026nbsp; \u0026nbsp; \u0026nbsp;Item Type Text \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;==\u0026gt; Text Document\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;b725f130-47ef-101a-a5f1-02608c9eebac\\10 \u0026nbsp; \u0026nbsp; Item Name Display \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; password2\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;b725f130-47ef-101a-a5f1-02608c9eebac\\12 \u0026nbsp; \u0026nbsp; Size \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;==\u0026gt; 19\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;b725f130-47ef-101a-a5f1-02608c9eebac\\14 \u0026nbsp; \u0026nbsp; Date Modified \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 01\/11\/2010 16:57:11\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;006fdbaa-864f-4d1c-a8e8-e62772e454fe\\11 \u0026nbsp; \u0026nbsp; (Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 59\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;006fdbaa-864f-4d1c-a8e8-e62772e454fe\\13 \u0026nbsp; \u0026nbsp; (Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; 1077936423\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;cf5be8c0-236c-4ad3-bace-cd608a2748d7\\100 \u0026nbsp; \u0026nbsp;(Description not available) \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; ==\u0026gt; True\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp;e3e0584c-b788-4a5a-bb20-7f5a44c9acdd\\6 \u0026nbsp; \u0026nbsp; \u0026nbsp;Item Folder Path Display \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;==\u0026gt; C:\\\u0026lt;file path\u0026gt;\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- End Target ID information ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E--- Extra blocks information ---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026gt;\u0026gt; Property store data block (Format: GUID\\ID Description ==\u0026gt; Value)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;(Property store is empty)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026gt;\u0026gt; Tracker database block\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;Machine ID: \u0026lt;hostname\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;MAC Address: \u0026lt;mac address\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;MAC Vendor: VMWARE\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;Creation: 2019-11-13 04:29:24\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp; \u0026nbsp;Volume Droid: \u0026lt;volume\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;Volume Droid Birth: \u0026lt;volume\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;File Droid: \u0026lt;file\u0026gt;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp;File Droid birth: \u0026lt;file\u0026gt;\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 9: LECmd.exe output for password2.lnk\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe takeaway here is that user search LNK files are only related to the search term and not search context. This means later searches for the same search term, e.g. \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E, when the user subsequently opens a search result, but in a different drive or directory changes the modification timestamp for the user search LNK file as well as the search context contained in the user search LNK file. This keeps in step with LNK shortcut files, which are dependent on a simple filename\u2014not the full file path.\u003C\/p\u003E\n\u003Ch4\u003ETimestamp Interpretation\u003C\/h4\u003E\n\u003Cp\u003EHistorically, due to the structure of the \u003Cspan class=\u0022code\u0022\u003EWorldWheelQuery\u003C\/span\u003E registry key and available timestamps in the Windows Registry, investigators could only determine the search time of the most recent term using the last modification time of the registry key. \u003Cb\u003EWith user search LNK files, new timestamps are available to determine the times a user searched for a specific term\u003C\/b\u003E when the user subsequently opened a file from the search. Going further, we can combine evidence from the user search LNK files and the \u003Cspan class=\u0022code\u0022\u003EWorldWheelQuery\u003C\/span\u003E \u003Cspan class=\u0022code\u0022\u003EMRUlistEx\u003C\/span\u003E registry key value to\u003Cb\u003E infer the order of searches completed by the user\u003C\/b\u003E. For instance, since the user searched for gov (\u003Cspan class=\u0022code\u0022\u003EWorldWheelQuery\u003C\/span\u003E search index 4), \u003Cspan class=\u0022code\u0022\u003Epassw\u003C\/span\u003E (index 6), and \u003Cspan class=\u0022code\u0022\u003Eprivate\u003C\/span\u003E (index 7), we can infer they also searched for \u003Cspan class=\u0022code\u0022\u003Eair\u003C\/span\u003E (index 5) but didn\u0027t open any files resulting from this search.\u003C\/p\u003E\n\u003Ch4\u003EConclusion\u003C\/h4\u003E\n\u003Cp\u003ELNK shortcut files have been a reliable method to determine user access to files and the associated file metadata at the time of access. With user search LNK files, we can now enrich our Windows Explorer search history findings and gain a more detailed picture of user activity through additional timestamps of user Explorer searches with subsequent access to files from the search.\u003C\/p\u003E\n\u003Ch4\u003EAcknowledgements\u003C\/h4\u003E\n\u003Cp\u003EThank you to Phillip Kealy and William Ballenthin for technical review and providing feedback on overall presentation.\u003C\/p\u003E\n",
        "jcr:lastModified": "Wed Feb 19 2020 19:54:45 GMT+0000",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "summary": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "text": "\u003Cp\u003EFireEye Mandiant recently encountered LNK files that indicated an attacker accessed files included in Windows Explorer search results.\u003C\/p\u003E\n",
      "jcr:lastModified": "Wed Feb 19 2020 07:22:48 GMT+0000",
      "sling:resourceType": "social\/blog\/components\/entrytextteaser"
    },
    "image": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "jcr:lastModified": "Wed Feb 19 2020 18:34:22 GMT+0000",
      "imageRotate": "0"
    }
  }
}
