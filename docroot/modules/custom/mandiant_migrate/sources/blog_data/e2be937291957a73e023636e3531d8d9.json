{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "admin",
  "jcr:created": "Thu Mar 04 2021 17:00:02 GMT+0000",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "admin",
    "jcr:title": "New SUNSHUTTLE Second-Stage Backdoor Uncovered Targeting U.S.-Based Entity; Possible Connection to UNC2452",
    "jcr:versionHistory": "6cb98395-c7be-4d06-a035-7b4618642b96",
    "author": "Lindsay Smith",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "jcr:language": "en_us",
    "jcr:predecessors": [
      "0f8123e8-13ac-43bb-aa55-cbd3e8e37d84"
    ],
    "jcr:created": "Fri Mar 05 2021 01:54:58 GMT+0000",
    "cq:lastModified": "Fri Mar 05 2021 01:54:41 GMT+0000",
    "jcr:baseVersion": "0f8123e8-13ac-43bb-aa55-cbd3e8e37d84",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-authors:lindsay-smith",
      "fireeye-blog-authors:jonathan-leathery",
      "fireeye-blog-authors:ben-read",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-tags:backdoor",
      "fireeye-blog-tags:intelligence",
      "fireeye-blog-tags:latest",
      "fireeye-blog-tags:homepage-carousel",
      "fireeye-blog-tags:malware",
      "fireeye-blog-tags:unc"
    ],
    "jcr:uuid": "f082939d-a162-43b6-b6b2-e37931cb9b63",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Thu Mar 04 2021 12:00:00 GMT-0500",
    "cq:lastModifiedBy": "adam.greenberg@fireeye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
        "text": "\u003Ch4\u003EExecutive Summary\u003C\/h4\u003E\n\u003Cul\u003E\n\u003Cli\u003EIn August 2020, a U.S.-based entity uploaded a new backdoor that we have named SUNSHUTTLE to a public malware repository.\u003C\/li\u003E\n\u003Cli\u003ESUNSHUTTLE is a second-stage backdoor written in GoLang that features some detection evasion capabilities.\u003C\/li\u003E\n\u003Cli\u003EMandiant observed SUNSHUTTLE at a victim compromised by UNC2452, and have indications that it is linked to UNC2452, but we have not fully verified this connection.\u003C\/li\u003E\n\u003Cli\u003EPlease see the Technical Annex for relevant MITRE ATT\u0026amp;CK techniques (T1027, T1027.002, T1059.003, T1071.001, T1105, T1140, T1573.001).\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Ci\u003EThe activity discussed in this blog post is also detailed in a \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/www.microsoft.com\/security\/blog\/2021\/03\/04\/goldmax-goldfinder-sibot-analyzing-nobelium-malware\/\u0022\u003EMicrosoft blog post\u003C\/a\u003E. We thank the team at Microsoft and other partners for their great collaboration in tracking this actor.\u003C\/i\u003E\u003C\/p\u003E\n\u003Ch4\u003EThreat Detail\u003C\/h4\u003E\n\u003Cp\u003EMandiant Threat Intelligence discovered a new backdoor uploaded by a U.S.-based entity to a public malware repository in August 2020 that we have named SUNSHUTTLE. SUNSHUTTLE is written in GO, and reads an embedded or local configuration file, communicates with a hard-coded command and control (C2) server over HTTPS, and supports commands including remotely uploading its configuration, file upload and download, and arbitrary command execution. Notably, SUNSHUTTLE uses cookie headers to pass values to the C2, and if configured, can select referrers from a list of popular website URLs to help such network traffic \u201cblend in.\u201d\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EThe SUNSHUTTLE backdoor file examined, \u201cLexicon.exe\u201d (MD5: 9466c865f7498a35e4e1a8f48ef1dffd), was written in GoLang. The file unpacks into MD5: 86e89349fefcbdd9d2c80ca30fa85511.\u003C\/li\u003E\n\u003Cli\u003EThe infection vector for SUNSHUTTLE is not known. It is most likely a second-stage backdoor dropped after an initial compromise.\u003C\/li\u003E\n\u003Cli\u003EThe SUNSHUTTLE sample uses the actor-controlled server \u201creyweb[.]com\u201d for C2. \u201cReyweb[.]com\u201d is registered anonymously via NameSilo, a domain provider who accepts bitcoin payment and has been used for C2 registration by state-sponsored APTs in the past, including Russia-nexus actors and Iran-nexus APTs\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EMandiant observed SUNSHUTTLE at a victim compromised by UNC2452, and have indications that it is linked to UNC2452, but we have not fully verified this connection.\u003C\/p\u003E\n\u003Cp\u003EPlease see FireEye\u2019s resource center for \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/www.fireeye.com\/current-threats\/sunburst-malware.html\u0022\u003Ebackground on UNC2452 and the SUNBURST campaign\u003C\/a\u003E.\u003C\/p\u003E\n\u003Ch4\u003EOutlook and Implications\u003C\/h4\u003E\n\u003Cp\u003EThe new SUNSHUTTLE backdoor is a sophisticated second-stage backdoor that demonstrates straightforward but elegant detection evasion techniques via its \u201cblend-in\u201d traffic capabilities for C2 communications. SUNSHUTTLE would function as second-stage backdoor in such a compromise for conducting network reconnaissance alongside other SUNBURST-related tools.\u003C\/p\u003E\n\u003Ch4\u003ETechnical Annex\u003C\/h4\u003E\n\u003Cp\u003EMandiant Threat Intelligence discovered a sample of the SUNSHUTTLE backdoor uploaded to an online multi-Antivirus scan service. SUNSHUTTLE is a backdoor, written in GO, that reads an embedded or local configuration file, communicates with its C2 server over HTTPS and supports commands including remotely updating its configuration, file upload and download, and arbitrary command execution.\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003ELexicon.exe (MD5: 9466c865f7498a35e4e1a8f48ef1dffd)\u003Cul\u003E\n\u003Cli\u003EC2: reyweb[.]com\u003C\/li\u003E\n\u003Cli\u003EUNAVAILABLE (MD5: 86e89349fefcbdd9d2c80ca30fa85511)\u003Cul\u003E\n\u003Cli\u003EUnpacked version of 9466c865f7498a35e4e1a8f48ef1dffd\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003EInfection Vector\u003C\/h4\u003E\n\u003Cp\u003EFor the samples analyzed, the infection vector is not known.\u003C\/p\u003E\n\u003Ch4\u003EExecution\u003C\/h4\u003E\n\u003Cp\u003E\u003Ci\u003EExecution Summary\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003ESUNSHUTTLE is a backdoor written in GoLang. Once SUNSHUTTLE is executed, a high-level description of the execution is the following:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EConfiguration settings determined\u003C\/li\u003E\n\u003Cli\u003ERequest a \u201csession key\u201d from the C2\u003C\/li\u003E\n\u003Cli\u003ERetrieve the \u201csession key\u201d from the C2\u003Cul\u003E\n\u003Cli\u003EOnce a session key is retrieved, SUNSHUTTLE begins command request beaconing loop\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003EBegin command request beaconing\u003C\/li\u003E\n\u003Cli\u003EResolve command and perform action\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe SUNSHUTTLE sample analyzed retains the names of the routines used by the malware, which include the following:\u003C\/p\u003E\n\u003Ctable border=\u00220\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 width=\u0022100%\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.request_session_key\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.define_internal_settings\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.send_file_part\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.clean_file\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.send_command_result\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.retrieve_session_key\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.save_internal_settings\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.resolve_command\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.write_file\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.beaconing\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.wget_file\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.fileExists\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.encrypt\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.decrypt\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.random\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.removeBase64Padding\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.addBase64Padding\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.delete_empty\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.Unpad\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.GetMD5Hash\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Emain.Pad\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cb\u003ENote: \u003C\/b\u003EThroughout the SUNSHUTTLE backdoor, unique string identifiers are used to indicate the operation being performed to the C2 via a Cookie header, and unique string identifiers are also used to validate and parse response content from the C2. These unique string values are thought to be unique and random per compiled sample.\u003C\/p\u003E\n\u003Cp\u003E\u003Ci\u003EInitial Execution\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EOnce executed, the SUNSHUTTLE backdoor enumerates the victim\u2019s MAC address and compares it to a hardcoded MAC address value \u201cc8:27:cc:c2:37:5a\u201d. If a match is found the backdoor exits. The MAC address is likely a default MAC address for the Windows sandbox network adapter.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/sunshuttle\/fig1.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003EFigure 1: Mac address check\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Ci\u003EConfiguration\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EIf the check is successful, the SUNSHUTTLE backdoor then enters a routine named \u201c\ufeffmain_define_internal_settings\u201d, which handles creation of the configuration file if one doesn\u2019t already exist in the directory from which SUNSHUTTLE is running. For the sample analyzed, the configuration filename is \u201cconfig.dat.tmp\u201d. The configuration data is Base64 encoded and AES-256 encrypted using the following key:\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Ehz8l2fnpvp71ujfy8rht6b0smouvp9k8\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe configuration has the following example values when Base64 decoded and AES decrypted:\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E48b9e25491e088a35105274cae0b9e67|5-15|0|0|TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6NzUuMCkgR2V\u003Cbr\u003E\n ja28vMjAxMDAxMDEgRmlyZWZveC83NS4w\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe configuration holds several values delimited by a \u201c|\u201d character, which are briefly described as follows.\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E48b9e25491e088a35105274cae0b9e67\u003Cul\u003E\n\u003Cli\u003EMD5 hash of the current timestamp calculated during execution.\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003E5-15\u003Cul\u003E\n\u003Cli\u003ELower\/upper limits used to randomly generate sleep times as SUNSHUTTLE executes\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003E0\u003Cul\u003E\n\u003Cli\u003E0 or 1 \u2014 Utilize \u201cblend-in\u201d traffic requests. Internally called \u201cfalse_requesting\u201d\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003E0\u003Cul\u003E\n\u003Cli\u003EActivate execution timestamp (0 by default) \u2014 execution \u0026quot;activates\u0026quot; or continues if current time is greater than the value in the configuration\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003ETW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NDsgcnY6NzUuMCkgR2Vja2\u003Cbr\u003E\n8vMjAxMDAxMDEgRmlyZWZveC83NS4w\u003Cul\u003E\n\u003Cli\u003EBase64-encoded User-agent used in HTTPS requests\u003C\/li\u003E\n\u003Cli\u003EDecoded: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EIf set in the configuration, the \u201cblend-in\u201d traffic occurs as the malware executes and transitions through its routines. The following URLs are leveraged for the \u201cblend-in\u201d requests:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/icon.ico\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/icon.png\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/script.js\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/style.css\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/css\/style.css\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/css\/bootstrap.css\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/scripts\/jquery.js\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/reyweb[.]com\/scripts\/bootstrap.js\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn.mxpnl[.]com\/\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn.google[.]com\/\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn.jquery[.]com\/\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/code.jquery[.]com\/\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/cdn.cloudflare[.]com\/\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Ci\u003ESession Key Mechanism\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003ESUNSHUTTLE performs initial requests to the C2 in order to request and then retrieve what it internally refers to as a session key. The retrieved session key from the C2 appears to be RSA decrypted using the following private key that is embedded in SUNSHUTTLE and believed to be unique per compiled sample. Analysis is on-going on how the decrypted session key is used, but it is likely a session key used to encrypt content once SUNSHUTTLE transitions to its command-and-control routines.\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; -----BEGIN PRIVATE KEY-----\u003Cbr\u003E\n MIIEowIBAAKCAQEA0Aj\/3K3m\/rKNESwUfHC9qAhnsNYA9bJ4HQ30DPsfPDvbbHZm\u003Cbr\u003E\n Uj5nyp2abjYZYMQbWa2+ZO4Ixgfdm0FzsAH\/haKIN4sSkbw+YRESYW35MnMI3Adf\u003Cbr\u003E\n mj\/eK\/yKNblyoe\/7iWP3nz+y4Q\/QI0L6BrF7VodTaDYtDup3iI+B5zjmhElf9Fmg\u003Cbr\u003E\n S1JiDUgydz5VXJR\/esv6hB7GMfEb\/3sIAzv5qcwEvGK5HH1EzQ7zjauyhbsF9pHR\u003Cbr\u003E\n zCFYlvW4OtaU0o3xjVufo5UwYRS5p\/EFpof45zuJGLJ02cKUmxc0OX53t3Bn9WXY\u003Cbr\u003E\n aDDhYp\/RPzywG8N9gTBv8rKxRIsFxxKu+8wK+QIDAQABAoIBAGe4hPDe13OXTBQK\u003Cbr\u003E\n uTAN+dEkV6ZoHFRjpdU+lrY+IiWi5lSed4d7y73OdCeM23xOaiB9KpchwsgRNeDp\u003Cbr\u003E\n cieH54EWNvoSYbC9fRBiNZrT\/NG1Xu5s0rKSM1AU+kes7UVl5DBs4hHI7YOeobRi\u003Cbr\u003E\n +UuLA6ZxlBk6IZ71MaGpgyfoS64aDMvZDtcaTEGzw6dRQAU9255DTIc2YYbq8MqL\u003Cbr\u003E\n zSafD5eBDH3Izmblg0kXiidec1A1sytz5u8xW4XckHfp4xePLVw\/RvLJGqNJMK5M\u003Cbr\u003E\n 7tXAFwPzg+u4k7ce7uNw9VWW7n28T9xznUux1gtPQj1N6goDaBaOqY+h0ia9F1RP\u003Cbr\u003E\n wu6ZtG0CgYEA8vCFmAGmMz4vjO04ELyPnvnaS6CReYCVzmvNugIDlxBLDGCnKBVx\u003Cbr\u003E\n et7qEk3gMkbtcDUOZpXQAIVCWQNupAhI0t5bb\/Pfw3HtH3Xt5NRUYmwxTgNRe06D\u003Cbr\u003E\n i4ICsg2+8TDinjne9hzsEe9DYE2WRrtLMJ+IPD+QE94J3Sei03k1wpMCgYEA2zga\u003Cbr\u003E\n Tff6jQeNn9G0ipHa1DvJmi98px51o0r7TUfZRxJfgg4ckyMsZUHKALrZszKAnxP7\u003Cbr\u003E\n MXYrJuOHpsp0EZc1e3uTjFzrKyKRTQ78c7MNGv07w1PlZuNLtkoqepUjkQzdxKZO\u003Cbr\u003E\n g9gG0O4lC5jjnSg8jUSChhZn+jrU8Vx7ByOP98MCgYAWi5+6RZzo8IJ1L6aeVwF1\u003Cbr\u003E\n HXbWweX+QqKkb3i+JGW05Twxv96DZ8oKPxm17Sg7Qj3Sxfm6J3kQM02++QSRkHtB\u003Cbr\u003E\n poUR1K4Vc0MwQj97lwDlyWih9sjfCqBGmCAr6f6oX4MIcBJzAKgf2faEv26MzeDi\u003Cbr\u003E\n eEuqW7PBRD\/iGEWSHpOQpQKBgQDRgV+aTjk0mRhfugHKQLSbCnyUj3eZG8IfiiR7\u003Cbr\u003E\n agQcKVH\/sE7cy8u9Bc\/xPKGb4dMMtQLm9WEuLFtTKr8cpJ8nYSXVCmRx9\/pXY9Af\u003Cbr\u003E\n HuqSdZutBDwERYvxLhZEys2P7XTwYGQ\/GrEA8eeTms1FP9QGyofXcAh1G86w0Mp\/\u003Cbr\u003E\n Oxx3EwKBgHXxgQa4\/ngTlMNhWP+IvHOlOVAxDK2GL3XQdr8fudZe9c1d7VzIbYj6\u003Cbr\u003E\n gbwLT9qi0wG5FAWqH163XucAirT6WCtAJ3tK0lfbS7oWJ7L\/Vh1+vOe6jfS\/nQna\u003Cbr\u003E\n Ao2QPbN8RiltHeaAq0ZfrgwrQuP5fmigmBa5lOWID\/eU2OLlvJGi\u003Cbr\u003E\n -----END PRIVATE KEY---\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EAfter the configuration is created or read from, SUNSHUTTLE enters a routine named \u201c\ufeffmain_request_session_key\u201d. The malware will iterate over this routine until it\u2019s successful, sleeping a period of time after each iteration.\u003C\/p\u003E\n\u003Cp\u003EInside the \u201c\ufeffmain_request_session_key\u201d routine, SUNSHUTTLE constructs an HTTPS request to its configured C2. Upon an HTTP 200 response from the request, the response data from the C2 is expected to not contain the following string for the sample analyzed:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EywQdjLuHHC\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe request_session_key routine returns a 1 if the string is not in the response and a -1 if it is in the response. If the result of the request_session_key is 1, SUNSHUTTLE will execute the retrieve_session_key routine.\u003C\/p\u003E\n\u003Cp\u003EThe retrieve_session_key routine again contacts the C2 and downloads content that is expected to be decrypted by the aforementioned embedded private key. The decrypted content is likely a session key used to encrypt content once SUNSHUTTLE transitions to its command-and-control routines.\u003C\/p\u003E\n\u003Cp\u003E\u003Ci\u003ECommanding\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EOnce a session key is retrieved from the C2, SUNSHUTTLE begins the beaconing and \u201cresolve_command\u201d routines in a loop. SUNSHUTTLE first issues a beacon to retrieve a command. After, SUNSHUTTLE will enter the routine \u201cresolve_command\u201d, which parses the response content to determine which command should be run. Available commands include remotely updating its configuration, file upload and download, and arbitrary command execution.\u0026nbsp;\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/sunshuttle\/fig2.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003EFigure 2: Resolve command graph\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe content returned from the C2 after the \u201cmain_beaconing\u201d routine is Base64 decoded and AES decrypted. A check is performed to ensure the decrypted content doesn\u2019t contain the following string:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003ECp5RTQ31R1\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EAs noted, it is likely these strings are unique per sample and randomly generated at compilation.\u003C\/p\u003E\n\u003Cp\u003EThe decrypted content is parsed for certain unique strings.\ufeff\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EUnique string in decrypted response\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EMeaning\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EzSsP2TSJJm3a\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUpdate sleep range \u2014 save config\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E\ufeffaQJmWJzXdYK721mGBI3U\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUpdate \u201cfalse requesting\u201d value \u2013 save config\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E\ufeffW5VYP9Iu2uyHK\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUpdate C2 URL and User-agent \u2013 save config\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E\ufeff3487wD9t2OZkvqdwRpqPeE\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESend current timestamp to C2\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E\ufeffubFxROBRwfswVRWNjLC\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUpdate \u0026quot;activation\u0026quot; timestamp in the config \u2014 save config\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E\ufeffTMuhGdA9EHY\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUpload file to C2 if the file exists\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E1kG4NaRX83BCMgLo38Bjq\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EExecute command \u2013 return \u201cEXECED\u201d if successful\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EhB0upT6CUmdRaR2KVBvxrJ\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EExecute command \u2013 return results\/output\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EN\/A (other string criteria met)\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProvides terminal command execution\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EN\/A (other string criteria met)\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EDownload file from C2\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Ch4\u003EFiles Dropped\u003C\/h4\u003E\n\u003Cp\u003EAfter successful execution of the malware, it drops the following files to the victim\u2019s system:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026lt;current_directory\u0026gt;\\config.dat.tmp (MD5: Dynamic)\u003Cul\u003E\n\u003Cli\u003EEncrypted configuration file\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003EPersistence Method\u003C\/h4\u003E\n\u003Cp\u003EThe SUNSHUTTLE malware was not observed setting its own persistence. It is likely the persistence is set outside of the execution of SUNSHUTTLE.\u003C\/p\u003E\n\u003Ch4\u003ENetwork Communications\u003C\/h4\u003E\n\u003Cp\u003ESUNSHUTTLE uses the cookie header to pass values to the C2. Additionally, a referrer is selected from the following list, presumably to make the traffic blend in if traffic is being decrypted for inspection:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ewww.bing.com\u003C\/li\u003E\n\u003Cli\u003Ewww.yahoo.com\u003C\/li\u003E\n\u003Cli\u003Ewww.google.com\u003C\/li\u003E\n\u003Cli\u003Ewww.facebook.com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe cookie headers vary slightly depending on the operation being performed. The following is an example request to the C2 from the \u201crequest_session_key\u201d routine.\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to C2\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/assets\/index.php HTTP\/1.1\u003Cbr\u003E\nHost: reyweb[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nCookie: HjELmFxKJc=48b9e25491e088a35105274cae0b9e67; P5hCrabkKf=gZLXIeKI; iN678zYrXMJZ=i4zICToyI70Yeidf1f7rWjm5foKX2Usx; b7XCoFSvs1YRW=78\u003Cbr\u003E\nReferer: www.facebook.com\u003Cbr\u003E\nAccept-Encoding: gzip\u003C\/p\u003E\n\u003Cp\u003EWithin the Cookie header, these values represent the following:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cb\u003EHjELmFxKJc=48b9e25491e088a35105274cae0b9e67\u003C\/b\u003E\u003Cul\u003E\n\u003Cli\u003ETimestamp MD5 contained within the configuration\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003E\u003Cb\u003EP5hCrabkKf=gZLXIeKI\u003C\/b\u003E\u003Cul\u003E\n\u003Cli\u003E\u201cP5hCrabkKf=\u201d contains a unique string based on which routine is performing the request (see the following table).\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003E\u003Cb\u003EiN678zYrXMJZ=i4zICToyI70Yeidf1f7rWjm5foKX2Usx\u003C\/b\u003E\u003Cul\u003E\n\u003Cli\u003E\u201ci4zICToyI70Yeidf1f7rWjm5foKX2Usx\u201d is hard coded within the SUNSHUTTLE backdoor. It possibly represents a payload identifier\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003E\u003Cb\u003Eb7XCoFSvs1YRW=78\u003C\/b\u003E\u003Cul\u003E\n\u003Cli\u003EUnknown purpose. This value is only included in request_session_key and retrieve_session_key requests.\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EAs mentioned, the cookie value \u201cP5hCrabkKf=\u201d contained in each request signifies the operation that is being performed.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003E\u201cP5hCrabkKf=\u201d Cookie Value\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EMeaning\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EgZLXIeK\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003Emain_request_session_key\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003Edo1KiqzhQ\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003Emain_clean_file\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003Et5UITQ2PdFg5\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003Emain_wget_file\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EcIHiqD5p4da6OeB\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003Emain_retrieve_session_key\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ExpjQVt3bJzWuv\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003Emain_send_file_part\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ES4rgG1WifHU\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003Emain_send_command_result\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003EAfter successful installation \/ initialization of the malware, it proceeds to make the following callback to the C2 server reyweb[.]com via TCP\/443 HTTPS:\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to C2\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/assets\/index.php HTTP\/1.1\u003Cbr\u003E\nHost: reyweb[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nCookie: HjELmFxKJc=48b9e25491e088a35105274cae0b9e67; P5hCrabkKf=gZLXIeKI; iN678zYrXMJZ=i4zICToyI70Yeidf1f7rWjm5foKX2Usx; b7XCoFSvs1YRW=78\u003Cbr\u003E\nReferer: www.facebook.com\u003Cbr\u003E\nAccept-Encoding: gzip\u0026nbsp;\u0026nbsp;\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to C2\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/assets\/index.php HTTP\/1.1\u003Cbr\u003E\nHost: reyweb[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nCookie: HjELmFxKJc=48b9e25491e088a35105274cae0b9e67; P5hCrabkKf=gZLXIeKI; iN678zYrXMJZ=i4zICToyI70Yeidf1f7rWjm5foKX2Usx; b7XCoFSvs1YRW=78\u003Cbr\u003E\nReferer: www.yahoo.com\u003Cbr\u003E\nAccept-Encoding: gzip\u003C\/p\u003E\n\u003Cp\u003EAdditionally, if the \u201cfake_requesting\u201d configuration value is set to 1, SUNSHUTTLE will generate traffic meant to blend in with real traffic. Examples of those requests are as follows:\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to C2\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/icon.png HTTP\/1.1\u003Cbr\u003E\nHost: reyweb[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nReferer: www.google.com\u003Cbr\u003E\nAccept-Encoding: gzip\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to C2\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/css\/style.css HTTP\/1.1\u003Cbr\u003E\nHost: reyweb[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nReferer: www.facebook.com\u003Cbr\u003E\nAccept-Encoding: gzip\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to C2\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/css\/bootstrap.css HTTP\/1.1\u003Cbr\u003E\nHost: reyweb[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nReferer: www.facebook.com\u003Cbr\u003E\nAccept-Encoding: gzip\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u003Cb\u003E\u003Cu\u003EVictim to Legitimate\u003Cbr\u003E\n \u003C\/u\u003E\u003C\/b\u003EGET \/ HTTP\/1.1\u003Cbr\u003E\nHost: cdn.cloudflare[.]com\u003Cbr\u003E\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko\/20100101 Firefox\/75.0\u003Cbr\u003E\nReferer: www.google.com\u003Cbr\u003E\nAccept-Encoding: gzip\u003C\/p\u003E\n\u003Ch4\u003EAppendix: MITRE ATT\u0026amp;CK Framework\u003C\/h4\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ETechnique\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EDescription\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1027\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003EObfuscated Files or Information\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1027.002\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003ESoftware Packing\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1059.003\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003EWindows Command Shell\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1071.001\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003EWeb Protocols\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1105\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003EIngress Tool Transfer\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1140\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003EDeobfuscate\/Decode Files or Information\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ET1573.001\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd valign=\u0022top\u0022\u003E\u003Cp\u003ESymmetric Cryptography\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Ch4\u003EAppendix: Detecting the Techniques\u003C\/h4\u003E\n\u003Cp\u003EFireEye security solutions provide detection of the SUNSHUTTLE activity across email, endpoint and network levels. The following is a snapshot of existing detections related to activity outlined in this blog post.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 width=\u0022624\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022210\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EPlatform(s)\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022414\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EDetection Name\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022210\u0022 valign=\u0022top\u0022\u003E\u003Cul\u003E\n\u003Cli\u003ENetwork Security\u003C\/li\u003E\n\u003Cli\u003EEmail Security\u003C\/li\u003E\n\u003Cli\u003EDetection On Demand\u003C\/li\u003E\n\u003Cli\u003EMalware File Scanning\u003C\/li\u003E\n\u003Cli\u003EMalware File Storage Scanning\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022414\u0022 valign=\u0022top\u0022\u003E\u003Cul\u003E\n\u003Cli\u003EFE_APT_Backdoor_Win64_SUNSHUTTLE_1\u003C\/li\u003E\n\u003Cli\u003EFE_APT_Backdoor_Win_SUNSHUTTLE_1\u003C\/li\u003E\n\u003Cli\u003EAPT.Backdoor.Win.SUNSHUTTLE\u003C\/li\u003E\n\u003Cli\u003EAPT.Backdoor.Win.SUNSHUTTLE.MVX\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022210\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEndpoint Security\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022414\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EMalware Protection (AV\/MG)\u003C\/b\u003E\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003ETrojan.GenericKD.34453763\u003C\/li\u003E\n\u003Cli\u003EGeneric.mg.9466c865f7498a35\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n",
        "jcr:lastModified": "Fri Mar 05 2021 01:54:41 GMT+0000",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "summary": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "text": "\u003Cp\u003EWe have discovered a new backdoor uploaded by a U.S.-based entity to a public malware repository in August 2020 that we have named SUNSHUTTLE.\u003C\/p\u003E\n",
      "jcr:lastModified": "Thu Mar 04 2021 15:19:45 GMT+0000",
      "sling:resourceType": "social\/blog\/components\/entrytextteaser"
    },
    "image": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "jcr:lastModified": "Thu Mar 04 2021 15:22:21 GMT+0000",
      "imageRotate": "0"
    }
  }
}
