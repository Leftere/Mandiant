{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "admin",
  "jcr:created": "Tue May 23 2017 13:29:40 GMT-0400",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "admin",
    "jcr:title": "WannaCry Malware Profile",
    "cq:lastReplicationAction": "Activate",
    "jcr:versionHistory": "83004cbe-3049-4fcd-88ad-cc0428340d87",
    "author": "Alex Berry",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "cq:lastReplicatedBy": "adam.greenberg@fireeye.com",
    "jcr:predecessors": [
      "b390d7da-6bf4-423d-9b29-1be486e27074"
    ],
    "jcr:created": "Fri Sep 07 2018 16:49:06 GMT-0400",
    "cq:lastReplicated": "Fri Sep 07 2018 16:49:04 GMT-0400",
    "cq:lastModified": "Fri Sep 07 2018 16:49:00 GMT-0400",
    "cq:distribute": true,
    "jcr:baseVersion": "b390d7da-6bf4-423d-9b29-1be486e27074",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-tags:malware-analysis",
      "fireeye-blog-tags:wannacry-ransomware",
      "fireeye-blog-tags:ransomware",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-authors:alex-berry",
      "fireeye-doctypes:blog",
      "fireeye-blog-authors:cap-josh-homan",
      "fireeye-blog-tags:homepage-carousel",
      "fireeye-blog-tags:latest",
      "fireeye-blog-authors:randi-eitzman"
    ],
    "jcr:uuid": "e6f911dc-847c-4546-a74c-66427b6f2663",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Tue May 23 2017 13:30:00 GMT-0400",
    "_charset_": "UTF-8",
    "cq:lastModifiedBy": "adam.greenberg@fireeye.com",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
        "text": "\u003Cp\u003EWannaCry (also known as WCry or WanaCryptor) malware is a self-propagating (worm-like) ransomware that spreads through internal networks and over the public internet by exploiting a vulnerability in Microsoft\u2019s Server Message Block (SMB) protocol, MS17-010. The \u003Ca href=\u0022https:\/\/www.fireeye.com\/blog\/products-and-services\/2017\/05\/wannacry-ransomware-campaign.html\u0022\u003EWannaCry\u003C\/a\u003E malware consists of two distinct components, one that provides ransomware functionality and a component used for propagation, which contains functionality to enable SMB exploitation capabilities.\u003C\/p\u003E\n\u003Cp\u003EThe malware leverages an exploit, codenamed \u201cEternalBlue\u201d, that was released by the Shadow Brokers on April 14, 2017.\u003C\/p\u003E\n\u003Cp\u003EThe malware appends encrypted data files with the .WCRY extension, drops and executes a decryptor tool, and demands $300 or $600 USD (via Bitcoin) to decrypt the data.\u003C\/p\u003E\n\u003Cp\u003EThe malware uses encrypted Tor channels for command and control (C2) communications.\u003C\/p\u003E\n\u003Ch3\u003EFile Characteristics\u003C\/h3\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002281\u0022\u003E\u003Cp\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022\u003E\u003Cp\u003E\u003Cb\u003EMD5 Hash\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002257\u0022\u003E\u003Cp\u003E\u003Cb\u003ESize (bytes)\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002266\u0022\u003E\u003Cp\u003E\u003Cb\u003ECompile Time\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002284\u0022\u003E\u003Cp\u003E\u003Cb\u003EDescription\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002254\u0022\u003E\u003Cp\u003E\u003Cb\u003EFiletype\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002281\u0022\u003E\u003Cp\u003Emssecsvc.exe\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022\u003E\u003Cp\u003Edb349b97c37d22f5ea1d1841e3c89eb4\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002257\u0022\u003E\u003Cp\u003E3723264\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002266\u0022\u003E\u003Cp\u003E2010-11-20T09:03:08Z\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002284\u0022\u003E\u003Cp\u003ELoader + Worm Component\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002254\u0022\u003E\u003Cp\u003EEXE\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002281\u0022\u003E\u003Cp\u003Etasksche.exe\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022\u003E\u003Cp\u003E84c82835a5d21bbcf75a61706d8ab549\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002257\u0022\u003E\u003Cp\u003E3514368\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002266\u0022\u003E\u003Cp\u003E2010-11-20T09:05:05Z\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002284\u0022\u003E\u003Cp\u003ELoader\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002254\u0022\u003E\u003Cp\u003EEXE\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002281\u0022\u003E\u003Cp\u003EUnavailable\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022\u003E\u003Cp\u003Ef351e1fcca0c4ea05fc44d15a17f8b36\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002257\u0022\u003E\u003Cp\u003E65536\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002266\u0022\u003E\u003Cp\u003E2009-07-14 01:12:55Z\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002284\u0022\u003E\u003Cp\u003EEncryptor\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002254\u0022\u003E\u003Cp\u003EDLL\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002281\u0022\u003E\u003Cp\u003E@WanaDecryptor@.exe\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022\u003E\u003Cp\u003E7bf2b57f2a205768755c07f238fb32cc\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002257\u0022\u003E\u003Cp\u003E245760\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002266\u0022\u003E\u003Cp\u003E2009-07-13 23:19:35Z\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002284\u0022\u003E\u003Cp\u003EDecryptor\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u002254\u0022\u003E\u003Cp\u003EEXE\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 1: File characteristics\u003C\/span\u003E\u003C\/p\u003E\n\u003Ch3\u003EPersistence Mechanism\u003C\/h3\u003E\n\u003Cp\u003EThe malware creates the following two registry run keys to ensure persistence:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EKey: HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\u0026lt;\u003Ci\u003ERandom\u003C\/i\u003E\u0026gt;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EValue: \u0026lt;\u003Ci\u003EFull_path\u003C\/i\u003E\u0026gt;\\tasksche.exe\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EKey: HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\u0026lt;\u003Ci\u003ERandom\u003C\/i\u003E\u0026gt;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EValue: \u0026lt;\u003Ci\u003EFull_path\u003C\/i\u003E\u0026gt;\\tasksche.exe\u003C\/p\u003E\n\u003Cp\u003EThe malware creates the following service to ensure persistence of mssecsvc.exe:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EServiceName: mssecsvc2.0\u003C\/li\u003E\n\u003Cli\u003EDisplayName: Microsoft Security Center (2.0) Service\u003C\/li\u003E\n\u003Cli\u003EBinaryPath: \u0026lt;path to mssecsvc\u0026gt; -m security\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware creates the following service to ensure persistence of tasksche.exe\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EServiceName: \u0026lt;8-15lower\u0026gt;\u0026lt;3number\u0026gt;\u003C\/li\u003E\n\u003Cli\u003EDisplayName: \u0026lt;Same as Service Name\u0026gt;\u003C\/li\u003E\n\u003Cli\u003EBinaryPath \u0026lt;path to tashsche.exe\u0026gt;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch3\u003EHost-Based Signatures\u003C\/h3\u003E\n\u003Ch4\u003EFile System Artifacts\u003C\/h4\u003E\n\u003Ch5\u003EChecksum\u003C\/h5\u003E\n\u003Cul\u003E\n\u003Cli\u003EActual: 0x00018AF7\u003C\/li\u003E\n\u003Cli\u003EHeader: 0x00000000\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EDropped Files\u003C\/h5\u003E\n\u003Cp\u003E\u003Cu\u003ELoader Files\u003C\/u\u003E\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EName:\u0026nbsp;tasksche.exe\u003Cbr\u003E\nPath:\u0026nbsp;C:\\WINDOWS\\\u003Cbr\u003E\nPath: \u0026lt;\u003Ci\u003Esystem_drive\u003C\/i\u003E\u0026gt;\\ProgamData\\\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;\u003Cbr\u003E\nPath: \u0026lt;\u003Ci\u003Esystem_drive\u003C\/i\u003E\u0026gt;\\Intel\\\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;\u003Cbr\u003E\nMD5: 84c82835a5d21bbcf75a61706d8ab549\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName:\u0026nbsp;qeriuwjhrf\u003Cbr\u003E\nPath:\u0026nbsp;C:\\WINDOWS\\\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_bulgarian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 95673b0f968c0f55b32204361940d184\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_chinese (simplified).wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 0252d45ca21c8e43c9742285c48e91ad\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_chinese (traditional).wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 2efc3690d67cd073a9406a25005f7cea\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_croatian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 17194003fa70ce477326ce2f6deeb270\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_czech.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 537efeecdfa94cc421e58fd82a58ba9e\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_danish.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 2c5a3b81d5c4715b7bea01033367fcb5\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_dutch.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 7a8d499407c6a647c03c4471a67eaad7\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_english.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: fe68c2dc0d2419b38f44d83f2fcf232e\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_filipino.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 08b9e69b57e4c9b966664f8e1c27ab09\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_finnish.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 35c2f97eea8819b1caebd23fee732d8f\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_french.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 4e57113a6bf6b88fdd32782a4a381274\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_german.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 3d59bbb5553fe03a89f817819540f469\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_greek.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: fb4e8718fea95bb7479727fde80cb424\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_indonesian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 3788f91c694dfc48e12417ce93356b0f\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_italian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 30a200f78498990095b36f574b6e8690\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_japanese.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: b77e1221f7ecd0b5d696cb66cda1609e\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_korean.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 6735cb43fe44832b061eeb3f5956b099\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_latvian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: c33afb4ecc04ee1bcc6975bea49abe40\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_norwegian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: ff70cc7c00951084175d12128ce02399\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_polish.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: e79d7f2833a9c2e2553c7fe04a1b63f4\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_portuguese.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: fa948f7d8dfb21ceddd6794f2d56b44f\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_romanian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 313e0ececd24f4fa1504118a11bc7986\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_russian.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 452615db2336d60af7e2057481e4cab5\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_slovak.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: c911aba4ab1da6c28cf86338ab2ab6cc\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_spanish.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 8d61648d34cba8ae9d1e2a219019add1\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_swedish.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: c7a19984eb9f37198652eaf2fd1ee25c\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_turkish.wnry\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 531ba6b1a5460fc9446946f91cc8c94b\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: m_vietnamese.wnr\u003Cbr\u003E\nPath: %CD%\\msg\\\u003Cbr\u003E\nMD5: 8419be28a0dcec3f55823620922b00fa\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: t.wnry\u003Cbr\u003E\nPath: %CD%\u003Cbr\u003E\nMD5: 5dcaac857e695a65f5c3ef1441a73a8f\u003Cbr\u003E\n\u003Cb\u003EDescription\u003C\/b\u003E: Encrypted Encryption Tool\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: taskdl.exe\u003Cbr\u003E\nPath: %CD%\u003Cbr\u003E\nMD5: 4fef5e34143e646dbf9907c4374276f5\u003Cbr\u003E\n\u003Cb\u003EDescription: \u003C\/b\u003ESupport tool for removing temporary files\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: taskse.exe\u003Cbr\u003E\nPath: %CD%\u003Cbr\u003E\nMD5: 8495400f199ac77853c53b5a3f278f3e\u003Cbr\u003E\n\u003Cb\u003EDescription: \u003C\/b\u003ESupport tool for launch Decryption Tool\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: u.wnry\u003Cbr\u003E\nPath: %CD%\u003Cbr\u003E\nMD5: 7bf2b57f2a205768755c07f238fb32cc\u003Cbr\u003E\n\u003Cb\u003EDescription\u003C\/b\u003E: Decryption Tool\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EFile: b.wnry\u003Cbr\u003E\nPath: %CD%\u003Cbr\u003E\nMD5: c17170262312f3be7027bc2ca825bf0c\u003Cbr\u003E\n\u003Cb\u003EDescription\u003C\/b\u003E: Ransom Image (BMP)\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EName: c.wnry\u003Cbr\u003E\nPath: %CD%\u003Cbr\u003E\nMD5: ae08f79a0d800b82fcbe1b43cdbdbefc\u003Cbr\u003E\n\u003Cb\u003EDescription\u003C\/b\u003E: Config Data\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Cu\u003EEncryptor Files\u003C\/u\u003E\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E00000000.res\u003C\/li\u003E\n\u003Cli\u003E00000000.pky\u003C\/li\u003E\n\u003Cli\u003E00000000.eky\u003C\/li\u003E\n\u003Cli\u003E00000000.dky\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Cu\u003EDecryptor Files\u003C\/u\u003E\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ec.wnry\u003C\/li\u003E\n\u003Cli\u003EFile: taskhsvc.exe\u003Cbr\u003E\nPath: TaskData\\Tor\\\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe following artifact can be found on remotely exploited systems:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EName:\u0026nbsp;mssecsvc.exe\u003Cbr\u003E\nPath:\u0026nbsp;C:\\WINDOWS\\\u003Cbr\u003E\nMD5:\u0026nbsp;db349b97c37d22f5ea1d1841e3c89eb4\u003Cbr\u003E\n\u003Cb\u003EDescription\u003C\/b\u003E: Dropper + worm component\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003ERegistry Artifacts\u003C\/h5\u003E\n\u003Cul\u003E\n\u003Cli\u003EServiceName:\u0026nbsp;mssecsvc2.0\u003Cbr\u003E\nDisplayName:\u0026nbsp;Microsoft Security Center (2.0) Service\u003Cbr\u003E\nBinaryPath:\u0026nbsp;\u0026lt;\u003Ci\u003EGetModuleFileName\u003C\/i\u003E\u0026gt; -m security\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EHKLM\\Software\\WanaCrypt0r\\wd\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cul\u003E\n\u003Cli\u003EHKCU\\Software\\WanaCrypt0r\\wd\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EExports\u003C\/h5\u003E\n\u003Cul\u003E\n\u003Cli\u003E0x00005AE0\u0026nbsp;TaskStart\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EMutex\u003C\/h5\u003E\n\u003Cul\u003E\n\u003Cli\u003EMsWinZonesCacheCounterMutexA\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EProcess Arguments\u003C\/h5\u003E\n\u003Cul\u003E\n\u003Cli\u003Eicacls . \/grant Everyone:F \/T \/C \/Q\u003C\/li\u003E\n\u003Cli\u003Eattrib +h +s \u0026lt;Drive_Letter\u0026gt;:\\$RECYCLE\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im Microsoft.Exchange.\\*\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im MSExchange\\*\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im sqlserver.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im sqlwriter.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im mysqld.exe\u003C\/li\u003E\n\u003Cli\u003Ecmd.exe \/c start \/b @WanaDecryptor@.exe vs\u003C\/li\u003E\n\u003Cli\u003Ecmd.exe \/c vssadmin delete shadows \/all \/quiet \u0026amp; wmic shadowcopy delete \u0026amp; bcdedit \/set {default} bootstatuspolicy ignoreallfailures \u0026amp; bcdedit \/set {default} recoveryenabled no \u0026amp; wbadmin delete catalog -q\u003C\/li\u003E\n\u003Cli\u003E-m security\u003C\/li\u003E\n\u003Cli\u003Ecmd \/c \u0026lt;15 digits\u0026gt;.bat\u003C\/li\u003E\n\u003Cli\u003Ecscript.exe \/\/nologo \u0026lt;1 character\u0026gt;.vbs\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch3\u003ENetwork-Based Signatures\u003C\/h3\u003E\n\u003Ch4\u003EDNS\u003C\/h4\u003E\n\u003Cul\u003E\n\u003Cli\u003Ewww.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com (sinkholed)\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch4\u003EConnections\u003C\/h4\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026lt;\u003Ci\u003Erandom_ip\u003C\/i\u003E\u0026gt;:445\u0026nbsp;\u003C\/li\u003E\n\u003Cli\u003E\u0026lt;\u003Ci\u003Esubnet_ip\u003C\/i\u003E\u0026gt;:445\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch3\u003EWannaCry Analysis\u003C\/h3\u003E\n\u003Ch4\u003EStartup\u003C\/h4\u003E\n\u003Cp\u003EThe malware starts by attempting to connect to\u0026nbsp;the following domain with\u0026nbsp;InternetOpenUrl:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ewww.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003ENOTE: If this succeeds, the malware immediately exits. For a list of observed killswitch domains, see Appendix A.\u003C\/p\u003E\n\u003Cp\u003EIf the connection fails, however, the malware checks the number of arguments passed to the program. If zero, the malware continues with installation; otherwise it enters service mode.\u003C\/p\u003E\n\u003Cp\u003ENote: Network proxies and other enterprise network security features may prevent the malware from contacting its killswitch domain and inadvertently trigger encryption. Organizations may wish to adjust their proxy configurations or other network configurations to avoid this problem.\u003C\/p\u003E\n\u003Ch4\u003EService Mode\u003C\/h4\u003E\n\u003Cp\u003EIn service mode, the malware first updates the service config so that failure actions occur if the service exits without entering a\u0026nbsp;SERVICE_STOPPED\u0026nbsp;state. The malware then executes the service function, which registers the service handlers and attempts exploitation of MS17-010 against identified SMB services. This allows remote code execution and enables spreading across the network. This execution is performed in a thread, and the service exits after 24 hours regardless of the status of the thread.\u003C\/p\u003E\n\u003Cp\u003EThe spreader begins by setting up the Windows socket APIs and generating a RSA crypto context. This crypto context is later used to generate random numbers. The malware then builds two DLLs in memory \u2013 they are 32 and 64-bit DLLs that have identical functionality. Each one contains a single export named\u0026nbsp;\u003Ci\u003EPlayGame\u003C\/i\u003E\u0026nbsp;that loads the\u0026nbsp;W\u0026nbsp;resource, writes it to\u0026nbsp;C:\\WINDOWS\\mssecsvc.exe,\u0026nbsp;and executes it. The\u0026nbsp;W\u0026nbsp;resource in each case has been populated with a copy of the running binary (MD5: db349b97c37d22f5ea1d1841e3c89eb4).\u003C\/p\u003E\n\u003Cp\u003EThe malware continues by spawning two threads, the first thread enumerates the network adapters and determines which subnets the system is on. The malware then generates a thread for each IP on the subnet. Each of these threads attempts to connect to the IP on port\u0026nbsp;445\u0026nbsp;and, if successful, attempts exploitation of the service via a vulnerability described in MS17-010. An example of an attempt to exploit\u0026nbsp;MS17-010\u0026nbsp;on a remote system can be seen in Figure 1.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image1.png\u0022\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 1: WannaCry network traffic attempting SMB exploit\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EOne of the unique features of this traffic is an\u0026nbsp;SMB Tree Connect AndX Request\u0026nbsp;containing the following UNICODE string: \u0026nbsp;\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\\\\192.168.56.20\\IPC$\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThis packet is hand-crafted and hard-coded into the malware.\u003C\/p\u003E\n\u003Cp\u003EThe second thread generates random IPs and attempts to connect to them on port\u0026nbsp;445. If the connection is successful, the malware then attempts to perform the\u0026nbsp;SMB attack on the system.\u0026nbsp;128\u0026nbsp;instances of the second thread area created with two seconds separating each thread creations.\u003C\/p\u003E\n\u003Ch4\u003EInstallation\u003C\/h4\u003E\n\u003Cp\u003EThe malware continues by creating a service named\u0026nbsp;\u003Ci\u003Emssecsvc2.0\u003C\/i\u003E\u0026nbsp;with a binary path pointing to the running module with the arguments \u0026quot;-m security\u0026quot;. Once created, the malware starts the service. The malware then locates its\u0026nbsp;R\u0026nbsp;resource and loads it into memory. The malware then writes the R resource data to the file\u0026nbsp;C:\\WINDOWS\\\u003Ci\u003Etasksche.exe\u003C\/i\u003E. The malware executes C:\\WINDOWS\\tasksche.exe \/i with the\u0026nbsp;CreateProcess\u0026nbsp;API. The malware then attempts to move\u0026nbsp;C:\\WINDOWS\\\u003Ci\u003Etasksche.exe\u0026nbsp;\u003C\/i\u003Eto\u0026nbsp;C:\\WINDOWS\\\u003Ci\u003Eqeriuwjhrf\u003C\/i\u003E, replacing the original file if it exists.\u003C\/p\u003E\n\u003Cp\u003EThe malware begins by generating a unique identifier based on the computer name. The identifier,\u0026nbsp;\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;, has the form of 8-15 random lowercase characters followed by 3 numbers. The malware then checks to see if it was passed the\u0026nbsp;\/i\u0026nbsp;argument.\u003C\/p\u003E\n\u003Ch5\u003ERun with \/i Command\u003C\/h5\u003E\n\u003Cp\u003EThe \/i command copies the running binary to \u0026lt;system_drive\u0026gt;\\ProgamData\\\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;\\\u003Ci\u003Etasksche.exe\u0026nbsp;\u003C\/i\u003Eif\u0026nbsp;\u0026lt;\u003Ci\u003Esystem_drive\u003C\/i\u003E\u0026gt;\\ProgamData\u0026nbsp;exists, otherwise it will be copied to\u0026nbsp;\u0026lt;\u003Ci\u003Esystem_drive\u003C\/i\u003E\u0026gt;\\Intel\\\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;\\\u003Ci\u003Etasksche\u003C\/i\u003E.\u003Ci\u003Eexe\u003C\/i\u003E.\u0026nbsp;\u0026lt;\u003Ci\u003Esystem_drive\u003C\/i\u003E\u0026gt;is the drive letter on which Windows was installed (C:\\\u0026nbsp;for\u0026nbsp;C:\\Windows). The malware then updates its\u0026nbsp;current directory to the created directory.\u003C\/p\u003E\n\u003Cp\u003EThe malware then attempts to open the service named\u0026nbsp;\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;. If it does not exist, the malware creates it with a DisplayName of\u0026nbsp;\u0026lt;\u003Ci\u003Esys_id\u003C\/i\u003E\u0026gt;\u0026nbsp;and a BinaryPath of\u0026nbsp;cmd \/c \u0026lt;\u003Ci\u003Epath_to_copied tasksche.exe\u003C\/i\u003E\u0026gt;. The malware then starts the service. The malware attempts to open the mutex\u0026nbsp;Global\\MsWinZonesCacheCounterMutexA0. If the mutex is not created within 60 seconds, the malware re-lauches itself from the new installation directory with no arguments. The malware then waits 60 seconds for the mutex to be created. If the mutex is created in either instance, the initial executable exits. If the mutex fails to be created, the malware continues as if it was run without the\u0026nbsp;\/i\u0026nbsp;argument.\u003C\/p\u003E\n\u003Ch5\u003ERun without \/i Command\u003C\/h5\u003E\n\u003Cp\u003EThe malware updates\u0026nbsp;%CD%\u0026nbsp;to the path of the running module and sets\u0026nbsp;HKLM\\Software\\WanaCrypt0r\\wd\u0026nbsp;to\u0026nbsp;%CD%. The malware then loads the XIA resource and decompresses numerous files (see\u0026nbsp;Table 3) to\u0026nbsp;%CD%. The malware then opens\u0026nbsp;%CD%\\\u003Ci\u003Ec.wnry\u003C\/i\u003E (the configuration data) and loads it into memory. It expects the file to be of size 0x30C. The malware then chooses randomly between the three strings\u0026nbsp;13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94,\u0026nbsp;12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw, and\u0026nbsp;115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn; writes it to offset 0xB2 in the configuration file; and writes the updated configuration data back to\u0026nbsp;%CD%\\\u003Ci\u003Ec.wnry\u003C\/i\u003E.\u003C\/p\u003E\n\u003Cp\u003EThe malware then sets the hidden attribute for\u0026nbsp;%CD%\u0026nbsp;by executing the following command with CreateProcess:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Eattrib +h\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware then executes the following command \u2013 granting all users permissions to\u0026nbsp;%CD%\u0026nbsp;and all of its subdirectories:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Eicacls . \/grant Everyone:F \/T \/C \/Q\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware then imports the hard-coded RSA Private key, shown in Figure 2.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image2.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 2: Imported private key\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware then opens and reads\u0026nbsp;%CD%\\\u003Ci\u003Et.wnry\u003C\/i\u003E. The first 8 bytes of the file are checked to match the magic value\u0026nbsp;WANACRY!. The file has the following structure:\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/Struct.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003EThe encrypted key decrypts to the 128-bit AES key\u0026nbsp;BEE19B98D2E5B12211CE211EECB13DE6. This key can then be used to decrypt the enc_data. The decrypted data is saved as\u0026nbsp;a DLL (MD5: f351e1fcca0c4ea05fc44d15a17f8b36). This DLL is then manually loaded into memory and the\u0026nbsp;\u003Ci\u003ETaskStart\u0026nbsp;\u003C\/i\u003Eexport is called. The\u0026nbsp;TaskStart\u0026nbsp;export of the decrypted DLL is the encryption component of the ransomware.\u003C\/p\u003E\n\u003Ch5\u003EXIA Resource Contents\u003C\/h5\u003E\n\u003Cp\u003EThe files shown in Table 2 are extracted from the XIA resource. They are dropped into the %CD% of the running malware.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EMD5 Hash\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EDescription\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Er.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E3e0020fc529b1c2a061016dd2469ba96\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EText ransom note\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Es.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ead4c9de7c8c40813f200ba1c2fa33083\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EZip file containing Tor files\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Et.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E5dcaac857e695a65f5c3ef1441a73a8f\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEncrypted encryption tool\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Etaskdl.exe\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E4fef5e34143e646dbf9907c4374276f5\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E*.WNCRYT file deletion tool\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Etaskse.exe\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E8495400f199ac77853c53b5a3f278f3e\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUtility used to launch decryption tool\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eu.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E7bf2b57f2a205768755c07f238fb32cc\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EDecryption tool\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eb.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ec17170262312f3be7027bc2ca825bf0c\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ERansom image (BMP)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002285\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ec.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022212\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eae08f79a0d800b82fcbe1b43cdbdbefc\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022171\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EConfiguration data\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 2: XIA extracted resources\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003ETable 3 shows RTF documents containing the ransom note in various languages.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EFilename\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EMD5 Hash\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_bulgarian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E95673b0f968c0f55b32204361940d184\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_chinese (simplified).wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0252d45ca21c8e43c9742285c48e91ad\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_chinese (traditional).wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E2efc3690d67cd073a9406a25005f7cea\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_croatian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E17194003fa70ce477326ce2f6deeb270\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_czech.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E537efeecdfa94cc421e58fd82a58ba9e\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_danish.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E2c5a3b81d5c4715b7bea01033367fcb5\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_dutch.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E7a8d499407c6a647c03c4471a67eaad7\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_english.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Efe68c2dc0d2419b38f44d83f2fcf232e\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_filipino.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E08b9e69b57e4c9b966664f8e1c27ab09\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_finnish.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E35c2f97eea8819b1caebd23fee732d8f\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_french.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E4e57113a6bf6b88fdd32782a4a381274\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_german.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E3d59bbb5553fe03a89f817819540f469\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_greek.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Efb4e8718fea95bb7479727fde80cb424\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_indonesian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E3788f91c694dfc48e12417ce93356b0f\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_italian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E30a200f78498990095b36f574b6e8690\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_japanese.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eb77e1221f7ecd0b5d696cb66cda1609e\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_korean.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E6735cb43fe44832b061eeb3f5956b099\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_latvian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ec33afb4ecc04ee1bcc6975bea49abe40\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_norwegian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eff70cc7c00951084175d12128ce02399\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_polish.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ee79d7f2833a9c2e2553c7fe04a1b63f4\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_portuguese.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Efa948f7d8dfb21ceddd6794f2d56b44f\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_romanian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E313e0ececd24f4fa1504118a11bc7986\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_russian.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E452615db2336d60af7e2057481e4cab5\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_slovak.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ec911aba4ab1da6c28cf86338ab2ab6cc\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_spanish.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E8d61648d34cba8ae9d1e2a219019add1\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_swedish.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ec7a19984eb9f37198652eaf2fd1ee25c\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_turkish.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E531ba6b1a5460fc9446946f91cc8c94b\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022157\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Em_vietnamese.wnry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022225\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E8419be28a0dcec3f55823620922b00fa\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 3: Ransom notes in various languages\u003C\/span\u003E\u003C\/p\u003E\n\u003Ch4\u003EEncryption Component\u003C\/h4\u003E\n\u003Cp\u003EThe \u003Ci\u003ETaskStart\u003C\/i\u003E export takes two arguments; the handle to the module and an integer that must be zero. \u003Ci\u003ETaskStart\u003C\/i\u003E first creates a mutex named \u0026quot;MsWinZonesCacheCounterMutexA\u0026quot; and reads the contents of \u003Ci\u003Ec.wnry\u003C\/i\u003E from the current directory. If the mutex exists or \u003Ci\u003Ec.wnry\u003C\/i\u003E is not present, the malware exits. The malware creates another mutex named \u0026quot;Global\\MsWinZonesCacheCounterMutexA0\u0026quot;.\u003C\/p\u003E\n\u003Cp\u003EThe malware then loads and verifies a key from the file \u003Ci\u003E00000000.dky\u003C\/i\u003E. The malware then attempts to load a key \u003Ci\u003E00000000.pky\u003C\/i\u003E. If the key does not exist, the malware imports a public RSA key (seen in Figure 3), generates a new 2048-bit RSA key and saves the public key to \u003Ci\u003E00000000.pky\u003C\/i\u003E. The malware then saves the generated private key to \u003Ci\u003E00000000.eky\u003C\/i\u003E, encrypted with the embedded public key.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image3.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 3: Public RSA key\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe \u003Ci\u003E00000000.eky\u003C\/i\u003E starts with the number of bytes in little endian (0x500) followed by the encrypted key.\u003C\/p\u003E\n\u003Cp\u003EThe malware launches a thread that writes 136 bytes to \u003Ci\u003E00000000.res\u003C\/i\u003E every 25 seconds. The buffer written includes the current time of the system. If the file \u003Ci\u003E00000000.res\u003C\/i\u003E does not exist while the malware is initializing, it creates the file. The initial contents begins with eight randomly generated bytes followed by 128 zero bytes.\u003C\/p\u003E\n\u003Cp\u003EThe malware launches another thread that verifies it can encrypt and decrypt using the keys contained in \u003Ci\u003E00000000.dky\u003C\/i\u003E and \u003Ci\u003E00000000.pky\u003C\/i\u003E every 25 seconds. If the decryption is successful, the malware sets a global flag that stops the encryption process.\u003C\/p\u003E\n\u003Cp\u003EThe malware launches another thread that scans for new drives attached to the system every three seconds. If a new drive is attached to the system and is not identified as a type CDROM drive, the malware begins the encryption process on the new drive. On new drives attached to the system, the malware may create the directory \u0026lt;\u003Ci\u003EDrive_letter\u003C\/i\u003E\u0026gt;:\\$RECYCLE and execute the following command:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Eattrib +h +s \u0026lt;\u003Ci\u003EDrive_Letter\u003C\/i\u003E\u0026gt;:\\$RECYCLE\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware creates a thread that executes the process \u003Ci\u003Etaskdl.exe\u003C\/i\u003E every 30 seconds.\u003C\/p\u003E\n\u003Cp\u003Eand creates another thread that executes either of the following two binaries (depending on administrator permissions and if the malware is running at system level):\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E@WanaDecryptor@.exe\u003C\/li\u003E\n\u003Cli\u003Etaskse.exe \u0026lt;\u003Ci\u003EFull_Path\u003C\/i\u003E\u0026gt;\\@WanaDecryptor@.exe\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EA registry key name starting with 8 to 15 characters between \u0027a\u0027 and \u0027z\u0027 followed by three random values between \u00270\u0027 and \u00279\u0027 is then generated by the malware. It may then create the following registry paths with the generated key name:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\u0026lt;Key\u0026gt;\u003C\/li\u003E\n\u003Cli\u003EHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\u0026lt;Key\u0026gt;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003ETo create the registry key, the malware executes the following command:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ecmd.exe \/c reg add \u0026lt;\u003Ci\u003ERegistry_Ru_Path\u003C\/i\u003E\u0026gt; \/v \u0026quot;\u0026lt;\u003Ci\u003ERandom\u003C\/i\u003E\u0026gt;\u0026quot; \/t REG_SZ \/d \u0026quot;\\\u0026quot;\u0026lt;\u003Ci\u003EFull_Path\u003C\/i\u003E\u0026gt;\\tasksche.exe\\\u0026quot;\u0026quot; \/f\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EUser File Encryption\u003C\/h5\u003E\n\u003Cp\u003EThe malware loads another embedded RSA public key shown in Figure 4.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image4.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 4: Additional embedded RSA public key\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware executes the file \u003Ci\u003E@WanaDecryptor@.exe \u003C\/i\u003Ewith the argument \u0026quot;fi\u0026quot;. This appears to be an initial check-in with the server and the response may contain an updated bitcoin address. The malware updates \u003Ci\u003Ec.wnry\u003C\/i\u003E with the current time at offset 0x60.\u003C\/p\u003E\n\u003Cp\u003EThe malware then copies \u003Ci\u003Eu.wrny\u003C\/i\u003E to \u003Ci\u003E@WanaDecryptor@.exe\u003C\/i\u003E and executes the script shown in Figure 5 to create \u003Ci\u003E@WanaDecryptor@.exe.lnk\u003C\/i\u003E. The script is saved to a randomly generated filename based on the current time and a random value using characters from \u00270\u0027 to \u00279\u0027. Example filename: \u0026quot;188391494652743.bat\u0026quot;.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image5.png\u0022\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 5: WannaCry internal script for moving and deleting files\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware then writes either \u0026quot;$\u0026lt;\u003Ci\u003EValue\u003C\/i\u003E\u0026gt;worth of bitcoin\u0026quot; or \u0026quot;%.\u0026lt;\u003Ci\u003EValue\u003C\/i\u003E\u0026gt; BTC\u0026quot; depending on the configuration \u2013 followed by the contents of the file \u003Ci\u003Er.wnry\u003C\/i\u003E to \u003Ci\u003E@Please_Read_Me@.txt\u003C\/i\u003E, which reads as follows:\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EQ: What\u0027s wrong with my files?\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EA: Ooops, your important files are encrypted. It means you will not be able to access them anymore until they are decrypted.\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; If you follow our instructions, we guarantee that you can decrypt all your files quickly and safely!\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; Let\u0027s start decrypting!\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EQ: What do I do?\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EA: First, you need to pay service fees for the decryption.\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; Please send \u0026lt;\u003Ci\u003ERansom Amount\u003C\/i\u003E\u0026gt; to this bitcoin address: \u0026lt;\u003Ci\u003EBitcoin_address\u003C\/i\u003E\u0026gt;\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E\u0026nbsp; \u0026nbsp; Next, please find an application file named \u0026quot;@WanaDecryptor@.exe\u0026quot;. It is the decrypt software.\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; Run and follow the instructions! (You may need to disable your antivirus for a while.)\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EQ: How can I trust?\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EA: Don\u0027t worry about decryption.\u003Cbr\u003E\n\u0026nbsp; \u0026nbsp; We will decrypt your files surely because nobody will trust us if we cheat users.\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003E*\u0026nbsp;\u0026nbsp; If you need our assistance, send a message by clicking \u0026lt;Contact Us\u0026gt; on the decryptor window.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image6.png\u0022\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 6: Encryption warning displayed to user\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware then targets files on the user\u0027s desktop and documents folders. When the malware starts scanning a directory it creates a temporary file with the prefix \u0026quot;~SD\u0026quot;, and deletes it if successful.\u003C\/p\u003E\n\u003Cp\u003EWhen selecting which files to encrypt, the malware skips over files with .exe, .dll, and .wncry extensions. The files with the extensions shown in Figure 7 are selected for encryption. Files larger than 209,715,200 bytes may also be encrypted.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image7.png\u0022\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 7: Files targeted for encryption\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware may ignore folders with the following names:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\\\\\u003C\/li\u003E\n\u003Cli\u003E$\\\u003C\/li\u003E\n\u003Cli\u003EIntel\u003C\/li\u003E\n\u003Cli\u003EProgramData\u003C\/li\u003E\n\u003Cli\u003EWINDOWS\u003C\/li\u003E\n\u003Cli\u003EProgram Files\u003C\/li\u003E\n\u003Cli\u003EProgram Files (x86)\u003C\/li\u003E\n\u003Cli\u003EAppData\\Local\\Temp\u003C\/li\u003E\n\u003Cli\u003ELocal Settings\\Temp\u003C\/li\u003E\n\u003Cli\u003ETemporary Internet Files\u003C\/li\u003E\n\u003Cli\u003EContent.IE5\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware will also compare folder names with the following string, and avoid encryption if identified:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026quot; This folder protects against ransomware. Modifying it will reduce protection\u0026quot;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003ENote: The string contains a leading whitespace. This particular check is likely included for testing\/development purposes.\u003C\/p\u003E\n\u003Cp\u003EWhen a directory contains a file that will be encrypted, the malware copies \u003Ci\u003E@Please_Read_Me@.txt\u003C\/i\u003E and \u003Ci\u003E@WanaDecryptor@.exe\u003C\/i\u003E to the directory. It verifies that the first eight bytes do not contain the string \u003Ci\u003EWANACRY!\u003C\/i\u003E and performs additional checks on the header to verify the file is not already encrypted.\u003C\/p\u003E\n\u003Cp\u003EThe files are encrypted with a randomly generated 128-bit AES key in CBC mode with a NULL initialization vector. The key is generated per file, is encrypted with the generated RSA public key, and included in the encrypted file header. Each file encrypted by the malware starts with the string \u003Ci\u003EWANACRY!\u003C\/i\u003E and has the \u003Ci\u003EWNCRY\u003C\/i\u003E extension. Depending on the file properties, the malware may also stage files in a \u003Ci\u003EWNCRYT\u003C\/i\u003E extension.\u003C\/p\u003E\n\u003Cp\u003ETable 4 shows the file format of encrypted files.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EOffset\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EValue\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0x0000\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EWANACRY!\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0x0008\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ELength of RSA encrypted data\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0x000C\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ERSA encrypted AES file encryption key\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0x010C\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile type internal to WannaCry\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0x0110\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EOriginal file size\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002258\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E0x0118\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022234\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEncrypted file contents\u0026nbsp; (AES-128 CBC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 4: Encrypted file format\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EWhen encrypting the AES key with RSA, the malware may use the embedded RSA key or a key randomly generated. If the file \u003Ci\u003Ef.wnry\u003C\/i\u003E does not exist during initilazation, the malware generates a random number if the file size is less than 209,715,200 bytes. If the number is a multiple of 100, the malware uses the embedded RSA key to encrypt the AES key. A maximum of ten files can be encrypted with this key. When an AES key is encrypted with this RSA key, the malware writes the file path to the file \u003Ci\u003Ef.wnry\u003C\/i\u003E. If the random number is not a multiple of 100 or the file \u003Ci\u003Ef.wnry\u003C\/i\u003E already exists on the system, the malware will encrypt the AES key with the randomly generated RSA key.\u003C\/p\u003E\n\u003Cp\u003EOnce the malware completes encrypting the desktop and documents folders, it executes the following commands:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im Microsoft.Exchange.\\*\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im MSExchange\\*\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im sqlserver.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im sqlwriter.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im mysqld.exe\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware then encrypts files found on logical drives attached to the system that are not type DRIVE_CDROM.\u003C\/p\u003E\n\u003Cp\u003EThe malware may execute the command:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E@WanaDecryptor@.exe co\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware executes the command:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ecmd.exe \/c start \/b @WanaDecryptor@.exe vs\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware will copy \u003Ci\u003Eb.wnry \u003C\/i\u003Eto \u003Ci\u003E@WanaDecryptor@.bmp\u003C\/i\u003E and place it in each user\u2019s desktop folder, as well as a copy of \u003Ci\u003E@WanaDecryptor@.exe\u003C\/i\u003E.\u003C\/p\u003E\n\u003Ch4\u003EDecryptor Component\u003C\/h4\u003E\n\u003Cp\u003EThe malware communicates with an Onion server using a Tor server running on local host TCP port 9050. The malware registers the system with the Onion server, transferring encryption keys and deleting volume shadows. Once the ransom is paid, the malware obtains the decrypted RSA private key from the Onion server and decrypts ransomed files.\u003C\/p\u003E\n\u003Cp\u003EIt first attempts to read the contents of the registry path HKLM\\Software\\WanaCrypt0r\\wd. If this fails, the malware attempts to read the contents from a similar registry path within the HKCU registry hive. If one of the registry paths exists, the malware sets the current directory to value read from the registry.\u003C\/p\u003E\n\u003Cp\u003EThe malware attempts to open \u003Ci\u003Ec.wnry\u003C\/i\u003E from the current directory and read 780 bytes if it exists. If the file does not exist, the file is created with the contents shown in Figure 8.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image8.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 8: Contents of c.wnry\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EThe value at offset 0x6c (0x59140342) in \u003Ci\u003Ec.wnry\u003C\/i\u003E is the timestamp the file was created. The remaining values are hardcoded within the binary.\u003C\/p\u003E\n\u003Ch5\u003EAccepted Commands\u003C\/h5\u003E\n\u003Cp\u003EThe decryptor component accepts the command line arguments shown in Table 5.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002292\u0022\u003E\u003Cp\u003E\u003Cb\u003EArgument\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022335\u0022\u003E\u003Cp\u003E\u003Cb\u003EDescription\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002292\u0022\u003E\u003Cp\u003Efi\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022335\u0022\u003E\u003Cp\u003EConnects to an Onion server sending details from the system including the host name, user name and eight bytes from 00000000.res. The response may include a Bitcoin address that is updated in \u003Ci\u003Ec.wnry\u003C\/i\u003E.\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002292\u0022\u003E\u003Cp\u003Eco\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022335\u0022\u003E\u003Cp\u003EAppears to be an initial check-in with the ransom server without displaying the ransom interface.\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002292\u0022\u003E\u003Cp\u003Evs\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022335\u0022\u003E\u003Cp\u003EDeletes volume shadow copies using the vssadmin utility.\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 5: Accepted commands\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cu\u003Efi Argument\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware reads 136 bytes from the file \u0026quot;00000000.res\u0026quot; in the current path. If the file does not exist the malware exits. The malware reads two URLs from\u0026nbsp;\u003Ci\u003Ec.wnry\u003C\/i\u003E\u0026nbsp;at offsets 0x242 and 0x1DE.\u003C\/p\u003E\n\u003Cp\u003EThe first URL at offset 0x1DE in \u003Ci\u003Ec.wnry\u003C\/i\u003E is:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ci\u003Ehttps:\/\/dist.torproject.org\/torbrowser\/6.5.1\/tor-win32-0.2.9.10.zip\u003C\/i\u003E\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe alternate URL at offset 0x242 is not configured.\u003C\/p\u003E\n\u003Cp\u003EThe malware then binds a TCP socket to the localhost (127.0.0.1) and connects to port 9050 on the localhost.\u003C\/p\u003E\n\u003Cp\u003EThe malware then checks if the path \u0026quot;TaskData\\Tor\\\u003Ci\u003Etaskhsvc.exe\u003C\/i\u003E\u0026quot; exists. If the file does not exist it is extracted from the archive \u003Ci\u003Es.wnry\u003C\/i\u003E. If \u003Ci\u003Es.wnry\u003C\/i\u003E does not exist, the malware downloads the first URL in the configuration \u2013 and if this fails it attempts the second.\u003C\/p\u003E\n\u003Cp\u003EWhen downloading from a URL, the downloaded file is first saved to a filename generated with GetTempFileNameA with a \u0026quot;t\u0026quot; prefix within the TaskData folder. The downloaded file is a Zip archive that is extracted to the \u0026quot;TaskData\u0026quot; folder.\u003C\/p\u003E\n\u003Cp\u003EOnce extracted, the malware copies \u0026quot;TaskData\\Tor\\\u003Ci\u003Etor.exe\u003C\/i\u003E\u0026quot; to \u0026quot;TaskData\\Tor\\\u003Ci\u003Etaskhsvc.exe\u003C\/i\u003E\u0026quot; and executes it.\u003C\/p\u003E\n\u003Cp\u003EThe malware parses the string obtained at offset 0xE4 in the configuration file \u003Ci\u003Ec.wnry\u003C\/i\u003E for Onion servers to connect to. The Onion servers listed in the configuration file are as follows:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Egx7ekbenv2riucmf.onion\u003C\/li\u003E\n\u003Cli\u003E57g7spgrzlojinas.onion\u003C\/li\u003E\n\u003Cli\u003Exxlvbrloxvriy2c5.onion\u003C\/li\u003E\n\u003Cli\u003E76jdd2ir2embyv47.onion\u003C\/li\u003E\n\u003Cli\u003Ecwwnhwhlz52maqm7.onion\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EThe malware sends the first eight bytes of the file \u003Ci\u003E00000000.res\u003C\/i\u003E, the host name, user name and the string \u0026quot;+++\u0026quot; to the Onion server. The command and control protocol appears to be custom and XOR encoded with a randomly generated buffer.\u003C\/p\u003E\n\u003Cp\u003EThe response from the server is added to \u003Ci\u003Ec.wnry\u003C\/i\u003E if the string is 30 to 50 characters in length. The following is an example message sent to the server:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026lt;\u003Ci\u003E8 bytes from 00000000.res\u003C\/i\u003E\u0026gt;\u0026lt;\u003Ci\u003EHost name\u003C\/i\u003E\u0026gt;\\x00\u0026lt;\u003Ci\u003EUnknown Byte\u003C\/i\u003E\u0026gt;\u0026lt;\u003Ci\u003EUser name\u003C\/i\u003E\u0026gt;\\x00+++\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Cu\u003Eco Argument\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003EThis argument the malware scans for file names in the format \u0026lt;\u003Ci\u003E8_Uppercase_Hex\u003C\/i\u003E\u0026gt;.res. The file the malware is likely looking for is \u003Ci\u003E00000000.res\u003C\/i\u003E that is created by the encryption DLL. \u0026nbsp;The malware then generates a C2 message containing four values (Table 6) obtained from the \u0026quot;.res\u0026quot; file in the following format:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E--- \u0026lt;\u003Ci\u003ETime0\u003C\/i\u003E\u0026gt; \u0026lt;\u003Ci\u003ETime1\u003C\/i\u003E\u0026gt; \u0026lt;\u003Ci\u003EUnknown_int0\u003C\/i\u003E\u0026gt; \u0026lt;\u003Ci\u003EUnknown_long\u003C\/i\u003E\u0026gt; \u0026lt;\u003Ci\u003EIndex\u003C\/i\u003E\u0026gt;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003ENote: In the aforementioned example, the values are separated with a TAB character.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003E\u003Cb\u003EValue\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003E\u003Cb\u003EDescription\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003E---\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003EHard-coded string likely intended to identify the command\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003ETime0\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003ETime value obtained from offset 0x60\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003ETime1\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003ETime value obtained from offset 0x78\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003EUnknown int0\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003EInteger obtained from offset 0x7C\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003EUnknown long\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003E64-bit Integer obtained from offset 0x80\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022\u003E\u003Cp\u003EIndex\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022347\u0022\u003E\u003Cp\u003ECount of the current file when scanning for files in the format \u0026lt;\u003Ci\u003E8_Uppercase_Hex\u003C\/i\u003E\u0026gt;.res\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 6: C2 message values\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EFigure 9 shows an example of a message.\u003C\/p\u003E\n\u003Cp\u003E\u003Cimg src=\u0022\/content\/dam\/fireeye-www\/blog\/images\/WannaCry%20malware%20profile\/image9.png\u0022\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003EFigure 9: Sample C2 message\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EAfter sending the message, the malware exits.\u003C\/p\u003E\n\u003Cp\u003E\u003Cu\u003Evs Argument\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware sleeps for 10 seconds and then executes the following command using CreateProcess or RunAs (depending on group membership):\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ecmd.exe \/c vssadmin delete shadows \/all \/quiet \u0026amp; wmic shadowcopy delete \u0026amp; bcdedit \/set {default} bootstatuspolicy ignoreallfailures \u0026amp; bcdedit \/set {default} recoveryenabled no \u0026amp; wbadmin delete catalog -q\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003E\u003Cu\u003ENo Argument\u003C\/u\u003E\u003C\/p\u003E\n\u003Cp\u003EThe malware copies \u003Ci\u003Eb.wnry\u003C\/i\u003E from the current directory to the desktop with the filename \u003Ci\u003E@WanaDecryptor@.bmp\u003C\/i\u003E. The desktop wallpaper is then set to the path of the bitmap and the dialog shown in Figure 6 is then displayed.\u003C\/p\u003E\n\u003Cp\u003EWhen the user clicks on the \u0026quot;Contact us\u0026quot; link, the malware sends the message to the Onion server using the following format:\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u0026lt;\u003Ci\u003E8 bytes from 00000000.res\u003C\/i\u003E\u0026gt;\u0026lt;\u003Ci\u003EHost name\u003C\/i\u003E\u0026gt;\\x00\u0026lt;\u003Ci\u003EUnknown Byte\u003C\/i\u003E\u0026gt;\u0026lt;\u003Ci\u003EUser name\u003C\/i\u003E\u0026gt;\\x00***\u0026lt;\u003Ci\u003ETab\u003C\/i\u003E\u0026gt;\u0026lt;\u003Ci\u003EMessage contents\u003C\/i\u003E\u0026gt;\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Cp\u003EDepending on the response from the server, the malware may display a message box with one of the following values:\u003C\/p\u003E\n\u003Col\u003E\n\u003Cli\u003EYour message has been sent successfully!\u003C\/li\u003E\n\u003Cli\u003EFailed to send your message!\u003Cbr\u003E\nPlease make sure that your computer is connected to the Internet and\u003Cbr\u003E\nyour Internet Service Provider (ISP) does not block connections to the TOR Network!\u003C\/li\u003E\n\u003Cli\u003EYou are sending too many mails! Please try again \u0026lt;Integer value\u0026gt; minutes later.\u003C\/li\u003E\n\u003C\/ol\u003E\n\u003Cp\u003EWhen the user clicks on \u0026quot;Check Payment\u0026quot;. The malware first check if the file \u003Ci\u003E00000000.dky\u003C\/i\u003E is present on the system. If the file is present, it attempts to verify the key by encrypting a file with the key obtained from \u003Ci\u003E00000000.pky\u003C\/i\u003E and decrypting it with the key obtained from \u003Ci\u003E00000000.dky\u003C\/i\u003E.\u003C\/p\u003E\n\u003Cp\u003EIf the file is not present, the malware sends the contents of \u003Ci\u003E00000000.eky\u003C\/i\u003E to the Onion server. The response from the server is saved to \u003Ci\u003E00000000.dky\u003C\/i\u003E. If the key cannot be validated, the malware displays a message box with the contents:\u003C\/p\u003E\n\u003Cp style=\u0022margin-left: 40px;\u0022\u003EYou did not pay or we did not confirmed your payment!\u003Cbr\u003E\nPay now if you didn\u0027t and check again after 2 hours.\u003Cbr\u003E\nBest time to check: 9:00am - 11:00am GMT from Monday to Friday.\u003C\/p\u003E\n\u003Cp\u003EWhen the decrypt button is clicked without the ransom being paid, the malware decrypts the files listed in \u003Ci\u003Ef.wnry\u003C\/i\u003E. The files listed in \u003Ci\u003Ef.wnry\u003C\/i\u003E are those randomly selected to be encrypted with the embedded public key. This process is covered in the Encryption component section above.\u003C\/p\u003E\n\u003Ch4\u003EUnique Strings\u003C\/h4\u003E\n\u003Ch5\u003Emssecsvc.exe\u003C\/h5\u003E\n\u003Cp\u003E(MD5: db349b97c37d22f5ea1d1841e3c89eb4)\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003ESMBr\u003C\/li\u003E\n\u003Cli\u003EPC NETWORK PROGRAM 1.0\u003C\/li\u003E\n\u003Cli\u003ELANMAN1.0\u003C\/li\u003E\n\u003Cli\u003EWindows for Workgroups 3.1a\u003C\/li\u003E\n\u003Cli\u003ELM1.2X002\u003C\/li\u003E\n\u003Cli\u003ELANMAN2.1\u003C\/li\u003E\n\u003Cli\u003ENT LM 0.12\u003C\/li\u003E\n\u003Cli\u003ESMBs\u003C\/li\u003E\n\u003Cli\u003EWindows 2000 2195\u003C\/li\u003E\n\u003Cli\u003EWindows 2000 5.0\u003C\/li\u003E\n\u003Cli\u003ESMBu\u003C\/li\u003E\n\u003Cli\u003E__USERID__PLACEHOLDER__@\u003C\/li\u003E\n\u003Cli\u003E\\\\172.16.99.5\\IPC$\u003C\/li\u003E\n\u003Cli\u003E__TREEID__PLACEHOLDER__\u003C\/li\u003E\n\u003Cli\u003E__USERID__PLACEHOLDER__@\u003C\/li\u003E\n\u003Cli\u003ESMB3\u003C\/li\u003E\n\u003Cli\u003E__TREEID__PLACEHOLDER__\u003C\/li\u003E\n\u003Cli\u003E__USERID__PLACEHOLDER__@\u003C\/li\u003E\n\u003Cli\u003E\\t\u003C\/li\u003E\n\u003Cli\u003Eh6agLCqPqVyXi2VSQ8O6Yb9ijBX54jY6KM+sz33NmS6TK8XlOk920s0E0aajOV++wrR92ds1FOLBO+evLPj4sIvAjLvaLdgk8+BlNZs8PMa9bQ33+0hNXMjbyjXwB40Q4KiDbip\/d7N0CmRT1gLy+n2Rp\/EYO5Fkapa4Y4kqDhPvLuOfGUvjN4BNdBk23r0\/8cbGhUqHrML0az1LCeE3BqKLCL3gP10fExyMnFGtbq3rBd+5eKxSXYVD4fBKtFYI47YYbjYxxF76O9LNZEpPP9SiCEo9qRYLDcYzGu81JRU7\/PJA1t1skDj8abBEOqAOXimo54\/eZzGmLJ92xLwDIl8rHuZsUywgeZH\/tSPXYQi0Pswy57TYZ\/0\/P7qyy18UVuiwGaf989u6seK2ER1R+aoJtvES8V0Zsx6slbdWrGxe4P62uwFxXStC\/+qpCauvw\/qpZvZo9wb458ezftwsbuOUYNlMWgBno\/C5cT5tZZvDw9cBmHGcaVuvs+JAbsWoEsUaZd3R3Mn\/1c1xYAumA\/0VVaASNuohaU+8CmGSpny9\/6ngCdejX4X\/\/JeRJeLSP1f2AtrbAR8jSk5UgNllJcWnf+EM\/Gyz\u003C\/li\u003E\n\u003Cli\u003Eh5DH0RqsyNfEbXNTxRzla1zNfWz0bB4fqzrdNNfNXvtTv9FWqyXCEHLhOz9p7JXzJBBUd0OR9rg8DFXIyNXMHCfeX5v\/YjDkYmaBrFWuOKpwLyotORDEi1GMahE7btGFTN2IMgml2b9wZvqSuc7aAciGNkl7+NgmkG9r323QqSJrjCgp+DJ9URAkHRp\/sBsr1o2YKlVmsY6mPAOnlmaEwFLrPTm5WIYnd0yOc3abTlt6R1RfwenXgqn5K1K6Uq5o7T+KblzWV1TXo0zTIBD\/CwnKbkITPd7GkK+fG\/\/5Oj2ESIrNTwBRdIGzDYcK1VTlSYl0RMsMMZvWqZAhNBs9xfpyBgzAn+5NpIUwKnm6HS2UbNab6SQIQF53r0+Rx8w7xZkOEayDuGvPQ32Y7zfHtj911mdZeLmlXULTazhCdl+lYNd6aoUthPLUew6ng+vSLSxqF1N7+\/bFkcWd5vuCPigEKxEg+X3d+JviOJaI9GJ2HWIT8ehFzv6JP7ymkH0XaHYKLPxR8Htcc2E35+8q074yiBdThfaOMI18K65supem5lEgTe2lQdQurhhNhgbmYPpmWsSerB8R4CiDHQg6B1xxN9lpUnCWCn37Ib9vdQ2V90almoOJi\/+5PD+F\/rT0hmgD1lUoqZ9KfEAB\/D3JVZFHKCPtFO1LWNuXu9DHS0cChPvbPTNgL1fuz3hWniAOjJxyXhilxEmUKoCuaHrjL7\/mCwA8mUTF8nZfDOYFw\/Rqr70SWFUVy18\u003C\/li\u003E\n\u003Cli\u003ESMB3\u003C\/li\u003E\n\u003Cli\u003E__TREEID__PLACEHOLDER__\u003C\/li\u003E\n\u003Cli\u003E__USERID__PLACEHOLDER__@\u003C\/li\u003E\n\u003Cli\u003Euserid\u003C\/li\u003E\n\u003Cli\u003Etreeid\u003C\/li\u003E\n\u003Cli\u003E__TREEPATH_REPLACE__\u003C\/li\u003E\n\u003Cli\u003E\\\\%s\\IPC$\u003C\/li\u003E\n\u003Cli\u003EMicrosoft Base Cryptographic Provider v1.0\u003C\/li\u003E\n\u003Cli\u003E%d.%d.%d.%d\u003C\/li\u003E\n\u003Cli\u003Emssecsvc2.0\u003C\/li\u003E\n\u003Cli\u003EMicrosoft Security Center (2.0) Service\u003C\/li\u003E\n\u003Cli\u003E%s -m security\u003C\/li\u003E\n\u003Cli\u003EC:\\%s\\qeriuwjhrf\u003C\/li\u003E\n\u003Cli\u003EC:\\%s\\%s\u003C\/li\u003E\n\u003Cli\u003EWINDOWS\u003C\/li\u003E\n\u003Cli\u003Etasksche.exe\u003C\/li\u003E\n\u003Cli\u003ECloseHandle\u003C\/li\u003E\n\u003Cli\u003EWriteFile\u003C\/li\u003E\n\u003Cli\u003ECreateFileA\u003C\/li\u003E\n\u003Cli\u003ECreateProcessA\u003C\/li\u003E\n\u003Cli\u003E32.dll\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003Etasksche.exe\u003C\/h5\u003E\n\u003Cp\u003E(MD5: 84c82835a5d21bbcf75a61706d8ab549)\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003E.der .pfx .key .crt .csr .p12 .pem .odt .ott .sxw .stw .uot .3ds .max .3dm .ods .ots .sxc .stc .dif .slk .wb2 .odp .otp .sxd .std .uop .odg .otg .sxm .mml .lay .lay6 .asc .sqlite3 .sqlitedb .sql .accdb .mdb .db .dbf .odb .frm .myd .myi .ibd .mdf .ldf .sln .suo .cs .c .cpp .pas .h .asm .js .cmd .bat .ps1 .vbs .vb .pl .dip .dch .sch .brd .jsp .php .asp .rb .java .jar .class .sh .mp3 .wav .swf .fla .wmv .mpg .vob .mpeg .asf .avi .mov .mp4 .3gp .mkv .3g2 .flv .wma .mid .m3u .m4u .djvu .svg .ai .psd .nef .tiff .tif .cgm .raw .gif .png .bmp .jpg .jpeg .vcd .iso .backup .zip .rar .7z .gz .tgz .tar .bak .tbk .bz2 .PAQ .ARC .aes .gpg .vmx .vmdk .vdi .sldm .sldx .sti .sxi .602 .hwp .snt .onetoc2 .dwg .pdf .wk1 .wks .123 .rtf .csv .txt .vsdx .vsd .edb .eml .msg .ost .pst .potm .potx .ppam .ppsx .ppsm .pps .pot .pptm .pptx .ppt .xltm .xltx .xlc .xlm .xlt .xlw .xlsb .xlsm .xlsx .xls .dotx .dotm .dot .docm .docb .docx .doc\u003C\/li\u003E\n\u003Cli\u003EWANACRY!\u003C\/li\u003E\n\u003Cli\u003E%s\\\\%s\u003C\/li\u003E\n\u003Cli\u003E%s\\\\Intel\u003C\/li\u003E\n\u003Cli\u003E%s\\\\ProgramData\u003C\/li\u003E\n\u003Cli\u003Ecmd.exe \/c \\\u0026quot;%s\\\u0026quot;\u003C\/li\u003E\n\u003Cli\u003EXIA\u003C\/li\u003E\n\u003Cli\u003E115p7UMMngoj1pMvkpHijcRdfJNXj6LrLn\u003C\/li\u003E\n\u003Cli\u003E12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw\u003C\/li\u003E\n\u003Cli\u003E13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\u003C\/li\u003E\n\u003Cli\u003E%s%d\u003C\/li\u003E\n\u003Cli\u003EGlobal\\\\MsWinZonesCacheCounterMutexA\u003C\/li\u003E\n\u003Cli\u003Etasksche.exe\u003C\/li\u003E\n\u003Cli\u003ETaskStart\u003C\/li\u003E\n\u003Cli\u003Et.wnry\u003C\/li\u003E\n\u003Cli\u003Eicacls . \/grant Everyone:F \/T \/C \/Q\u003C\/li\u003E\n\u003Cli\u003Eattrib +h .\u003C\/li\u003E\n\u003Cli\u003EWNcry@2ol7\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EEncryptor\u003C\/h5\u003E\n\u003Cp\u003E(MD5: f351e1fcca0c4ea05fc44d15a17f8b36)\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003Ekgptbeilcq\u003C\/li\u003E\n\u003Cli\u003ETaskStart\u003C\/li\u003E\n\u003Cli\u003Ec.wnry\u003C\/li\u003E\n\u003Cli\u003E%s\u003C\/li\u003E\n\u003Cli\u003Edel \/a %%0\u003C\/li\u003E\n\u003Cli\u003E%d%d.bat\u003C\/li\u003E\n\u003Cli\u003EConvertSidToStringSidW\u003C\/li\u003E\n\u003Cli\u003Eadvapi32.dll\u003C\/li\u003E\n\u003Cli\u003ESYSTEM\u003C\/li\u003E\n\u003Cli\u003ES-1-5-18\u003C\/li\u003E\n\u003Cli\u003EEVERYONE\u003C\/li\u003E\n\u003Cli\u003E%s\\%d%s\u003C\/li\u003E\n\u003Cli\u003E.WNCRYT\u003C\/li\u003E\n\u003Cli\u003EWANACRY!\u003C\/li\u003E\n\u003Cli\u003E.WNCRY\u003C\/li\u003E\n\u003Cli\u003E.WNCYR\u003C\/li\u003E\n\u003Cli\u003E\\\\\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.bmp\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.exe.lnk\u003C\/li\u003E\n\u003Cli\u003E@Please_Read_Me@.txt\u003C\/li\u003E\n\u003Cli\u003E%s\\%s\u003C\/li\u003E\n\u003Cli\u003E..\u003C\/li\u003E\n\u003Cli\u003E%s\\*\u003C\/li\u003E\n\u003Cli\u003E.dll\u003C\/li\u003E\n\u003Cli\u003E.exe\u003C\/li\u003E\n\u003Cli\u003E~SD\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.exe\u003C\/li\u003E\n\u003Cli\u003EContent.IE5\u003C\/li\u003E\n\u003Cli\u003ETemporary Internet Files\u003C\/li\u003E\n\u003Cli\u003EThis folder protects against ransomware. Modifying it will reduce protection\u003C\/li\u003E\n\u003Cli\u003E\\Local Settings\\Temp\u003C\/li\u003E\n\u003Cli\u003E\\AppData\\Local\\Temp\u003C\/li\u003E\n\u003Cli\u003E\\Program Files (x86)\u003C\/li\u003E\n\u003Cli\u003E\\Program Files\u003C\/li\u003E\n\u003Cli\u003E\\WINDOWS\u003C\/li\u003E\n\u003Cli\u003E\\ProgramData\u003C\/li\u003E\n\u003Cli\u003E\\Intel\u003C\/li\u003E\n\u003Cli\u003E$\\\u003C\/li\u003E\n\u003Cli\u003ETESTDATA\u003C\/li\u003E\n\u003Cli\u003E%08X.dky\u003C\/li\u003E\n\u003Cli\u003EGlobal\\MsWinZonesCacheCounterMutexA\u003C\/li\u003E\n\u003Cli\u003EGlobal\\MsWinZonesCacheCounterMutexW\u003C\/li\u003E\n\u003Cli\u003Ecmd.exe \/c reg add %s \/v \u0026quot;%s\u0026quot; \/t REG_SZ \/d \u0026quot;\\\u0026quot;%s\\\u0026quot;\u0026quot; \/f\u003C\/li\u003E\n\u003Cli\u003EHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\u003C\/li\u003E\n\u003Cli\u003E%s %s\u003C\/li\u003E\n\u003Cli\u003Etaskse.exe\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.exe\u003C\/li\u003E\n\u003Cli\u003Etasksche.exe\u003C\/li\u003E\n\u003Cli\u003E%s\\%s\\%s\u003C\/li\u003E\n\u003Cli\u003E%s\\*.*\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.exe.lnk\u003C\/li\u003E\n\u003Cli\u003E@echo off\u003C\/li\u003E\n\u003Cli\u003Eecho SET ow = WScript.CreateObject(\u0026quot;WScript.Shell\u0026quot;)\u0026gt; m.vbs\u003C\/li\u003E\n\u003Cli\u003Eecho SET om = ow.CreateShortcut(\u0026quot;%s%s\u0026quot;)\u0026gt;\u0026gt; m.vbs\u003C\/li\u003E\n\u003Cli\u003Eecho om.TargetPath = \u0026quot;%s%s\u0026quot;\u0026gt;\u0026gt; m.vbs\u003C\/li\u003E\n\u003Cli\u003Eecho om.Save\u0026gt;\u0026gt; m.vbs\u003C\/li\u003E\n\u003Cli\u003Ecscript.exe \/\/nologo m.vbs\u003C\/li\u003E\n\u003Cli\u003Edel m.vbs\u003C\/li\u003E\n\u003Cli\u003Eu.wnry\u003C\/li\u003E\n\u003Cli\u003E%.1f BTC\u003C\/li\u003E\n\u003Cli\u003E$%d worth of bitcoin\u003C\/li\u003E\n\u003Cli\u003Ewb\u003C\/li\u003E\n\u003Cli\u003Er.wnry\u003C\/li\u003E\n\u003Cli\u003Eb.wnry\u003C\/li\u003E\n\u003Cli\u003Eattrib +h +s %C:\\%s\u003C\/li\u003E\n\u003Cli\u003E$RECYCLE\u003C\/li\u003E\n\u003Cli\u003E%C:\\%s\u003C\/li\u003E\n\u003Cli\u003E$RECYCLE\u003C\/li\u003E\n\u003Cli\u003E%s\\hibsys%s\u003C\/li\u003E\n\u003Cli\u003Etaskdl.exe\u003C\/li\u003E\n\u003Cli\u003Ef.wnry\u003C\/li\u003E\n\u003Cli\u003Ecmd.exe \/c start \/b %s vs\u003C\/li\u003E\n\u003Cli\u003E%s co\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im mysqld.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im sqlwriter.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im sqlserver.exe\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im MSExchange*\u003C\/li\u003E\n\u003Cli\u003Etaskkill.exe \/f \/im Microsoft.Exchange.*\u003C\/li\u003E\n\u003Cli\u003E%s fi\u003C\/li\u003E\n\u003Cli\u003E%08X.eky\u003C\/li\u003E\n\u003Cli\u003E%08X.pky\u003C\/li\u003E\n\u003Cli\u003E%08X.res\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch5\u003EDecryptor\u003C\/h5\u003E\n\u003Cp\u003E(MD5: 7bf2b57f2a205768755c07f238fb32cc)\u003C\/p\u003E\n\u003Cul\u003E\n\u003Cli\u003EConnecting to server...\u003C\/li\u003E\n\u003Cli\u003Es.wnry\u003C\/li\u003E\n\u003Cli\u003E%08X.eky\u003C\/li\u003E\n\u003Cli\u003E%08X.res\u003C\/li\u003E\n\u003Cli\u003E00000000.res\u003C\/li\u003E\n\u003Cli\u003E%08X.dky\u003C\/li\u003E\n\u003Cli\u003E%08X.pky\u003C\/li\u003E\n\u003Cli\u003EConnected\u003C\/li\u003E\n\u003Cli\u003ESent request\u003C\/li\u003E\n\u003Cli\u003ESucceed\u003C\/li\u003E\n\u003Cli\u003EReceived response\u003C\/li\u003E\n\u003Cli\u003ECongratulations! Your payment has been checked!\u003C\/li\u003E\n\u003Cli\u003EStart decrypting now!\u003C\/li\u003E\n\u003Cli\u003EFailed to check your payment!\u003C\/li\u003E\n\u003Cli\u003EPlease make sure that your computer is connected to the Internet and\u003C\/li\u003E\n\u003Cli\u003Eyour Internet Service Provider (ISP) does not block connections to the TOR Network!\u003C\/li\u003E\n\u003Cli\u003EYou did not pay or we did not confirmed your payment!\u003C\/li\u003E\n\u003Cli\u003EPay now if you didn\u0027t and check again after 2 hours.\u003C\/li\u003E\n\u003Cli\u003EBest time to check: 9:00am - 11:00am GMT from Monday to Friday.\u003C\/li\u003E\n\u003Cli\u003EYou have a new message:\u003C\/li\u003E\n\u003Cli\u003Ec.wnry\u003C\/li\u003E\n\u003Cli\u003Erunas\u003C\/li\u003E\n\u003Cli\u003EWanaCrypt0r\u003C\/li\u003E\n\u003Cli\u003ESoftware\\\u003C\/li\u003E\n\u003Cli\u003E%04d-%02d-%02d %02d:%02d:%02d\u003C\/li\u003E\n\u003Cli\u003EWANACRY!\u003C\/li\u003E\n\u003Cli\u003E.org\u003C\/li\u003E\n\u003Cli\u003E.WNCYR\u003C\/li\u003E\n\u003Cli\u003E.WNCRY\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.bmp\u003C\/li\u003E\n\u003Cli\u003E@WanaDecryptor@.exe.lnk\u003C\/li\u003E\n\u003Cli\u003E@Please_Read_Me@.txt\u003C\/li\u003E\n\u003Cli\u003E%s\\%s\u003C\/li\u003E\n\u003Cli\u003E..\u003C\/li\u003E\n\u003Cli\u003E%s\\*\u003C\/li\u003E\n\u003Cli\u003EContent.IE5\u003C\/li\u003E\n\u003Cli\u003ETemporary Internet Files\u003C\/li\u003E\n\u003Cli\u003EThis folder protects against ransomware. Modifying it will reduce protection\u003C\/li\u003E\n\u003Cli\u003E\\Local Settings\\Temp\u003C\/li\u003E\n\u003Cli\u003EppData\\Local\\Temp\u003C\/li\u003E\n\u003Cli\u003E\\Program Files (x86)\u003C\/li\u003E\n\u003Cli\u003E\\Program Files\u003C\/li\u003E\n\u003Cli\u003E\\WINDOWS\u003C\/li\u003E\n\u003Cli\u003E\\ProgramData\u003C\/li\u003E\n\u003Cli\u003E\\Intel\u003C\/li\u003E\n\u003Cli\u003EPlease select a host to decrypt.\u003C\/li\u003E\n\u003Cli\u003EAll your files have been decrypted!\u003C\/li\u003E\n\u003Cli\u003EPay now, if you want to decrypt ALL your files!\u003C\/li\u003E\n\u003Cli\u003Ef.wnry\u003C\/li\u003E\n\u003Cli\u003EMy Computer\u003C\/li\u003E\n\u003Cli\u003E*.res\u003C\/li\u003E\n\u003Cli\u003Eopen\u003C\/li\u003E\n\u003Cli\u003Emailto:\u003C\/li\u003E\n\u003Cli\u003EWana Decrypt0r 2.0\u003C\/li\u003E\n\u003Cli\u003E%s %s\u003C\/li\u003E\n\u003Cli\u003Ecmd.exe\u003C\/li\u003E\n\u003Cli\u003E\/c vssadmin delete shadows \/all \/quiet \u0026amp; wmic shadowcopy delete \u0026amp; bcdedit \/set {default} bootstatuspolicy ignoreallfailures \u0026amp; bcdedit \/set {default} recoveryenabled no \u0026amp; wbadmin delete catalog -quiet\u003C\/li\u003E\n\u003Cli\u003E13AM4VW2dhxYgXeQepoHkHSQuy6NgaEb94\u003C\/li\u003E\n\u003Cli\u003EEnglish\u003C\/li\u003E\n\u003Cli\u003Em_%s.wnry\u003C\/li\u003E\n\u003Cli\u003Emsg\\\u003C\/li\u003E\n\u003Cli\u003E\u0026lt;https:\/\/\u003C\/li\u003E\n\u003Cli\u003E\u0026lt;http:\/\/\u003C\/li\u003E\n\u003Cli\u003E%d\/%d\/%d %02d:%02d:%02d\u003C\/li\u003E\n\u003Cli\u003E00;00;00;00\u003C\/li\u003E\n\u003Cli\u003Ehttp:\/\/www.btcfrog.com\/qr\/bitcoinPNG.php?address=%s\u003C\/li\u003E\n\u003Cli\u003Emailto:%s\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/www.google.com\/search?q=how+to+buy+bitcoin\u003C\/li\u003E\n\u003Cli\u003Ehttps:\/\/en.wikipedia.org\/wiki\/Bitcoin\u003C\/li\u003E\n\u003Cli\u003ESend %.1f BTC to this address:\u003C\/li\u003E\n\u003Cli\u003E%.1f BTC\u003C\/li\u003E\n\u003Cli\u003ESend $%d worth of bitcoin to this address:\u003C\/li\u003E\n\u003Cli\u003E%02d;%02d;%02d;%02d\u003C\/li\u003E\n\u003Cli\u003Eb.wnry\u003C\/li\u003E\n\u003Cli\u003E---\u0026nbsp;\u0026nbsp;\u0026nbsp; %s\u0026nbsp;\u0026nbsp;\u0026nbsp; %s\u0026nbsp;\u0026nbsp;\u0026nbsp; %d\u0026nbsp;\u0026nbsp;\u0026nbsp; %I64d\u0026nbsp;\u0026nbsp;\u0026nbsp; %d\u003C\/li\u003E\n\u003Cli\u003EFailed to send your message!\u003C\/li\u003E\n\u003Cli\u003EPlease make sure that your computer is connected to the Internet and\u003C\/li\u003E\n\u003Cli\u003Eyour Internet Service Provider (ISP) does not block connections to the TOR Network!\u003C\/li\u003E\n\u003Cli\u003EYour message has been sent successfully!\u003C\/li\u003E\n\u003Cli\u003EYou are sending too many mails! Please try again %d minutes later.\u003C\/li\u003E\n\u003Cli\u003EToo short message!\u003C\/li\u003E\n\u003Cli\u003E%d%%\u003C\/li\u003E\n\u003Cli\u003E%s\\%s\u003C\/li\u003E\n\u003Cli\u003Etor.exe\u003C\/li\u003E\n\u003Cli\u003E%s\\%s\\%s\u003C\/li\u003E\n\u003Cli\u003ETaskData\u003C\/li\u003E\n\u003Cli\u003Etaskhsvc.exe\u003C\/li\u003E\n\u003Cli\u003E127.0.0.1\u003C\/li\u003E\n\u003C\/ul\u003E\n\u003Ch3\u003EAppendix A\u003C\/h3\u003E\n\u003Ch4\u003EObserved Killswitch Domains\u003C\/h4\u003E\n\u003Cp\u003EThe following table contains observed killswitch domains and their associated sample hash.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022264\u0022\u003E\u003Cp\u003E\u003Cb\u003EDomain\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022215\u0022\u003E\u003Cp\u003E\u003Cb\u003EAssociated Sample MD5 Hash\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022264\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eiuqssfsodp9ifjaposdfjhgosurijfaewrwergwea.com\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022215\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ec2559b51cfd37bdbd5fdb978061c6c16\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022264\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eayylmaotjhsstasdfasdfasdfasdfasdfasdfasdf.com (This domain matches the format of WannaCry-associated domains, but has not yet been clearly linked to a specific sample. Organizations wish to maintain awareness of this domain in the event that it is associated with WannaCry activity.)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022215\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Ea44964a7be94072cdfe085bc43e7dc95\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022264\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eifferfsodp9ifjaposdfjhgosurijfaewrwergwea.com\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022215\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E80ce983d22c6213f35867053bec1c293\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022264\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eiuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022215\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Edb349b97c37d22f5ea1d1841e3c89eb4\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022264\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003Eiuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.test\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022215\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E96dff36b5275c67e35097d77a120d0d4\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Ch3\u003EAppendix B\u003C\/h3\u003E\n\u003Ch4\u003EYara Rules\u003C\/h4\u003E\n\u003Cp\u003EFireEye has developed the following Yara rules for WannaCry detection:\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022600\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Erule FE_RANSOMWARE_WANNACRY {\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; meta:version=\u0026quot;.4\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; filetype=\u0026quot;PE\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; author=\u0026quot;Ian.Ahl@fireeye.com @TekDefense\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; date=\u0026quot;2017-05-12\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; description=\u0026quot;Generic detection for most WannaCry variants\u0026quot;\u003Cbr\u003E\n strings:\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \/\/ Bitcoin URLs\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $bcURL1 = \u0026quot;http:\/\/www.btcfrog.com\/qr\/bitcoinPNG.php?address=%\u0026quot; ascii wide nocase\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $bcURL2 = \u0026quot;https:\/\/www.google.com\/search?q=how+to+buy+bitcoin\u0026quot; ascii wide nocase\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; \/\/ Ransom Message\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $msg1 = \u0026quot;Congratulations! Succeed to check your payment!\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $msg2 = \u0026quot;Start decrypting now!\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $msg3 = \u0026quot;All your files have been decrypted!\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $msg4 = \u0026quot;Pay now, if you want to decrypt ALL your files!\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $msg5 = \u0026quot;Send $%d worth of bitcoin to this address:\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $msg6 = \u0026quot;Ooops, your files have been encrypted!\u0026quot; ascii wide\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; \/\/ WANNA Strings\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna1 = \u0026quot;Wanna Decryptor 1.0\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna2 = \u0026quot;Wana Decrypt0r\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna3 = \u0026quot;Wana Decryptor\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna4 = \u0026quot;WANNACRY\u0026quot; ascii wide nocase\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna5 = \u0026quot;WanaCrypt0r\u0026quot; ascii wide nocase\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna6 = \u0026quot;WANACRY!\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna7 = \u0026quot;WNcry@2ol7\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna8 = \u0026quot;wcry@123\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $wanna9 = \u0026quot;wcry@2016\u0026quot;\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; \/\/ File references\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $fileA1 = \u0026quot;!WannaCryptor!.bmp\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $fileA2 = \u0026quot;!WannaDecryptor!.exe.lnk\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $fileA3 = \u0026quot;!Please Read Me!.txt\u0026quot; ascii wide\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; $fileB1 = \u0026quot;@WanaDecryptor@.bmp\u0026quot; ascii wide\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $fileB2 = \u0026quot;@WanaDecryptor@.exe.lnk\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $fileB3 = \u0026quot;@Please_Read_Me@.txt\u0026quot; ascii wide\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; \/\/ CMDS\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $cmd1 = \u0026quot;cmd.exe \/c start \/b vssadmin.exe Delete Shadows \/All \/Quiet\u0026quot; ascii wide nocase\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $cmd2 = \u0026quot;wmic shadowcopy delete\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $cmd3 = \u0026quot;bcdedit \/set {default} bootstatuspolicy ignoreallfailures\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $cmd4 = \u0026quot;bcdedit \/set {default} recoveryenabled no\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $cmd5 = \u0026quot;wbadmin delete catalog -quiet\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $cmd6 = \u0026quot;icacls . \/grant Everyone:F \/T \/C \/Q\u0026quot; ascii wide\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; \/\/ MISC\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $misc1 = \u0026quot;StartTask\u0026quot; wide ascii\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $misc2 = \u0026quot;b.wry\u0026quot; wide ascii\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $misc3 = \u0026quot;c.wry\u0026quot; wide ascii\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $misc4 = \u0026quot;m.wry\u0026quot; wide ascii\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $misc5 = \u0026quot;inflate 1.1.3 Copyright 1995-1998 Mark Adler\u0026quot; wide ascii\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $misc6 = \u0026quot;?AVtype_info@@\u0026quot; wide ascii\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Econdition:\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (uint16(0) == 0x5A4D)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; and\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; all of ($fileA*)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; all of ($fileB*)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (4 of ($msg*) and 2 of ($bcURL*))\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 2 of ($wanna*)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (2 of ($msg*) and 1 of ($cmd*))\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; 4 of ($cmd*)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (1 of ($wanna*) and 1 of ($cmd*))\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; or\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (1 of ($wanna*) and 3 of ($misc*))\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n }\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022600\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Erule FE_RANSOMWARE_WANNACRY_EB {\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;meta:version=\u0026quot;.1\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;filetype=\u0026quot;PE\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;author=\u0026quot;Ian.Ahl@fireeye.com @TekDefense\u0026quot;\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;date=\u0026quot;2017-05-12\u0026quot;\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp;description=\u0026quot;Focusing on the WannaCry variants with worm capabilities\u0026quot;\u003Cbr\u003E\n strings:\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \/\/ EB related strings in WANNACRY\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb1 = \u0026quot;__USERID__PLACEHOLDER__@\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb2 = \u0026quot;__TREEID__PLACEHOLDER__\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb3 = \u0026quot;LANMAN1.0\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb4 = \u0026quot;LANMAN2.1\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb5 = \u0026quot;\\\\PIPE\\\\\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb6 = \u0026quot;\\\\\\\\%s\\\\IPC$\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb7 = \u0026quot;__TREEPATH_REPLACE__\u0026quot; ascii wide\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; $eb8 = \u0026quot;\/K__USERID__PLACEHOLDER__\u0026quot; ascii wide\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Econdition:\u003Cbr\u003E\n \u003C\/span\u003E\u003Cspan style=\u0022background-color: rgb(255, 255, 255); font-family: \u0026quot;Courier New\u0026quot;, Courier, monospace;\u0022\u003E\u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (uint16(0) == 0x5A4D)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; and\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; (\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; all of ($eb*)\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; \u0026nbsp; )\u003Cbr\u003E\n }\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u0026nbsp;\u003C\/p\u003E\n",
        "jcr:lastModified": "Tue May 23 2017 14:41:39 GMT-0400",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "alt": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "comments": {
        "jcr:primaryType": "nt:unstructured",
        "sling:resourceType": "social\/commons\/components\/comments"
      },
      "trackback": {
        "jcr:primaryType": "nt:unstructured",
        "sling:resourceType": "social\/blog\/components\/trackback"
      }
    },
    "image": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "jcr:lastModified": "Tue May 23 2017 13:20:47 GMT-0400",
      "imageRotate": "0"
    },
    "summary": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "text": "\u003Cp\u003ESee our full WannaCry (also known as WCry or WanaCryptor) malware profile, including in-depth file characteristics and MD5 hashes.\u003C\/p\u003E\n",
      "jcr:lastModified": "Fri Sep 07 2018 16:49:00 GMT-0400",
      "sling:resourceType": "social\/blog\/components\/entrytextteaser"
    }
  }
}
