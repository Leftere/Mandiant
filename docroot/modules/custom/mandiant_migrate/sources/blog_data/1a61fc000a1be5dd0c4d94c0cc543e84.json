{
  "jcr:primaryType": "cq:Page",
  "jcr:createdBy": "fireeye_global_admin",
  "jcr:created": "Thu May 14 2020 14:52:37 GMT+0000",
  "jcr:content": {
    "jcr:primaryType": "cq:PageContent",
    "jcr:mixinTypes": [
      "mix:versionable"
    ],
    "jcr:createdBy": "fireeye_global_admin",
    "jcr:title": "Using Real-Time Events in Investigations",
    "jcr:versionHistory": "1498c969-d62c-4f25-bf88-1c3515e46c62",
    "author": "Daniel Pany",
    "cq:template": "\/apps\/fireeye-blog\/templates\/page_blogpost",
    "jcr:language": "en_us",
    "jcr:predecessors": [
      "a27e623f-0d92-48c0-a86f-6741d703857c"
    ],
    "jcr:created": "Fri Jul 24 2020 06:54:52 GMT+0000",
    "cq:lastModified": "Fri Jul 24 2020 06:54:28 GMT+0000",
    "jcr:baseVersion": "a27e623f-0d92-48c0-a86f-6741d703857c",
    "jcr:isCheckedOut": true,
    "cq:tags": [
      "fireeye-blog-authors:daniel-pany",
      "fireeye-blog-threat-research:threat-research",
      "fireeye-blog-tags:homepage-carousel",
      "fireeye-blog-tags:investigation",
      "fireeye-blog-tags:endpoint-security",
      "fireeye-blog-tags:incident-response",
      "fireeye-blog-tags:latest",
      "fireeye-blog-tags:mandiant",
      "fireeye-blog-tags:redline"
    ],
    "jcr:uuid": "2ef9b6bc-4e48-499e-bc70-b2391ee85fd5",
    "sling:resourceType": "social\/blog\/components\/page",
    "published": "Thu May 14 2020 11:00:00 GMT-0400",
    "cq:lastModifiedBy": "reference-adjustment-service",
    "par": {
      "jcr:primaryType": "nt:unstructured",
      "sling:resourceType": "foundation\/components\/parsys",
      "entry": {
        "jcr:primaryType": "nt:unstructured",
        "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
        "text": "\u003Cp\u003ETo understand what a threat actor did on a Windows system, analysts often turn to the tried and true sources of historical endpoint artifacts such as the Master File Table (MFT), registry hives, and Application Compatibility Cache (AppCompat). However, these evidence sources were not designed with detection or incident response in mind; crucial details may be omitted or cleared through anti-forensic methods. By looking at historical evidence alone, an analyst may not see the full story.\u003C\/p\u003E\n\u003Cp\u003EReal-time events can be thought of as forensic artifacts specifically designed for detection and incident response, implemented through Enterprise Detection and Response (EDR) solutions or enhanced logging implementations like \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/docs.microsoft.com\/en-us\/sysinternals\/downloads\/sysmon\u0022\u003ESysmon\u003C\/a\u003E. During active-attacker endpoint investigations, \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/services.html\u0022\u003EFireEye Mandiant\u003C\/a\u003E has found real-time events to be useful in filling in the gaps of what an attacker did. These events record different types of system activities such as process execution, file write activity, network connections, and more.\u003C\/p\u003E\n\u003Cp\u003EDuring incident response engagements, Mandiant uses \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/products\/endpoint-security.html\u0022\u003EFireEye Endpoint Security\u003C\/a\u003E to track endpoint system events in real-time. This feature allows investigators to track an attacker on any system by alerting on and reviewing these real-time events. An analyst can use our solution\u2019s built-in Audit Viewer or Redline to review real-time events.\u003C\/p\u003E\n\u003Cp\u003ELet\u2019s look at some examples of Windows real-time events available on our solution and how they can be leveraged during an investigation. Let\u2019s assume the account \u003Cspan class=\u0022code\u0022\u003ETEST-DOMAIN\\BackupAdmin\u003C\/span\u003E was an inactive Administrator account compromised by an attacker. Please note the examples provided in this post are based on real-time events observed during engagements but have been recreated or altered to preserve client confidentiality.\u003C\/p\u003E\n\u003Ch4\u003EProcess Execution Events\u003C\/h4\u003E\n\u003Cp\u003EThere are many historical process execution artifacts including \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2017\/04\/appcompatprocessor.html\u0022\u003EAppCompat\u003C\/a\u003E, \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2015\/06\/caching_out_the_val.html\u0022\u003EAmCache\u003C\/a\u003E, \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2016\/12\/do_you_see_what_icc.html\u0022\u003EWMI CCM_RecentlyUsedApps\u003C\/a\u003E, and \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/blog\/threat-research\/2013\/08\/execute.html\u0022\u003Emore\u003C\/a\u003E. A single artifact rarely covers all the useful details relating to a process\u0027s execution, but real-time process execution events change that. Our solution\u2019s real-time process execution events record execution time, full process path, process identification number (PID), parent process path, parent PID, user, command line arguments, and even the process MD5 hash.\u003C\/p\u003E\n\u003Cp\u003ETable 1 provides an example of a real-time process execution event recorded by our solution.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ETimestamp (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:40:58.235\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESequence Number\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2879512\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPID\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E9392\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProcess Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUsername\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETEST-DOMAIN\\BackupAdmin\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EParent PID\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E9103\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EParent Process Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\System32\\cmd.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEventType\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EStart\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProcessCmdLine\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026quot;C:\\Windows\\Temp\\legitservice.exe\u0026quot;\u0026nbsp; -b -m\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProcess MD5 Hash\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003Ea823bc31395539816e8e4664e884550f\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 1: Example real-time process execution event\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EBased on this real-time process execution event, the process \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\System32\\cmd.exe\u003C\/span\u003E with PID 9103 executed the file \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E with PID 9392 and the MD5 hash \u003Cspan class=\u0022code\u0022\u003Ea823bc31395539816e8e4664e884550f\u003C\/span\u003E. This new process used the command line arguments \u003Cspan class=\u0022code\u0022\u003E-b\u003C\/span\u003E \u003Cspan class=\u0022code\u0022\u003E-m\u003C\/span\u003E under the user context of \u003Cspan class=\u0022code\u0022\u003ETEST-DOMAIN\\BackupAdmin\u003C\/span\u003E.\u003C\/p\u003E\n\u003Cp\u003EWe can compare this real-time event with what an analyst might see in other process execution artifacts. Table 2 provides an example AppCompat entry for the same executed process. Note the recorded timestamp is for the last modified time of the file, not the process start time.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile Last\u003Cbr\u003E\nModified (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-07 23:48:09\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EExecuted Flag\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETRUE\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 2: Example AppCompat entry\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003ETable 3 provides an example AmCache entry. Note the last modified time of the registry key can usually be used to determine the process start time and this artifact includes the SHA1 hash of the file.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ERegistry Key\u003Cbr\u003E\nLast Modified (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:40:58\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022150\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile Sha1 Hash\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022474\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2b2e04ab822ef34969b7d04642bae47385be425c\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 3: Example AmCache entry\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003ETable 4 provides an example Windows Event Log process creation event. Note this artifact includes the PID in hexadecimal notation, details about the parent process, and even a field for where the process command line arguments should be. In this example the command line arguments are not present because they are \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/docs.microsoft.com\/en-us\/windows\/security\/threat-protection\/auditing\/event-4688\u0022\u003Edisabled by default\u003C\/a\u003E\u0026nbsp;and Mandiant rarely sees this policy enabled by clients on investigations.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 width=\u0022750\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022534\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EWrite Time (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022534\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:40:58\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ELog\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022534\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ESecurity\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESource\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022534\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EMicrosoft Windows security\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEID\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022534\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E4688\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u002290\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EMessage\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022534\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EA new process has been created.\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ECreator Subject:\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Security ID:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; TEST-DOMAIN\\BackupAdmin\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Account Name:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; BackupAdmin\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Account Domain:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; TEST-DOMAIN\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Logon ID:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; 0x6D6AD\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETarget Subject:\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Security ID:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; NULL SID\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Account Name:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; -\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Account Domain:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; -\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Logon ID:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; 0x0\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EProcess Information:\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; New Process ID:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; 0x24b0\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; New Process Name:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; C:\\Windows\\Temp\\legitservice.exe\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Token Elevation Type:\u0026nbsp; \u0026nbsp; %%1938\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Mandatory Label:\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp;\u0026nbsp; Mandatory Label\\Medium Mandatory Level\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Creator Process ID:\u0026nbsp; \u0026nbsp; \u0026nbsp; 0x238f\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Creator Process Name:\u0026nbsp; \u0026nbsp; C:\\Windows\\System32\\cmd.exe\u003Cbr\u003E\n \u0026nbsp; \u0026nbsp; \u0026nbsp; Process Command Line:\u0026nbsp; \u0026nbsp;\u0026nbsp;\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 4: Example Windows event log process creation event\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EIf we combine the evidence available in AmCache with a fully detailed Windows Event Log process creation event, we could match the evidence available in the real-time event except for a small difference in file hash types.\u003C\/p\u003E\n\u003Ch4\u003EFile Write Events\u003C\/h4\u003E\n\u003Cp\u003EAn attacker may choose to modify or delete important evidence. If an attacker uses a file shredding tool like Sysinternal\u2019s SDelete, it is unlikely the analyst will recover the original contents of the file. Our solution\u2019s real-time file write events are incredibly useful in situations like this because they record the MD5 hash of the files written and partial contents of the file. File write events also record which process created or modified the file in question.\u003C\/p\u003E\n\u003Cp\u003ETable 5 provides an example of a real-time file write event recorded by our solution.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ETimestamp (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:42:59.956\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESequence Number\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2884312\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPID\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E9392\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProcess Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUsername\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETEST-DOMAIN\\BackupAdmin\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EDevice Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\\Device\\HarddiskVolume2\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\WindowsServiceNT.log\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EFile MD5 Hash\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E30a82a8a864b6407baf9955822ded8f9\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ENum Bytes Seen Written\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E8\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESize\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E658\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EWrites\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E4\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEvent reason\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EFile closed\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EClosed\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETRUE\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EBase64 Encoded\u003Cbr\u003E\nData At Lowest Offset\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EQ3JlYXRpbmcgJ1dpbmRvd3NTZXJ2aWNlTlQubG9nJy\u003Cbr\u003E\n Bsb2dmaWxlIDogT0sNCm1pbWlrYXR6KGNvbW1hbmQ\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022162\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EText At Lowest Offset\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022462\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ECreating \u0027WindowsServiceNT.log\u0027 logfile : OK....mimikatz(command\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 5: Example real-time file write event\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EBased on this real-time file write event, the malicious executable \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E wrote the file \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\WindowsServiceNT.log\u003C\/span\u003E to disk with the MD5 hash \u003Cspan class=\u0022code\u0022\u003E30a82a8a864b6407baf9955822ded8f9\u003C\/span\u003E. Since the real-time event recorded the beginning of the written file, we can determine the file likely contained Mimikatz credential harvester output which Mandiant has observed commonly starts with \u003Cspan class=\u0022code\u0022\u003EOK....mimikatz\u003C\/span\u003E.\u003C\/p\u003E\n\u003Cp\u003EIf we investigate a little later, we\u2019ll see a process creation event for \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\taskassist.exe\u003C\/span\u003E with the MD5 file hash \u003Cspan class=\u0022code\u0022\u003E2b5cb081721b8ba454713119be062491\u003C\/span\u003E followed by several file write events for this process summarized in Table 6.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022 width=\u0022750\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003ETimestamp\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EFile Path\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EFile Size\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.351\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\WindowsServiceNT.log\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.351\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\AAAAAAAAAAAAAAAA.AAA\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.351\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\BBBBBBBBBBBBBBBB.BBB\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.351\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\CCCCCCCCCCCCCCCC.CCC\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u2026\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E\u0026nbsp;\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.382\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\XXXXXXXXXXXXXXXX.XXX\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.382\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\YYYYYYYYYYYYYYYY.YYY\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022186\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:53:42.382\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022312\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\ZZZZZZZZZZZZZZZZ.ZZZ\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022126\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E638\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 6: Example timeline of SDelete File write events\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EAdmittedly, this activity may seem strange at a first glance. If we do some research on the its file hash, we\u2019ll see the process is actually SDelete masquerading as \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\taskassist.exe\u003C\/span\u003E. As part of its secure deletion process, \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/docs.microsoft.com\/en-us\/sysinternals\/downloads\/sdelete\u0022\u003ESDelete\u003C\/a\u003E renames the file 26 times in a successive alphabetic manner.\u003C\/p\u003E\n\u003Ch4\u003ENetwork Events\u003C\/h4\u003E\n\u003Cp\u003EIncident responders rarely see evidence of network communication from historical evidence on an endpoint without enhanced logging. Usually, Mandiant relies on NetFlow data, network sensors with full or partial packet capture, or malware analysis to determine the command and control (C2) servers with which a malware sample can communicate. Our solution\u2019s real-time network events record both local and remote network ports, the leveraged protocol, and the relevant process.\u003C\/p\u003E\n\u003Cp\u003ETable 7 provides an example of a real-time IPv4 network event recorded by our solution.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ETimestamp (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:46:51.690\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESequence Number\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2895588\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPID\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E9392\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProcess + Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUsername\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETEST-DOMAIN\\BackupAdmin\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ELocal IP Address\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E10.0.0.52\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ELocal Port\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E57472\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ERemote IP Address\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E10.0.0.51\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ERemote Port\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E443\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022138\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProtocol\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022486\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETCP\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 7: Example real-time network connection event\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EBased on this real-time IPv4 network event, the malicious executable \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E made an outbound TCP connection to \u003Cspan class=\u0022code\u0022\u003E10.0.0.51:443\u003C\/span\u003E.\u003C\/p\u003E\n\u003Ch4\u003ERegistry Key Events\u003C\/h4\u003E\n\u003Cp\u003EBy using historical evidence to investigate relevant timeframes and commonly abused registry keys, we can identify malicious or leveraged keys. Real-time registry key events are useful for linking processes to the modified registry keys. They can also show when an attacker deletes or renames a registry key. This is useful to an analyst because the only available timestamp recorded in the registry is the last modified time of a registry key, and this timestamp is updated if a parent key is updated.\u003C\/p\u003E\n\u003Cp\u003ETable 8 provides an example of a real-time registry key event recorded by our solution.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EField\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EExample\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ETimestamp (UTC)\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2020-03-10 16:46:56.409\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003ESequence Number\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E2898196\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPID\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E9392\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EProcess + Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EUsername\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ETEST-DOMAIN\\BackupAdmin\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EEvent Type\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003E3\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPath\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\\u003Cbr\u003E\n LegitWindowsService\\ImagePath\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EKey Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003ECurrentControlSet\\Services\\LegitWindowsService\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EOriginal Path\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EHKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\LegitWindowsService\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EValue Name\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EImagePath\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EValue Type\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EREG_EXPAND_SZ\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EBase64 Encoded\u003Cbr\u003E\nValue\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EQwA6AFwAVwBpAG4AZABvAHcAcwBcAFQAZQBtAHAAXABsAG\u003Cbr\u003E\n UAZwBpAHQAcwBlAHIAdgBpAGMAZQAuAGUAeABlAAAAAA==\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EText\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 8: Example real-time registry key event\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EFor our solution\u0027s real-time registry events, we can map the event type to the operation performed using Table 9.\u003C\/p\u003E\n\u003Ctable border=\u00221\u0022 cellspacing=\u00220\u0022 cellpadding=\u00220\u0022\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EEvent Type Value\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E\u003Cb\u003EOperation\u003C\/b\u003E\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E1\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPreSetValueKey\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E2\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPreDeleteValueKey\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E3\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPostCreateKey, PostCreateKeyEx, PreCreateKeyEx\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E4\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPreDeleteKey\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003Ctr\u003E\u003Ctd width=\u0022132\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003E5\u003C\/p\u003E\n\u003C\/td\u003E\n\u003Ctd width=\u0022492\u0022 valign=\u0022top\u0022\u003E\u003Cp\u003EPreRenameKey\u003C\/p\u003E\n\u003C\/td\u003E\n\u003C\/tr\u003E\u003C\/tbody\u003E\u003C\/table\u003E\n\u003Cp\u003E\u003Cspan class=\u0022type-XS\u0022\u003ETable 9: FireEye Endpoint Security real-time registry key event types\u003C\/span\u003E\u003C\/p\u003E\n\u003Cp\u003EBased on this real-time registry key event, the malicious executable \u003Cspan class=\u0022code\u0022\u003EC:\\Windows\\Temp\\legitservice.exe\u003C\/span\u003E created the Windows service \u003Cspan class=\u0022code\u0022\u003ELegitWindowsService\u003C\/span\u003E. If we investigated the surrounding registry keys, we might identify even more information about this malicious service.\u003C\/p\u003E\n\u003Ch4\u003EConclusion\u003C\/h4\u003E\n\u003Cp\u003EThe availability of real-time events designed for forensic analysis can fill in gaps that traditional forensic artifacts cannot on their own. Mandiant has seen great value in using real-time events during active-attacker investigations. We have used real-time events to determine the functionality of attacker utilities that were no longer present on disk, to determine users and source network addresses used during malicious remote desktop activity when expected corresponding event logs were missing, and more.\u003C\/p\u003E\n\u003Cp\u003ECheck out our \u003Ca adhocenable=\u0022false\u0022 href=\u0022\/content\/fireeye-www\/en_US\/products\/endpoint-security.html\u0022\u003EFireEye Endpoint Security page\u003C\/a\u003E and \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/www.fireeye.com\/services\/freeware\/redline.html\u0022\u003ERedline\u003C\/a\u003E page for more information (as well as \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/fireeye.market\/apps\/211364\u0022\u003ERedline on the FireEye Market\u003C\/a\u003E), and take a \u003Ca adhocenable=\u0022false\u0022 href=\u0022https:\/\/content.fireeye.com\/product-demo\/webpage-endpoint-security-portal\u0022\u003EFireEye Endpoint Security tour\u003C\/a\u003E today.\u003C\/p\u003E\n",
        "jcr:lastModified": "Thu May 14 2020 16:02:07 GMT+0000",
        "sling:resourceType": "social\/blog\/components\/entrytext"
      }
    },
    "summary": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "text": "\u003Cp\u003EDuring an investigation, FireEye Mandiant has found real-time events to be useful in filling in the gaps of what an attacker did.\u003C\/p\u003E\n",
      "jcr:lastModified": "Wed May 13 2020 19:00:41 GMT+0000",
      "sling:resourceType": "social\/blog\/components\/entrytextteaser"
    },
    "image": {
      "jcr:primaryType": "nt:unstructured",
      "jcr:lastModifiedBy": "adam.greenberg@fireeye.com",
      "jcr:lastModified": "Thu May 14 2020 14:52:11 GMT+0000",
      "imageRotate": "0"
    }
  }
}
